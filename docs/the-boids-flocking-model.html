<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 The Boids Flocking Model | Agent Based Modelling</title>
  <meta name="description" content="Chapter 13 The Boids Flocking Model | Agent Based Modelling" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 The Boids Flocking Model | Agent Based Modelling" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 The Boids Flocking Model | Agent Based Modelling" />
  
  
  

<meta name="author" content="Kamran Afzali" />


<meta name="date" content="2025-12-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-emergence-of-inequality-the-sugarscape-model.html"/>
<link rel="next" href="modeling-disease-spread-the-sir-epidemic-framework.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Agent Based Modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Agent Based Modelling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#agent-based-modelling-and-complexity"><i class="fa fa-check"></i><b>1.1</b> Agent-based modelling and complexity</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#structure-of-an-agent-based-model"><i class="fa fa-check"></i><b>1.2</b> Structure of an agent-based model</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#agents"><i class="fa fa-check"></i><b>1.2.1</b> Agents</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#environment"><i class="fa fa-check"></i><b>1.2.2</b> Environment</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#when-to-do-abm"><i class="fa fa-check"></i><b>1.3</b> When to do ABM</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="random-walks-i.html"><a href="random-walks-i.html"><i class="fa fa-check"></i><b>2</b> Random Walks I</a>
<ul>
<li class="chapter" data-level="2.1" data-path="random-walks-i.html"><a href="random-walks-i.html#what-makes-random-walks-special"><i class="fa fa-check"></i><b>2.1</b> What Makes Random Walks Special?</a></li>
<li class="chapter" data-level="2.2" data-path="random-walks-i.html"><a href="random-walks-i.html#building-our-random-walk-simulation"><i class="fa fa-check"></i><b>2.2</b> Building Our Random Walk Simulation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="random-walks-i.html"><a href="random-walks-i.html#setting-up-the-environment"><i class="fa fa-check"></i><b>2.2.1</b> Setting Up the Environment</a></li>
<li class="chapter" data-level="2.2.2" data-path="random-walks-i.html"><a href="random-walks-i.html#creating-the-random-walker-agent"><i class="fa fa-check"></i><b>2.2.2</b> Creating the Random Walker Agent</a></li>
<li class="chapter" data-level="2.2.3" data-path="random-walks-i.html"><a href="random-walks-i.html#designing-the-model-architecture"><i class="fa fa-check"></i><b>2.2.3</b> Designing the Model Architecture</a></li>
<li class="chapter" data-level="2.2.4" data-path="random-walks-i.html"><a href="random-walks-i.html#implementing-the-simulation-loop"><i class="fa fa-check"></i><b>2.2.4</b> Implementing the Simulation Loop</a></li>
<li class="chapter" data-level="2.2.5" data-path="random-walks-i.html"><a href="random-walks-i.html#running-and-analyzing-the-simulation"><i class="fa fa-check"></i><b>2.2.5</b> Running and Analyzing the Simulation</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="random-walks-i.html"><a href="random-walks-i.html#the-complete-implementation"><i class="fa fa-check"></i><b>2.3</b> The Complete Implementation</a></li>
<li class="chapter" data-level="2.4" data-path="random-walks-i.html"><a href="random-walks-i.html#discussion-and-implications"><i class="fa fa-check"></i><b>2.4</b> Discussion and Implications</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="random-walks-i.html"><a href="random-walks-i.html#from-particles-to-populations"><i class="fa fa-check"></i><b>2.4.1</b> From Particles to Populations</a></li>
<li class="chapter" data-level="2.4.2" data-path="random-walks-i.html"><a href="random-walks-i.html#the-power-of-emergence"><i class="fa fa-check"></i><b>2.4.2</b> The Power of Emergence</a></li>
<li class="chapter" data-level="2.4.3" data-path="random-walks-i.html"><a href="random-walks-i.html#extending-the-framework"><i class="fa fa-check"></i><b>2.4.3</b> Extending the Framework</a></li>
<li class="chapter" data-level="2.4.4" data-path="random-walks-i.html"><a href="random-walks-i.html#computational-insights"><i class="fa fa-check"></i><b>2.4.4</b> Computational Insights</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="random-walks-i.html"><a href="random-walks-i.html#visualizing-the-journey"><i class="fa fa-check"></i><b>2.5</b> Visualizing the Journey</a></li>
<li class="chapter" data-level="2.6" data-path="random-walks-i.html"><a href="random-walks-i.html#conclusion-random-walks-as-research-tools"><i class="fa fa-check"></i><b>2.6</b> Conclusion: Random Walks as Research Tools</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="random-walks-i.html"><a href="random-walks-i.html#full-code"><i class="fa fa-check"></i><b>2.6.1</b> Full Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><i class="fa fa-check"></i><b>3</b> Scaling Up: Multi-Agent Random Walks and Emergent Collective Patterns</a>
<ul>
<li class="chapter" data-level="3.1" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#from-solo-to-symphony-the-multi-agent-paradigm"><i class="fa fa-check"></i><b>3.1</b> From Solo to Symphony: The Multi-Agent Paradigm</a></li>
<li class="chapter" data-level="3.2" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#architectural-improvements-professional-mesa-development"><i class="fa fa-check"></i><b>3.2</b> Architectural Improvements: Professional Mesa Development</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#enhanced-agent-design"><i class="fa fa-check"></i><b>3.2.1</b> Enhanced Agent Design</a></li>
<li class="chapter" data-level="3.2.2" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#professional-data-collection"><i class="fa fa-check"></i><b>3.2.2</b> Professional Data Collection</a></li>
<li class="chapter" data-level="3.2.3" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#scalable-model-architecture"><i class="fa fa-check"></i><b>3.2.3</b> Scalable Model Architecture</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#the-complete-enhanced-implementation"><i class="fa fa-check"></i><b>3.3</b> The Complete Enhanced Implementation</a></li>
<li class="chapter" data-level="3.4" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#emergent-patterns-in-multi-agent-systems"><i class="fa fa-check"></i><b>3.4</b> Emergent Patterns in Multi-Agent Systems</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#collective-coverage-patterns"><i class="fa fa-check"></i><b>3.4.1</b> Collective Coverage Patterns</a></li>
<li class="chapter" data-level="3.4.2" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#spatial-distribution-dynamics"><i class="fa fa-check"></i><b>3.4.2</b> Spatial Distribution Dynamics</a></li>
<li class="chapter" data-level="3.4.3" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#temporal-synchronization-and-divergence"><i class="fa fa-check"></i><b>3.4.3</b> Temporal Synchronization and Divergence</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#data-analysis-opportunities"><i class="fa fa-check"></i><b>3.5</b> Data Analysis Opportunities</a></li>
<li class="chapter" data-level="3.6" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#performance-considerations-and-scalability"><i class="fa fa-check"></i><b>3.6</b> Performance Considerations and Scalability</a></li>
<li class="chapter" data-level="3.7" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#research-applications-and-extensions"><i class="fa fa-check"></i><b>3.7</b> Research Applications and Extensions</a></li>
<li class="chapter" data-level="3.8" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#visualization-and-communication"><i class="fa fa-check"></i><b>3.8</b> Visualization and Communication</a></li>
<li class="chapter" data-level="3.9" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#conclusion-from-randomness-to-understanding"><i class="fa fa-check"></i><b>3.9</b> Conclusion: From Randomness to Understanding</a></li>
<li class="chapter" data-level="3.10" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#full-code-1"><i class="fa fa-check"></i><b>3.10</b> Full code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html"><i class="fa fa-check"></i><b>4</b> Beyond Random: When Agents Learn to Navigate Their World</a>
<ul>
<li class="chapter" data-level="4.1" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#from-random-to-rational-the-learning-paradigm"><i class="fa fa-check"></i><b>4.1</b> From Random to Rational: The Learning Paradigm</a></li>
<li class="chapter" data-level="4.2" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#environmental-complexity-resources-and-hazards"><i class="fa fa-check"></i><b>4.2</b> Environmental Complexity: Resources and Hazards</a></li>
<li class="chapter" data-level="4.3" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#the-architecture-of-adaptive-behavior"><i class="fa fa-check"></i><b>4.3</b> The Architecture of Adaptive Behavior</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#the-exploration-exploitation-dilemma"><i class="fa fa-check"></i><b>4.3.1</b> The Exploration-Exploitation Dilemma</a></li>
<li class="chapter" data-level="4.3.2" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#adaptive-decision-making"><i class="fa fa-check"></i><b>4.3.2</b> Adaptive Decision Making</a></li>
<li class="chapter" data-level="4.3.3" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#learning-through-experience"><i class="fa fa-check"></i><b>4.3.3</b> Learning Through Experience</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#environmental-architecture-and-complexity"><i class="fa fa-check"></i><b>4.4</b> Environmental Architecture and Complexity</a></li>
<li class="chapter" data-level="4.5" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#comprehensive-data-collection-and-analysis"><i class="fa fa-check"></i><b>4.5</b> Comprehensive Data Collection and Analysis</a></li>
<li class="chapter" data-level="4.6" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#the-complete-learning-walker-implementation"><i class="fa fa-check"></i><b>4.6</b> The Complete Learning Walker Implementation</a></li>
<li class="chapter" data-level="4.7" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#emergent-intelligence-what-the-data-reveals"><i class="fa fa-check"></i><b>4.7</b> Emergent Intelligence: What the Data Reveals</a></li>
<li class="chapter" data-level="4.8" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#research-implications-and-real-world-connections"><i class="fa fa-check"></i><b>4.8</b> Research Implications and Real-World Connections</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#extensions-and-future-directions"><i class="fa fa-check"></i><b>4.8.1</b> Extensions and Future Directions</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#computational-insights-and-performance"><i class="fa fa-check"></i><b>4.9</b> Computational Insights and Performance</a></li>
<li class="chapter" data-level="4.10" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#conclusion-intelligence-as-emergent-property"><i class="fa fa-check"></i><b>4.10</b> Conclusion: Intelligence as Emergent Property</a></li>
<li class="chapter" data-level="4.11" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#full-code-2"><i class="fa fa-check"></i><b>4.11</b> Full code</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html"><i class="fa fa-check"></i><b>5</b> From Random Walks to Social Segregation: The Schelling Model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#the-mechanics-of-social-preference"><i class="fa fa-check"></i><b>5.1</b> The Mechanics of Social Preference</a></li>
<li class="chapter" data-level="5.2" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#implementation-architecture-and-design-decisions"><i class="fa fa-check"></i><b>5.2</b> Implementation Architecture and Design Decisions</a></li>
<li class="chapter" data-level="5.3" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#the-emergence-of-segregated-patterns"><i class="fa fa-check"></i><b>5.3</b> The Emergence of Segregated Patterns</a></li>
<li class="chapter" data-level="5.4" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#quantifying-segregation-dynamics"><i class="fa fa-check"></i><b>5.4</b> Quantifying Segregation Dynamics</a></li>
<li class="chapter" data-level="5.5" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#extensions-and-variations"><i class="fa fa-check"></i><b>5.5</b> Extensions and Variations</a></li>
<li class="chapter" data-level="5.6" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#policy-implications-and-interventions"><i class="fa fa-check"></i><b>5.6</b> Policy Implications and Interventions</a></li>
<li class="chapter" data-level="5.7" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#computational-considerations-and-future-directions"><i class="fa fa-check"></i><b>5.7</b> Computational Considerations and Future Directions</a></li>
<li class="chapter" data-level="5.8" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#connecting-theory-and-reality"><i class="fa fa-check"></i><b>5.8</b> Connecting Theory and Reality</a></li>
<li class="chapter" data-level="5.9" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#emergence-and-individual-responsibility"><i class="fa fa-check"></i><b>5.9</b> Emergence and Individual Responsibility</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html"><i class="fa fa-check"></i><b>6</b> An Economic Extension of the Schelling Segregation Model</a>
<ul>
<li class="chapter" data-level="6.1" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#introduction-the-missing-economic-dimension"><i class="fa fa-check"></i><b>6.1</b> Introduction: The Missing Economic Dimension</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#redefining-agents-in-economic-terms"><i class="fa fa-check"></i><b>6.1.1</b> Redefining Agents in Economic Terms</a></li>
<li class="chapter" data-level="6.1.2" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#emergent-dynamics-when-constraints-reshape-preferences"><i class="fa fa-check"></i><b>6.1.2</b> Emergent Dynamics: When Constraints Reshape Preferences</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#research-applications-from-theory-to-policy"><i class="fa fa-check"></i><b>6.2</b> Research Applications: From Theory to Policy</a></li>
<li class="chapter" data-level="6.3" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#methodological-innovations-and-extensions"><i class="fa fa-check"></i><b>6.3</b> Methodological Innovations and Extensions</a></li>
<li class="chapter" data-level="6.4" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#key-findings-the-economic-reality-of-social-sorting"><i class="fa fa-check"></i><b>6.4</b> Key Findings: The Economic Reality of Social Sorting</a></li>
<li class="chapter" data-level="6.5" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#conclusion"><i class="fa fa-check"></i><b>6.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><i class="fa fa-check"></i><b>7</b> Space Matters: Grids, Neighborhoods, and Spatial Dynamics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#the-architecture-of-space-in-agent-based-models"><i class="fa fa-check"></i><b>7.1</b> The Architecture of Space in Agent-Based Models</a></li>
<li class="chapter" data-level="7.2" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#conways-game-of-life-emergence-from-simplicity"><i class="fa fa-check"></i><b>7.2</b> Conway’s Game of Life: Emergence from Simplicity</a></li>
<li class="chapter" data-level="7.3" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#patterns-structures-and-emergent-behaviors"><i class="fa fa-check"></i><b>7.3</b> Patterns, Structures, and Emergent Behaviors</a></li>
<li class="chapter" data-level="7.4" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#boundary-conditions-and-spatial-topology"><i class="fa fa-check"></i><b>7.4</b> Boundary Conditions and Spatial Topology</a></li>
<li class="chapter" data-level="7.5" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#extending-the-framework-custom-rules-and-variations"><i class="fa fa-check"></i><b>7.5</b> Extending the Framework: Custom Rules and Variations</a></li>
<li class="chapter" data-level="7.6" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#computational-complexity-and-performance-considerations"><i class="fa fa-check"></i><b>7.6</b> Computational Complexity and Performance Considerations</a></li>
<li class="chapter" data-level="7.7" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#connections-to-complex-systems-theory"><i class="fa fa-check"></i><b>7.7</b> Connections to Complex Systems Theory</a></li>
<li class="chapter" data-level="7.8" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#spatial-dynamics-and-future-directions"><i class="fa fa-check"></i><b>7.8</b> Spatial Dynamics and Future Directions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><i class="fa fa-check"></i><b>8</b> Beyond Binary: Multi-State Cellular Automata and Emergent Ecosystems</a>
<ul>
<li class="chapter" data-level="8.1" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#mathematical-foundations-of-multi-state-systems"><i class="fa fa-check"></i><b>8.1</b> Mathematical Foundations of Multi-State Systems</a></li>
<li class="chapter" data-level="8.2" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#implementation-architecture"><i class="fa fa-check"></i><b>8.2</b> Implementation Architecture</a></li>
<li class="chapter" data-level="8.3" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#cyclic-dynamics-and-spatial-patterns"><i class="fa fa-check"></i><b>8.3</b> Cyclic Dynamics and Spatial Patterns</a></li>
<li class="chapter" data-level="8.4" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#parameter-sensitivity-and-system-stability"><i class="fa fa-check"></i><b>8.4</b> Parameter Sensitivity and System Stability</a></li>
<li class="chapter" data-level="8.5" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#complete-implementation-and-execution"><i class="fa fa-check"></i><b>8.5</b> Complete Implementation and Execution</a></li>
<li class="chapter" data-level="8.6" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#extensions-and-future-directions-1"><i class="fa fa-check"></i><b>8.6</b> Extensions and Future Directions</a></li>
<li class="chapter" data-level="8.7" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#connecting-theory-to-reality"><i class="fa fa-check"></i><b>8.7</b> Connecting Theory to Reality</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html"><i class="fa fa-check"></i><b>9</b> Forest Fire Dynamics Modeling I</a>
<ul>
<li class="chapter" data-level="9.1" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#introduction-when-simple-rules-create-complex-patterns"><i class="fa fa-check"></i><b>9.1</b> Introduction: When Simple Rules Create Complex Patterns</a></li>
<li class="chapter" data-level="9.2" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#the-forest-fire-model-four-states-infinite-possibilities"><i class="fa fa-check"></i><b>9.2</b> The Forest Fire Model: Four States, Infinite Possibilities</a></li>
<li class="chapter" data-level="9.3" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#two-phase-evolution-separating-growth-from-fire"><i class="fa fa-check"></i><b>9.3</b> Two-Phase Evolution: Separating Growth from Fire</a></li>
<li class="chapter" data-level="9.4" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#building-the-complete-model"><i class="fa fa-check"></i><b>9.4</b> Building the Complete Model</a></li>
<li class="chapter" data-level="9.5" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#emergent-dynamics-self-organized-criticality"><i class="fa fa-check"></i><b>9.5</b> Emergent Dynamics: Self-Organized Criticality</a></li>
<li class="chapter" data-level="9.6" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#the-critical-fire-spread-probability"><i class="fa fa-check"></i><b>9.6</b> The Critical Fire Spread Probability</a></li>
<li class="chapter" data-level="9.7" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#spatial-patterns-forest-mosaics"><i class="fa fa-check"></i><b>9.7</b> Spatial Patterns: Forest Mosaics</a></li>
<li class="chapter" data-level="9.8" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#temporal-oscillations-boom-and-bust-cycles"><i class="fa fa-check"></i><b>9.8</b> Temporal Oscillations: Boom and Bust Cycles</a></li>
<li class="chapter" data-level="9.9" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#equilibrium-and-stability"><i class="fa fa-check"></i><b>9.9</b> Equilibrium and Stability</a></li>
<li class="chapter" data-level="9.10" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#applications-from-theory-to-management"><i class="fa fa-check"></i><b>9.10</b> Applications: From Theory to Management</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#fuel-reduction-strategies"><i class="fa fa-check"></i><b>9.10.1</b> Fuel Reduction Strategies</a></li>
<li class="chapter" data-level="9.10.2" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#climate-change-scenarios"><i class="fa fa-check"></i><b>9.10.2</b> Climate Change Scenarios</a></li>
<li class="chapter" data-level="9.10.3" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#firebreak-design"><i class="fa fa-check"></i><b>9.10.3</b> Firebreak Design</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#applications-and-policy-implications"><i class="fa fa-check"></i><b>9.11</b> Applications and Policy Implications</a>
<ul>
<li class="chapter" data-level="9.11.1" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#forest-management-strategies"><i class="fa fa-check"></i><b>9.11.1</b> Forest Management Strategies</a></li>
<li class="chapter" data-level="9.11.2" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#climate-change-adaptation"><i class="fa fa-check"></i><b>9.11.2</b> Climate Change Adaptation</a></li>
<li class="chapter" data-level="9.11.3" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#conservation-planning"><i class="fa fa-check"></i><b>9.11.3</b> Conservation Planning</a></li>
</ul></li>
<li class="chapter" data-level="9.12" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#model-extensions-and-future-directions"><i class="fa fa-check"></i><b>9.12</b> Model Extensions and Future Directions</a>
<ul>
<li class="chapter" data-level="9.12.1" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#spatial-heterogeneity"><i class="fa fa-check"></i><b>9.12.1</b> Spatial Heterogeneity</a></li>
<li class="chapter" data-level="9.12.2" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#multi-scale-dynamics"><i class="fa fa-check"></i><b>9.12.2</b> Multi-scale Dynamics</a></li>
<li class="chapter" data-level="9.12.3" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#stochastic-fire-spread"><i class="fa fa-check"></i><b>9.12.3</b> Stochastic Fire Spread</a></li>
</ul></li>
<li class="chapter" data-level="9.13" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#limitations-and-model-assumptions"><i class="fa fa-check"></i><b>9.13</b> Limitations and Model Assumptions</a>
<ul>
<li class="chapter" data-level="9.13.1" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#temporal-resolution"><i class="fa fa-check"></i><b>9.13.1</b> Temporal Resolution</a></li>
<li class="chapter" data-level="9.13.2" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#spatial-resolution"><i class="fa fa-check"></i><b>9.13.2</b> Spatial Resolution</a></li>
<li class="chapter" data-level="9.13.3" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#deterministic-vs.-stochastic-elements"><i class="fa fa-check"></i><b>9.13.3</b> Deterministic vs. Stochastic Elements</a></li>
<li class="chapter" data-level="9.13.4" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#human-dimensions"><i class="fa fa-check"></i><b>9.13.4</b> Human Dimensions</a></li>
</ul></li>
<li class="chapter" data-level="9.14" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#conclusion-emergent-complexity-from-simple-rules"><i class="fa fa-check"></i><b>9.14</b> Conclusion: Emergent Complexity from Simple Rules</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html"><i class="fa fa-check"></i><b>10</b> Forest Fire Dynamics Modeling II</a>
<ul>
<li class="chapter" data-level="10.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#introduction-the-complex-dynamics-of-fire-suppression"><i class="fa fa-check"></i><b>10.1</b> Introduction: The Complex Dynamics of Fire Suppression</a></li>
<li class="chapter" data-level="10.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#mathematical-framework-multi-agent-fire-suppression-dynamics"><i class="fa fa-check"></i><b>10.2</b> Mathematical Framework: Multi-Agent Fire-Suppression Dynamics</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#enhanced-state-space-definition"><i class="fa fa-check"></i><b>10.2.1</b> Enhanced State Space Definition</a></li>
<li class="chapter" data-level="10.2.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#firefighter-agent-dynamics"><i class="fa fa-check"></i><b>10.2.2</b> Firefighter Agent Dynamics</a></li>
<li class="chapter" data-level="10.2.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#modified-fire-propagation-with-suppression"><i class="fa fa-check"></i><b>10.2.3</b> Modified Fire Propagation with Suppression</a></li>
<li class="chapter" data-level="10.2.4" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#firefighter-behavioral-rules"><i class="fa fa-check"></i><b>10.2.4</b> Firefighter Behavioral Rules</a></li>
<li class="chapter" data-level="10.2.5" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#infrastructure-effects-on-fire-dynamics"><i class="fa fa-check"></i><b>10.2.5</b> Infrastructure Effects on Fire Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#policy-architecture-comparative-strategy-frameworks"><i class="fa fa-check"></i><b>10.3</b> Policy Architecture: Comparative Strategy Frameworks</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#reactive-suppression-policy"><i class="fa fa-check"></i><b>10.3.1</b> Reactive Suppression Policy</a></li>
<li class="chapter" data-level="10.3.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#preventive-suppression-policy"><i class="fa fa-check"></i><b>10.3.2</b> Preventive Suppression Policy</a></li>
<li class="chapter" data-level="10.3.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#aggressive-suppression-policy"><i class="fa fa-check"></i><b>10.3.3</b> Aggressive Suppression Policy</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#implementation-architecture-multi-phase-staged-activation"><i class="fa fa-check"></i><b>10.4</b> Implementation Architecture: Multi-Phase Staged Activation</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#staged-temporal-dynamics"><i class="fa fa-check"></i><b>10.4.1</b> Staged Temporal Dynamics</a></li>
<li class="chapter" data-level="10.4.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#multi-agent-coordination-mechanisms"><i class="fa fa-check"></i><b>10.4.2</b> Multi-Agent Coordination Mechanisms</a></li>
<li class="chapter" data-level="10.4.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#state-machine-implementation"><i class="fa fa-check"></i><b>10.4.3</b> State Machine Implementation</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#emergent-dynamics-resource-allocation-and-spatial-coverage"><i class="fa fa-check"></i><b>10.5</b> Emergent Dynamics: Resource Allocation and Spatial Coverage</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#spatial-response-patterns"><i class="fa fa-check"></i><b>10.5.1</b> Spatial Response Patterns</a></li>
<li class="chapter" data-level="10.5.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#temporal-resource-utilization"><i class="fa fa-check"></i><b>10.5.2</b> Temporal Resource Utilization</a></li>
<li class="chapter" data-level="10.5.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#fire-size-distribution-effects"><i class="fa fa-check"></i><b>10.5.3</b> Fire Size Distribution Effects</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#performance-metrics-multi-objective-policy-evaluation"><i class="fa fa-check"></i><b>10.6</b> Performance Metrics: Multi-Objective Policy Evaluation</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#suppression-effectiveness-measures"><i class="fa fa-check"></i><b>10.6.1</b> Suppression Effectiveness Measures</a></li>
<li class="chapter" data-level="10.6.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#resource-efficiency-indicators"><i class="fa fa-check"></i><b>10.6.2</b> Resource Efficiency Indicators</a></li>
<li class="chapter" data-level="10.6.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#economic-cost-considerations"><i class="fa fa-check"></i><b>10.6.3</b> Economic Cost Considerations</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#simulation-results-comparative-policy-analysis"><i class="fa fa-check"></i><b>10.7</b> Simulation Results: Comparative Policy Analysis</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#burned-area-performance"><i class="fa fa-check"></i><b>10.7.1</b> Burned Area Performance</a></li>
<li class="chapter" data-level="10.7.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#temporal-dynamics-comparison"><i class="fa fa-check"></i><b>10.7.2</b> Temporal Dynamics Comparison</a></li>
<li class="chapter" data-level="10.7.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#resource-utilization-trade-offs"><i class="fa fa-check"></i><b>10.7.3</b> Resource Utilization Trade-offs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#policy-implications-strategic-fire-management"><i class="fa fa-check"></i><b>10.8</b> Policy Implications: Strategic Fire Management</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#cost-benefit-optimization"><i class="fa fa-check"></i><b>10.8.1</b> Cost-Benefit Optimization</a></li>
<li class="chapter" data-level="10.8.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#infrastructure-investment-strategies"><i class="fa fa-check"></i><b>10.8.2</b> Infrastructure Investment Strategies</a></li>
<li class="chapter" data-level="10.8.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#adaptive-management-frameworks"><i class="fa fa-check"></i><b>10.8.3</b> Adaptive Management Frameworks</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#model-extensions-and-future-directions-1"><i class="fa fa-check"></i><b>10.9</b> Model Extensions and Future Directions</a></li>
<li class="chapter" data-level="10.10" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#limitations-and-critical-assessment"><i class="fa fa-check"></i><b>10.10</b> Limitations and Critical Assessment</a></li>
<li class="chapter" data-level="10.11" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#conclusion-1"><i class="fa fa-check"></i><b>10.11</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html"><i class="fa fa-check"></i><b>11</b> Predator-Prey Dynamics: The Wolf-Sheep Model</a>
<ul>
<li class="chapter" data-level="11.1" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#the-mathematical-foundation"><i class="fa fa-check"></i><b>11.1</b> The Mathematical Foundation</a></li>
<li class="chapter" data-level="11.2" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#agent-architecture-and-behavioral-rules"><i class="fa fa-check"></i><b>11.2</b> Agent Architecture and Behavioral Rules</a></li>
<li class="chapter" data-level="11.3" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#model-initialization-and-parameter-space"><i class="fa fa-check"></i><b>11.3</b> Model Initialization and Parameter Space</a></li>
<li class="chapter" data-level="11.4" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#data-collection-and-population-tracking"><i class="fa fa-check"></i><b>11.4</b> Data Collection and Population Tracking</a></li>
<li class="chapter" data-level="11.5" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#emergent-population-dynamics"><i class="fa fa-check"></i><b>11.5</b> Emergent Population Dynamics</a></li>
<li class="chapter" data-level="11.6" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#spatial-patterns-and-local-dynamics"><i class="fa fa-check"></i><b>11.6</b> Spatial Patterns and Local Dynamics</a></li>
<li class="chapter" data-level="11.7" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#parameter-sensitivity-and-system-stability-1"><i class="fa fa-check"></i><b>11.7</b> Parameter Sensitivity and System Stability</a></li>
<li class="chapter" data-level="11.8" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#extensions-and-ecological-complexity"><i class="fa fa-check"></i><b>11.8</b> Extensions and Ecological Complexity</a></li>
<li class="chapter" data-level="11.9" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#connections-to-conservation-and-management"><i class="fa fa-check"></i><b>11.9</b> Connections to Conservation and Management</a></li>
<li class="chapter" data-level="11.10" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#computational-and-theoretical-reflections"><i class="fa fa-check"></i><b>11.10</b> Computational and Theoretical Reflections</a></li>
<li class="chapter" data-level="11.11" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#from-individual-decisions-to-collective-patterns"><i class="fa fa-check"></i><b>11.11</b> From Individual Decisions to Collective Patterns</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html"><i class="fa fa-check"></i><b>12</b> The Emergence of Inequality: The sugarscape Model</a>
<ul>
<li class="chapter" data-level="12.1" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#the-mathematical-framework-of-random-exchange"><i class="fa fa-check"></i><b>12.1</b> The Mathematical Framework of Random Exchange</a></li>
<li class="chapter" data-level="12.2" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#measuring-inequality-through-the-gini-coefficient"><i class="fa fa-check"></i><b>12.2</b> Measuring Inequality Through the Gini Coefficient</a></li>
<li class="chapter" data-level="12.3" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#model-architecture-and-data-collection"><i class="fa fa-check"></i><b>12.3</b> Model Architecture and Data Collection</a></li>
<li class="chapter" data-level="12.4" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#the-dynamics-of-inequality-emergence"><i class="fa fa-check"></i><b>12.4</b> The Dynamics of Inequality Emergence</a></li>
<li class="chapter" data-level="12.5" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#statistical-properties-and-theoretical-insights"><i class="fa fa-check"></i><b>12.5</b> Statistical Properties and Theoretical Insights</a></li>
<li class="chapter" data-level="12.6" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#visualizing-inequality-through-multiple-lenses"><i class="fa fa-check"></i><b>12.6</b> Visualizing Inequality Through Multiple Lenses</a></li>
<li class="chapter" data-level="12.7" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#policy-implications-and-model-extensions"><i class="fa fa-check"></i><b>12.7</b> Policy Implications and Model Extensions</a></li>
<li class="chapter" data-level="12.8" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#connections-to-econophysics-and-statistical-mechanics"><i class="fa fa-check"></i><b>12.8</b> Connections to Econophysics and Statistical Mechanics</a></li>
<li class="chapter" data-level="12.9" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#computational-considerations-and-simulation-design"><i class="fa fa-check"></i><b>12.9</b> Computational Considerations and Simulation Design</a></li>
<li class="chapter" data-level="12.10" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#interpreting-results-and-avoiding-common-pitfalls"><i class="fa fa-check"></i><b>12.10</b> Interpreting Results and Avoiding Common Pitfalls</a></li>
<li class="chapter" data-level="12.11" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#from-simple-models-to-complex-realities"><i class="fa fa-check"></i><b>12.11</b> From Simple Models to Complex Realities</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html"><i class="fa fa-check"></i><b>13</b> The Boids Flocking Model</a>
<ul>
<li class="chapter" data-level="13.1" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#the-mathematics-of-flocking"><i class="fa fa-check"></i><b>13.1</b> The Mathematics of Flocking</a></li>
<li class="chapter" data-level="13.2" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#implementation-in-continuous-space"><i class="fa fa-check"></i><b>13.2</b> Implementation in Continuous Space</a></li>
<li class="chapter" data-level="13.3" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#model-architecture-and-data-collection-1"><i class="fa fa-check"></i><b>13.3</b> Model Architecture and Data Collection</a></li>
<li class="chapter" data-level="13.4" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#emergent-phenomena-and-pattern-formation"><i class="fa fa-check"></i><b>13.4</b> Emergent Phenomena and Pattern Formation</a></li>
<li class="chapter" data-level="13.5" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#variations-and-extensions"><i class="fa fa-check"></i><b>13.5</b> Variations and Extensions</a></li>
<li class="chapter" data-level="13.6" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#computational-considerations"><i class="fa fa-check"></i><b>13.6</b> Computational Considerations</a></li>
<li class="chapter" data-level="13.7" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#biological-parallels-and-theoretical-insights"><i class="fa fa-check"></i><b>13.7</b> Biological Parallels and Theoretical Insights</a></li>
<li class="chapter" data-level="13.8" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#from-local-rules-to-global-order"><i class="fa fa-check"></i><b>13.8</b> From Local Rules to Global Order</a></li>
<li class="chapter" data-level="13.9" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#practical-applications-and-future-directions"><i class="fa fa-check"></i><b>13.9</b> Practical Applications and Future Directions</a></li>
<li class="chapter" data-level="13.10" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#conclusion-the-beauty-of-emergent-coordination"><i class="fa fa-check"></i><b>13.10</b> Conclusion: The Beauty of Emergent Coordination</a></li>
<li class="chapter" data-level="13.11" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#complete-implementation"><i class="fa fa-check"></i><b>13.11</b> Complete Implementation</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html"><i class="fa fa-check"></i><b>14</b> Modeling Disease Spread: The SIR Epidemic Framework</a>
<ul>
<li class="chapter" data-level="14.1" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#the-mathematics-of-contagion"><i class="fa fa-check"></i><b>14.1</b> The Mathematics of Contagion</a></li>
<li class="chapter" data-level="14.2" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#building-the-epidemic-agents"><i class="fa fa-check"></i><b>14.2</b> Building the Epidemic Agents</a></li>
<li class="chapter" data-level="14.3" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#orchestrating-the-epidemic"><i class="fa fa-check"></i><b>14.3</b> Orchestrating the Epidemic</a></li>
<li class="chapter" data-level="14.4" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#the-temporal-evolution-of-epidemics"><i class="fa fa-check"></i><b>14.4</b> The Temporal Evolution of Epidemics</a></li>
<li class="chapter" data-level="14.5" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#analyzing-epidemic-dynamics"><i class="fa fa-check"></i><b>14.5</b> Analyzing Epidemic Dynamics</a></li>
<li class="chapter" data-level="14.6" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#the-role-of-stochasticity"><i class="fa fa-check"></i><b>14.6</b> The Role of Stochasticity</a></li>
<li class="chapter" data-level="14.7" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#extensions-and-variations-1"><i class="fa fa-check"></i><b>14.7</b> Extensions and Variations</a></li>
<li class="chapter" data-level="14.8" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#public-health-implications"><i class="fa fa-check"></i><b>14.8</b> Public Health Implications</a></li>
<li class="chapter" data-level="14.9" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#computational-considerations-1"><i class="fa fa-check"></i><b>14.9</b> Computational Considerations</a></li>
<li class="chapter" data-level="14.10" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#limitations-and-future-directions"><i class="fa fa-check"></i><b>14.10</b> Limitations and Future Directions</a></li>
<li class="chapter" data-level="14.11" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#from-individuals-to-populations"><i class="fa fa-check"></i><b>14.11</b> From Individuals to Populations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Agent Based Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-boids-flocking-model" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> The Boids Flocking Model<a href="the-boids-flocking-model.html#the-boids-flocking-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Our journey through agent-based modeling began with random walks, where solitary agents wandered aimlessly across discrete grids, generating unpredictable trajectories from pure chance. We then progressed to the Schelling model, where agents made purposeful decisions based on their social environment, creating segregation patterns from mild preferences. Now we venture into a realm where collective behavior produces stunning displays of coordination without central control: the flocking behavior of birds, fish, and other social organisms.</p>
<p>Watch a murmuration of starlings twist and turn through the sky, thousands of individuals moving as one fluid entity. Observe a school of fish evading a predator, their synchronized movements creating waves of coordinated motion. These natural phenomena captivate us precisely because they exhibit remarkable order emerging from what appears to be chaos. No leader directs the flock, no blueprint prescribes the pattern, yet the collective behavior displays a coherence that seems almost choreographed. The Boids model, developed by Craig Reynolds in 1987, demonstrates how such mesmerizing patterns arise from three simple behavioral rules operating in continuous space.</p>
<div id="the-mathematics-of-flocking" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> The Mathematics of Flocking<a href="the-boids-flocking-model.html#the-mathematics-of-flocking" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The transition from discrete grid-based models to continuous space represents a fundamental shift in how we conceptualize agent movement and interaction. Rather than occupying distinct cells and moving in discrete steps, boids exist at precise coordinates in continuous two-dimensional space and move with velocity vectors that change smoothly over time. Each boid i possesses a position vector <strong>p</strong>ᵢ = (xᵢ, yᵢ) and velocity vector <strong>v</strong>ᵢ = (vₓ, vᵧ), both evolving continuously as the simulation progresses.</p>
<p>The flocking behavior emerges from three fundamental rules that Reynolds identified by observing natural flocks. These rules translate into force vectors that modify each boid’s velocity at every time step. The separation rule prevents crowding by applying a repulsive force when neighbors come too close. For boid i with neighbors within a critical distance, the separation force <strong>F</strong>ₛₑₚ becomes:</p>
<p><strong>F</strong>ₛₑₚ = Σⱼ (<strong>p</strong>ᵢ - <strong>p</strong>ⱼ) / ||<strong>p</strong>ᵢ - <strong>p</strong>ⱼ||²</p>
<p>where the sum extends over all neighbors j within the separation threshold and the inverse square distance weighting ensures stronger repulsion from closer neighbors. This mathematical formulation mirrors physical forces like electrostatic repulsion, creating natural spacing between individuals.</p>
<p>The alignment rule steers each boid toward the average heading of its neighbors, promoting coordinated movement. If <strong>N</strong>ᵢ represents the set of neighbors within boid i’s perception radius, the alignment force becomes:</p>
<p><strong>F</strong>ₐₗᵢ = (Σⱼ∈<strong>N</strong>ᵢ <strong>v</strong>ⱼ / |<strong>N</strong>ᵢ|) - <strong>v</strong>ᵢ</p>
<p>This force represents the difference between the average neighbor velocity and the boid’s current velocity, creating a steering force that gradually aligns the boid with its neighbors’ movement patterns. The cohesion rule attracts boids toward the average position of their neighbors, preventing the flock from dispersing. The cohesion force takes the form:</p>
<p><strong>F</strong>cₒₕ = (Σⱼ∈<strong>N</strong>ᵢ <strong>p</strong>ⱼ / |<strong>N</strong>ᵢ|) - <strong>p</strong>ᵢ</p>
<p>representing the difference between the center of mass of nearby neighbors and the boid’s current position. These three forces combine with adjustable weights w₁, w₂, w₃ to produce the total acceleration:</p>
<p><strong>a</strong>ᵢ = w₁<strong>F</strong>ₛₑₚ + w₂<strong>F</strong>ₐₗᵢ + w₃<strong>F</strong>cₒₕ</p>
<p>The boid’s velocity then updates according to <strong>v</strong>ᵢ(t+Δt) = <strong>v</strong>ᵢ(t) + <strong>a</strong>ᵢΔt, with constraints ensuring velocities remain within physically reasonable bounds. The position updates through standard kinematic equations: <strong>p</strong>ᵢ(t+Δt) = <strong>p</strong>ᵢ(t) + <strong>v</strong>ᵢ(t)Δt.</p>
</div>
<div id="implementation-in-continuous-space" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Implementation in Continuous Space<a href="the-boids-flocking-model.html#implementation-in-continuous-space" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our Mesa implementation leverages continuous space rather than discrete grids, fundamentally changing how we represent positions and calculate interactions. The <code>Boid</code> class encapsulates both position and velocity as numpy arrays, enabling efficient vector operations:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="the-boids-flocking-model.html#cb98-1" tabindex="-1"></a><span class="kw">class</span> Boid(Agent):</span>
<span id="cb98-2"><a href="the-boids-flocking-model.html#cb98-2" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model, pos, velocity<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb98-3"><a href="the-boids-flocking-model.html#cb98-3" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(model)</span>
<span id="cb98-4"><a href="the-boids-flocking-model.html#cb98-4" tabindex="-1"></a>        <span class="va">self</span>.pos <span class="op">=</span> np.array(pos, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb98-5"><a href="the-boids-flocking-model.html#cb98-5" tabindex="-1"></a>        </span>
<span id="cb98-6"><a href="the-boids-flocking-model.html#cb98-6" tabindex="-1"></a>        <span class="cf">if</span> velocity <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb98-7"><a href="the-boids-flocking-model.html#cb98-7" tabindex="-1"></a>            angle <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span> np.pi)</span>
<span id="cb98-8"><a href="the-boids-flocking-model.html#cb98-8" tabindex="-1"></a>            speed <span class="op">=</span> np.random.uniform(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb98-9"><a href="the-boids-flocking-model.html#cb98-9" tabindex="-1"></a>            <span class="va">self</span>.velocity <span class="op">=</span> np.array([np.cos(angle) <span class="op">*</span> speed, np.sin(angle) <span class="op">*</span> speed])</span>
<span id="cb98-10"><a href="the-boids-flocking-model.html#cb98-10" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb98-11"><a href="the-boids-flocking-model.html#cb98-11" tabindex="-1"></a>            <span class="va">self</span>.velocity <span class="op">=</span> np.array(velocity, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb98-12"><a href="the-boids-flocking-model.html#cb98-12" tabindex="-1"></a>        </span>
<span id="cb98-13"><a href="the-boids-flocking-model.html#cb98-13" tabindex="-1"></a>        <span class="va">self</span>.max_speed <span class="op">=</span> <span class="fl">4.0</span></span>
<span id="cb98-14"><a href="the-boids-flocking-model.html#cb98-14" tabindex="-1"></a>        <span class="va">self</span>.max_force <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb98-15"><a href="the-boids-flocking-model.html#cb98-15" tabindex="-1"></a>        <span class="va">self</span>.perception_radius <span class="op">=</span> <span class="fl">15.0</span></span></code></pre></div>
<p>The initialization demonstrates careful attention to physical realism. Each boid begins with a random velocity whose direction spans the full circle (0 to 2π radians) and whose magnitude varies within reasonable bounds. The parameters max_speed and max_force constrain the boid’s motion, preventing unrealistic accelerations or velocities that would break the illusion of natural movement.</p>
<p>The separation force implementation translates the mathematical formulation directly into code while handling edge cases and numerical stability:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="the-boids-flocking-model.html#cb99-1" tabindex="-1"></a><span class="kw">def</span> separate(<span class="va">self</span>, neighbors):</span>
<span id="cb99-2"><a href="the-boids-flocking-model.html#cb99-2" tabindex="-1"></a>    separation_vector <span class="op">=</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb99-3"><a href="the-boids-flocking-model.html#cb99-3" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(neighbors) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb99-4"><a href="the-boids-flocking-model.html#cb99-4" tabindex="-1"></a>        <span class="cf">return</span> separation_vector</span>
<span id="cb99-5"><a href="the-boids-flocking-model.html#cb99-5" tabindex="-1"></a>    </span>
<span id="cb99-6"><a href="the-boids-flocking-model.html#cb99-6" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb99-7"><a href="the-boids-flocking-model.html#cb99-7" tabindex="-1"></a>        distance <span class="op">=</span> np.linalg.norm(<span class="va">self</span>.pos <span class="op">-</span> neighbor.pos)</span>
<span id="cb99-8"><a href="the-boids-flocking-model.html#cb99-8" tabindex="-1"></a>        <span class="cf">if</span> <span class="dv">0</span> <span class="op">&lt;</span> distance <span class="op">&lt;</span> <span class="va">self</span>.perception_radius <span class="op">/</span> <span class="dv">3</span>:</span>
<span id="cb99-9"><a href="the-boids-flocking-model.html#cb99-9" tabindex="-1"></a>            diff <span class="op">=</span> <span class="va">self</span>.pos <span class="op">-</span> neighbor.pos</span>
<span id="cb99-10"><a href="the-boids-flocking-model.html#cb99-10" tabindex="-1"></a>            separation_vector <span class="op">+=</span> diff <span class="op">/</span> (distance <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb99-11"><a href="the-boids-flocking-model.html#cb99-11" tabindex="-1"></a>    </span>
<span id="cb99-12"><a href="the-boids-flocking-model.html#cb99-12" tabindex="-1"></a>    <span class="cf">if</span> np.linalg.norm(separation_vector) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb99-13"><a href="the-boids-flocking-model.html#cb99-13" tabindex="-1"></a>        separation_vector <span class="op">=</span> (separation_vector <span class="op">/</span> np.linalg.norm(separation_vector)) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb99-14"><a href="the-boids-flocking-model.html#cb99-14" tabindex="-1"></a>        separation_vector <span class="op">=</span> separation_vector <span class="op">-</span> <span class="va">self</span>.velocity</span>
<span id="cb99-15"><a href="the-boids-flocking-model.html#cb99-15" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(separation_vector) <span class="op">&gt;</span> <span class="va">self</span>.max_force:</span>
<span id="cb99-16"><a href="the-boids-flocking-model.html#cb99-16" tabindex="-1"></a>            separation_vector <span class="op">=</span> (separation_vector <span class="op">/</span> np.linalg.norm(separation_vector)) <span class="op">*</span> <span class="va">self</span>.max_force</span>
<span id="cb99-17"><a href="the-boids-flocking-model.html#cb99-17" tabindex="-1"></a>    </span>
<span id="cb99-18"><a href="the-boids-flocking-model.html#cb99-18" tabindex="-1"></a>    <span class="cf">return</span> separation_vector</span></code></pre></div>
<p>The distance check prevents division by zero when a boid evaluates separation from itself, while the perception threshold (one-third the full perception radius) creates a zone of strong repulsion that maintains natural spacing. The force limiting ensures realistic dynamics by preventing instantaneous velocity changes that would violate physical constraints.</p>
<p>The alignment rule computes the average velocity of neighbors and steers the boid toward this consensus heading:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="the-boids-flocking-model.html#cb100-1" tabindex="-1"></a><span class="kw">def</span> align(<span class="va">self</span>, neighbors):</span>
<span id="cb100-2"><a href="the-boids-flocking-model.html#cb100-2" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(neighbors) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb100-3"><a href="the-boids-flocking-model.html#cb100-3" tabindex="-1"></a>        <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb100-4"><a href="the-boids-flocking-model.html#cb100-4" tabindex="-1"></a>    </span>
<span id="cb100-5"><a href="the-boids-flocking-model.html#cb100-5" tabindex="-1"></a>    avg_velocity <span class="op">=</span> np.mean([n.velocity <span class="cf">for</span> n <span class="kw">in</span> neighbors], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb100-6"><a href="the-boids-flocking-model.html#cb100-6" tabindex="-1"></a>    </span>
<span id="cb100-7"><a href="the-boids-flocking-model.html#cb100-7" tabindex="-1"></a>    <span class="cf">if</span> np.linalg.norm(avg_velocity) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb100-8"><a href="the-boids-flocking-model.html#cb100-8" tabindex="-1"></a>        avg_velocity <span class="op">=</span> (avg_velocity <span class="op">/</span> np.linalg.norm(avg_velocity)) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb100-9"><a href="the-boids-flocking-model.html#cb100-9" tabindex="-1"></a>        steering <span class="op">=</span> avg_velocity <span class="op">-</span> <span class="va">self</span>.velocity</span>
<span id="cb100-10"><a href="the-boids-flocking-model.html#cb100-10" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(steering) <span class="op">&gt;</span> <span class="va">self</span>.max_force:</span>
<span id="cb100-11"><a href="the-boids-flocking-model.html#cb100-11" tabindex="-1"></a>            steering <span class="op">=</span> (steering <span class="op">/</span> np.linalg.norm(steering)) <span class="op">*</span> <span class="va">self</span>.max_force</span>
<span id="cb100-12"><a href="the-boids-flocking-model.html#cb100-12" tabindex="-1"></a>        <span class="cf">return</span> steering</span>
<span id="cb100-13"><a href="the-boids-flocking-model.html#cb100-13" tabindex="-1"></a>    </span>
<span id="cb100-14"><a href="the-boids-flocking-model.html#cb100-14" tabindex="-1"></a>    <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span></code></pre></div>
<p>The steering force represents desired velocity minus current velocity, implementing a proportional control mechanism that smoothly adjusts the boid’s heading toward the group consensus. This approach mirrors control theory principles, creating stable feedback that prevents oscillation.</p>
<p>Cohesion attracts boids toward their neighbors’ center of mass, implemented through a similar steering mechanism:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="the-boids-flocking-model.html#cb101-1" tabindex="-1"></a><span class="kw">def</span> cohere(<span class="va">self</span>, neighbors):</span>
<span id="cb101-2"><a href="the-boids-flocking-model.html#cb101-2" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(neighbors) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb101-3"><a href="the-boids-flocking-model.html#cb101-3" tabindex="-1"></a>        <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb101-4"><a href="the-boids-flocking-model.html#cb101-4" tabindex="-1"></a>    </span>
<span id="cb101-5"><a href="the-boids-flocking-model.html#cb101-5" tabindex="-1"></a>    center_of_mass <span class="op">=</span> np.mean([n.pos <span class="cf">for</span> n <span class="kw">in</span> neighbors], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb101-6"><a href="the-boids-flocking-model.html#cb101-6" tabindex="-1"></a>    desired <span class="op">=</span> center_of_mass <span class="op">-</span> <span class="va">self</span>.pos</span>
<span id="cb101-7"><a href="the-boids-flocking-model.html#cb101-7" tabindex="-1"></a>    </span>
<span id="cb101-8"><a href="the-boids-flocking-model.html#cb101-8" tabindex="-1"></a>    <span class="cf">if</span> np.linalg.norm(desired) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb101-9"><a href="the-boids-flocking-model.html#cb101-9" tabindex="-1"></a>        desired <span class="op">=</span> (desired <span class="op">/</span> np.linalg.norm(desired)) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb101-10"><a href="the-boids-flocking-model.html#cb101-10" tabindex="-1"></a>        steering <span class="op">=</span> desired <span class="op">-</span> <span class="va">self</span>.velocity</span>
<span id="cb101-11"><a href="the-boids-flocking-model.html#cb101-11" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(steering) <span class="op">&gt;</span> <span class="va">self</span>.max_force:</span>
<span id="cb101-12"><a href="the-boids-flocking-model.html#cb101-12" tabindex="-1"></a>            steering <span class="op">=</span> (steering <span class="op">/</span> np.linalg.norm(steering)) <span class="op">*</span> <span class="va">self</span>.max_force</span>
<span id="cb101-13"><a href="the-boids-flocking-model.html#cb101-13" tabindex="-1"></a>        <span class="cf">return</span> steering</span>
<span id="cb101-14"><a href="the-boids-flocking-model.html#cb101-14" tabindex="-1"></a>    </span>
<span id="cb101-15"><a href="the-boids-flocking-model.html#cb101-15" tabindex="-1"></a>    <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span></code></pre></div>
<p>The complete step method integrates these three forces with adjustable weights, updates velocity and position, and handles boundary conditions through toroidal wrapping:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="the-boids-flocking-model.html#cb102-1" tabindex="-1"></a><span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb102-2"><a href="the-boids-flocking-model.html#cb102-2" tabindex="-1"></a>    neighbors <span class="op">=</span> <span class="va">self</span>.model.space.get_neighbors(<span class="va">self</span>.pos, <span class="va">self</span>.perception_radius, include_center<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb102-3"><a href="the-boids-flocking-model.html#cb102-3" tabindex="-1"></a>    </span>
<span id="cb102-4"><a href="the-boids-flocking-model.html#cb102-4" tabindex="-1"></a>    separation <span class="op">=</span> <span class="va">self</span>.separate(neighbors) <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb102-5"><a href="the-boids-flocking-model.html#cb102-5" tabindex="-1"></a>    alignment <span class="op">=</span> <span class="va">self</span>.align(neighbors) <span class="op">*</span> <span class="fl">1.0</span></span>
<span id="cb102-6"><a href="the-boids-flocking-model.html#cb102-6" tabindex="-1"></a>    cohesion <span class="op">=</span> <span class="va">self</span>.cohere(neighbors) <span class="op">*</span> <span class="fl">1.0</span></span>
<span id="cb102-7"><a href="the-boids-flocking-model.html#cb102-7" tabindex="-1"></a>    </span>
<span id="cb102-8"><a href="the-boids-flocking-model.html#cb102-8" tabindex="-1"></a>    acceleration <span class="op">=</span> separation <span class="op">+</span> alignment <span class="op">+</span> cohesion</span>
<span id="cb102-9"><a href="the-boids-flocking-model.html#cb102-9" tabindex="-1"></a>    <span class="va">self</span>.velocity <span class="op">+=</span> acceleration</span>
<span id="cb102-10"><a href="the-boids-flocking-model.html#cb102-10" tabindex="-1"></a>    </span>
<span id="cb102-11"><a href="the-boids-flocking-model.html#cb102-11" tabindex="-1"></a>    speed <span class="op">=</span> np.linalg.norm(<span class="va">self</span>.velocity)</span>
<span id="cb102-12"><a href="the-boids-flocking-model.html#cb102-12" tabindex="-1"></a>    <span class="cf">if</span> speed <span class="op">&gt;</span> <span class="va">self</span>.max_speed:</span>
<span id="cb102-13"><a href="the-boids-flocking-model.html#cb102-13" tabindex="-1"></a>        <span class="va">self</span>.velocity <span class="op">=</span> (<span class="va">self</span>.velocity <span class="op">/</span> speed) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb102-14"><a href="the-boids-flocking-model.html#cb102-14" tabindex="-1"></a>    </span>
<span id="cb102-15"><a href="the-boids-flocking-model.html#cb102-15" tabindex="-1"></a>    new_pos <span class="op">=</span> <span class="va">self</span>.pos <span class="op">+</span> <span class="va">self</span>.velocity</span>
<span id="cb102-16"><a href="the-boids-flocking-model.html#cb102-16" tabindex="-1"></a>    new_pos[<span class="dv">0</span>] <span class="op">=</span> new_pos[<span class="dv">0</span>] <span class="op">%</span> <span class="va">self</span>.model.space.x_max</span>
<span id="cb102-17"><a href="the-boids-flocking-model.html#cb102-17" tabindex="-1"></a>    new_pos[<span class="dv">1</span>] <span class="op">=</span> new_pos[<span class="dv">1</span>] <span class="op">%</span> <span class="va">self</span>.model.space.y_max</span>
<span id="cb102-18"><a href="the-boids-flocking-model.html#cb102-18" tabindex="-1"></a>    </span>
<span id="cb102-19"><a href="the-boids-flocking-model.html#cb102-19" tabindex="-1"></a>    <span class="va">self</span>.model.space.move_agent(<span class="va">self</span>, new_pos)</span>
<span id="cb102-20"><a href="the-boids-flocking-model.html#cb102-20" tabindex="-1"></a>    <span class="va">self</span>.pos <span class="op">=</span> new_pos</span></code></pre></div>
<p>The weighting scheme (1.5 for separation, 1.0 for alignment and cohesion) reflects empirical tuning that balances the competing forces. Heavier weighting on separation prevents collision and maintains natural spacing, while equal weights on alignment and cohesion encourage group coordination without over-clustering.</p>
</div>
<div id="model-architecture-and-data-collection-1" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Model Architecture and Data Collection<a href="the-boids-flocking-model.html#model-architecture-and-data-collection-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>FlockingModel</code> class manages the continuous space environment and coordinates agent interactions:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="the-boids-flocking-model.html#cb103-1" tabindex="-1"></a><span class="kw">class</span> FlockingModel(Model):</span>
<span id="cb103-2"><a href="the-boids-flocking-model.html#cb103-2" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, n_boids<span class="op">=</span><span class="dv">100</span>, width<span class="op">=</span><span class="dv">100</span>, height<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb103-3"><a href="the-boids-flocking-model.html#cb103-3" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb103-4"><a href="the-boids-flocking-model.html#cb103-4" tabindex="-1"></a>        <span class="va">self</span>.n_boids <span class="op">=</span> n_boids</span>
<span id="cb103-5"><a href="the-boids-flocking-model.html#cb103-5" tabindex="-1"></a>        <span class="va">self</span>.space <span class="op">=</span> ContinuousSpace(width, height, torus<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb103-6"><a href="the-boids-flocking-model.html#cb103-6" tabindex="-1"></a>        </span>
<span id="cb103-7"><a href="the-boids-flocking-model.html#cb103-7" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.n_boids):</span>
<span id="cb103-8"><a href="the-boids-flocking-model.html#cb103-8" tabindex="-1"></a>            x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, width)</span>
<span id="cb103-9"><a href="the-boids-flocking-model.html#cb103-9" tabindex="-1"></a>            y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, height)</span>
<span id="cb103-10"><a href="the-boids-flocking-model.html#cb103-10" tabindex="-1"></a>            boid <span class="op">=</span> Boid(<span class="va">self</span>, (x, y))</span>
<span id="cb103-11"><a href="the-boids-flocking-model.html#cb103-11" tabindex="-1"></a>            <span class="va">self</span>.space.place_agent(boid, boid.pos)</span>
<span id="cb103-12"><a href="the-boids-flocking-model.html#cb103-12" tabindex="-1"></a>        </span>
<span id="cb103-13"><a href="the-boids-flocking-model.html#cb103-13" tabindex="-1"></a>        <span class="va">self</span>.datacollector <span class="op">=</span> DataCollector(</span>
<span id="cb103-14"><a href="the-boids-flocking-model.html#cb103-14" tabindex="-1"></a>            model_reporters<span class="op">=</span>{</span>
<span id="cb103-15"><a href="the-boids-flocking-model.html#cb103-15" tabindex="-1"></a>                <span class="st">&quot;Avg Speed&quot;</span>: <span class="kw">lambda</span> m: np.mean([np.linalg.norm(a.velocity) <span class="cf">for</span> a <span class="kw">in</span> m.agents]),</span>
<span id="cb103-16"><a href="the-boids-flocking-model.html#cb103-16" tabindex="-1"></a>                <span class="st">&quot;Avg Neighbors&quot;</span>: <span class="kw">lambda</span> m: np.mean([<span class="bu">len</span>(m.space.get_neighbors(a.pos, a.perception_radius, <span class="va">False</span>)) <span class="cf">for</span> a <span class="kw">in</span> m.agents])</span>
<span id="cb103-17"><a href="the-boids-flocking-model.html#cb103-17" tabindex="-1"></a>            }</span>
<span id="cb103-18"><a href="the-boids-flocking-model.html#cb103-18" tabindex="-1"></a>        )</span></code></pre></div>
<p>The continuous space contrasts sharply with the discrete grids of previous models. Positions can take any real-valued coordinates within the bounds, and distance calculations use Euclidean geometry rather than grid metrics. The toroidal topology eliminates edge effects by wrapping around boundaries, creating an unbounded environment that prevents artifacts from wall interactions.</p>
<p>Data collection tracks aggregate properties that reveal flock-level dynamics. Average speed indicates whether the flock moves coherently or fragments into independently moving subgroups. Average neighbor count measures local density and interaction patterns, providing insight into flock cohesion. These metrics enable quantitative analysis of emergent properties that would be difficult to assess through visualization alone.</p>
</div>
<div id="emergent-phenomena-and-pattern-formation" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Emergent Phenomena and Pattern Formation<a href="the-boids-flocking-model.html#emergent-phenomena-and-pattern-formation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When we run the flocking simulation, the initial chaos of randomly positioned and oriented boids gradually gives way to organized collective motion. This transition from disorder to order occurs without any central coordination—no boid leads the flock, no global information guides the process. Each boid responds only to its immediate neighbors, yet the local interactions propagate through the population to create system-wide patterns.</p>
<p>The temporal evolution reveals distinct phases in flock formation. Initially, boids with random velocities move in many different directions, creating a dispersed, disordered configuration. As the simulation progresses, local groups begin forming where nearby boids happen to move in similar directions. These proto-flocks grow as adjacent boids align with the local consensus, and eventually multiple groups merge into larger aggregations. The mature flock exhibits coherent collective motion with all boids moving roughly in the same direction while maintaining appropriate spacing.</p>
<p>The mathematical description of this order-disorder transition resembles phase transitions in statistical physics. We can define an order parameter Φ that measures the degree of velocity alignment across the flock:</p>
<p>Φ = ||Σᵢ <strong>v</strong>ᵢ/||<strong>v</strong>ᵢ|||| / N</p>
<p>where the sum extends over all N boids and we normalize individual velocities to unit length before averaging. This order parameter ranges from Φ ≈ 0 for completely disordered motion (velocities pointing in random directions cancel out) to Φ = 1 for perfect alignment (all boids moving in exactly the same direction). The transition from random initial conditions to organized flocking corresponds to Φ increasing from near-zero to high values approaching unity.</p>
<p>The perception radius plays a crucial role in determining whether flocking behavior emerges. Too small a perception radius prevents boids from sensing enough neighbors to coordinate effectively, leaving the system fragmented into small, disconnected groups. Too large a perception radius creates excessive interaction that can lead to unstable oscillations or unrealistic clustering. The optimal perception radius balances local interaction with computational efficiency, typically spanning several times the average inter-boid distance.</p>
</div>
<div id="variations-and-extensions" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Variations and Extensions<a href="the-boids-flocking-model.html#variations-and-extensions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The basic boids model admits numerous extensions that capture additional aspects of natural flocking behavior. Obstacle avoidance introduces environmental features that boids must navigate around, requiring an additional force that steers away from detected obstacles. Predator evasion adds predatory agents that trigger escape responses, creating dramatic collective evasion maneuvers where the flock scatters and reforms. Leader-follower dynamics introduce heterogeneity where some boids preferentially follow designated leaders, creating hierarchical flock structures.</p>
<p>Three-dimensional extensions naturally accommodate aerial flocking in birds or swimming schools of fish. The mathematics generalizes straightforwardly by adding a z-component to position and velocity vectors, though visualization becomes more challenging. The additional degree of freedom enables more complex maneuvering patterns, including banking turns and vertical climbs or dives.</p>
<p>Energy constraints provide biological realism by making speed costly. Boids might have energy reserves that deplete with sustained high-speed motion, forcing them to balance the benefits of staying with the flock against the costs of rapid movement. This extension can create interesting dynamics where flocks periodically slow down to conserve energy before accelerating again.</p>
<p>Information propagation through flocks represents another fascinating extension. If we give one boid knowledge of a distant food source or threat, how does this information spread through the flock? The boids model provides a framework for studying how individual knowledge becomes collective knowledge through purely local interactions, with potential applications to understanding communication in animal groups.</p>
</div>
<div id="computational-considerations" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Computational Considerations<a href="the-boids-flocking-model.html#computational-considerations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The continuous space implementation requires more sophisticated spatial indexing than grid-based models. Finding neighbors within a given radius becomes computationally expensive when done naively by checking distances to all other agents. For N boids, this naive approach requires O(N²) distance calculations per time step, becoming prohibitively expensive for large flocks. Mesa’s ContinuousSpace implements spatial indexing techniques that reduce this cost, though large-scale simulations still demand computational resources.</p>
<p>The animation capabilities demonstrate the power of modern scientific visualization:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="the-boids-flocking-model.html#cb104-1" tabindex="-1"></a><span class="kw">def</span> update(frame):</span>
<span id="cb104-2"><a href="the-boids-flocking-model.html#cb104-2" tabindex="-1"></a>    positions <span class="op">=</span> positions_history[frame]</span>
<span id="cb104-3"><a href="the-boids-flocking-model.html#cb104-3" tabindex="-1"></a>    velocities <span class="op">=</span> velocities_history[frame]</span>
<span id="cb104-4"><a href="the-boids-flocking-model.html#cb104-4" tabindex="-1"></a>    </span>
<span id="cb104-5"><a href="the-boids-flocking-model.html#cb104-5" tabindex="-1"></a>    ax1.scatter(positions[:, <span class="dv">0</span>], positions[:, <span class="dv">1</span>], c<span class="op">=</span><span class="st">&#39;blue&#39;</span>, s<span class="op">=</span><span class="dv">30</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb104-6"><a href="the-boids-flocking-model.html#cb104-6" tabindex="-1"></a>    ax1.quiver(positions[:, <span class="dv">0</span>], positions[:, <span class="dv">1</span>], </span>
<span id="cb104-7"><a href="the-boids-flocking-model.html#cb104-7" tabindex="-1"></a>               velocities[:, <span class="dv">0</span>], velocities[:, <span class="dv">1</span>],</span>
<span id="cb104-8"><a href="the-boids-flocking-model.html#cb104-8" tabindex="-1"></a>               color<span class="op">=</span><span class="st">&#39;red&#39;</span>, alpha<span class="op">=</span><span class="fl">0.4</span>, scale<span class="op">=</span><span class="dv">50</span>, width<span class="op">=</span><span class="fl">0.003</span>)</span>
<span id="cb104-9"><a href="the-boids-flocking-model.html#cb104-9" tabindex="-1"></a>    ax1.set_xlim(<span class="dv">0</span>, model.space.x_max)</span>
<span id="cb104-10"><a href="the-boids-flocking-model.html#cb104-10" tabindex="-1"></a>    ax1.set_ylim(<span class="dv">0</span>, model.space.y_max)</span>
<span id="cb104-11"><a href="the-boids-flocking-model.html#cb104-11" tabindex="-1"></a>    ax1.set_title(<span class="ss">f&#39;Boids Flocking Simulation (Step </span><span class="sc">{</span>frame<span class="sc">}</span><span class="ss">)&#39;</span>)</span></code></pre></div>
<p>The visualization combines positional information (scatter plot) with velocity vectors (quiver plot), providing both state and dynamics information in a single view. The transparency settings prevent visual clutter when many boids overlap, while the scaling parameters ensure velocity vectors remain visible without dominating the plot.</p>
<p>The dual-panel display showing both the spatial configuration and temporal metrics provides complementary perspectives on flock behavior. The spatial view reveals pattern geometry and local structure, while the time series reveals dynamics and stability. Together, they provide comprehensive understanding of the flocking phenomenon.</p>
</div>
<div id="biological-parallels-and-theoretical-insights" class="section level2 hasAnchor" number="13.7">
<h2><span class="header-section-number">13.7</span> Biological Parallels and Theoretical Insights<a href="the-boids-flocking-model.html#biological-parallels-and-theoretical-insights" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The remarkable success of the boids model in reproducing realistic flocking patterns raises profound questions about natural cognition and behavior. Real birds and fish obviously don’t compute vector forces and update velocity arrays, yet their behavior produces patterns nearly indistinguishable from the simulation. This suggests that evolution has discovered similar computational principles implemented through very different neural and sensory mechanisms.</p>
<p>Research in animal behavior has indeed confirmed that many flocking species follow rules remarkably similar to Reynolds’ three principles. Birds maintain preferred distances from neighbors (separation), match their neighbors’ flight speeds and directions (alignment), and stay near the group (cohesion). The specific parameter values—perception radii, force weights, speed limits—vary across species and contexts, but the underlying algorithmic structure appears conserved.</p>
<p>This convergence between computational models and natural behavior exemplifies the power of agent-based modeling as a theoretical tool. Rather than merely describing what happens, the model explains how simple local rules generate complex global patterns. The model makes testable predictions about how changing parameters should affect flock behavior, enabling systematic experimental validation.</p>
<p>The boids model also illuminates fundamental principles of distributed systems and collective computation. The flock exhibits properties that no individual boid possesses—coherent motion, adaptive shape changes, robustness to individual removal. These emergent properties arise from the interaction network rather than being programmed into any component. This principle finds applications far beyond biological flocking, informing the design of distributed algorithms, swarm robotics, and multi-agent systems.</p>
</div>
<div id="from-local-rules-to-global-order" class="section level2 hasAnchor" number="13.8">
<h2><span class="header-section-number">13.8</span> From Local Rules to Global Order<a href="the-boids-flocking-model.html#from-local-rules-to-global-order" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The progression from random walks through Schelling segregation to boids flocking reveals increasingly sophisticated forms of emergence. Random walks showed how simple stochastic rules generate complex trajectories. Schelling demonstrated how individual preferences aggregate into system-wide patterns that transcend individual intentions. Boids completes this trajectory by showing how purely local interactions create globally coherent collective behavior that appears purposeful and coordinated.</p>
<p>Each model builds conceptual foundations for the next. The random walk established the basic mechanics of agent-based simulation and data collection. Schelling added decision-making based on local neighborhood assessment. Boids extends these principles to continuous space with vector-based motion, multiple simultaneous forces, and dynamic group formation. Together, these models demonstrate the breadth and power of agent-based approaches to understanding complex systems.</p>
<p>The mathematical frameworks underlying these models share common themes despite their superficial differences. All three involve local interaction rules—random walks through grid adjacency, Schelling through neighborhood similarity, boids through spatial proximity. All three exhibit emergent phenomena where system-level patterns arise from agent-level rules. All three demonstrate sensitive dependence on parameters, with small changes producing qualitatively different outcomes.</p>
<p>The visualization and analysis techniques also build progressively. We moved from simple trajectory plots to spatial pattern visualization to animated vector fields showing both position and velocity. The data collection evolved from basic position tracking to aggregate measures of segregation to sophisticated metrics of collective order. This methodological progression parallels the conceptual development, with each model introducing new analytical tools appropriate to its specific phenomena.</p>
</div>
<div id="practical-applications-and-future-directions" class="section level2 hasAnchor" number="13.9">
<h2><span class="header-section-number">13.9</span> Practical Applications and Future Directions<a href="the-boids-flocking-model.html#practical-applications-and-future-directions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The boids model has found applications far beyond its original purpose of generating realistic animal animation. Swarm robotics employs boids-like algorithms to coordinate multiple robots performing collective tasks like area coverage, formation flying, or collaborative transport. Traffic flow models use modified boids rules to simulate vehicle behavior on highways, helping transportation engineers optimize road networks and predict congestion patterns.</p>
<p>Crowd simulation for emergency planning implements boids-inspired models to understand how human crowds move through building exits during evacuations. The balance between individual goal-seeking and crowd-following produces realistic crowd dynamics that inform architectural design and safety protocols. Military applications explore how autonomous drone swarms might coordinate using distributed boids-like rules, enabling resilient collective behavior without centralized command structures requiring vulnerable communication networks.</p>
<p>The model’s influence extends even to abstract domains like distributed computing and optimization algorithms. Particle swarm optimization adapts the boids framework to search parameter spaces, with particles representing candidate solutions that move toward better solutions while maintaining swarm cohesion. This marriage of collective behavior with computational problem-solving demonstrates how biological inspiration can yield powerful algorithms for practical applications.</p>
<p>Future extensions might incorporate more sophisticated environmental representations, including three-dimensional terrain, wind fields, or complex obstacle geometries. Enhanced behavioral realism could include fatigue, hunger, or reproductive behaviors that create additional constraints and objectives beyond simple flocking. Learning mechanisms might allow boids to adapt their parameters based on experience, potentially discovering novel collective strategies through reinforcement learning or evolutionary algorithms.</p>
<p>The integration of boids models with real animal tracking data offers exciting research opportunities. Modern GPS and accelerometer tags can record detailed movement data from wild animals, providing ground truth for validating and refining flocking models. Discrepancies between model predictions and observed behavior highlight gaps in our understanding, driving new hypotheses about the mechanisms governing natural flocking.</p>
</div>
<div id="conclusion-the-beauty-of-emergent-coordination" class="section level2 hasAnchor" number="13.10">
<h2><span class="header-section-number">13.10</span> Conclusion: The Beauty of Emergent Coordination<a href="the-boids-flocking-model.html#conclusion-the-beauty-of-emergent-coordination" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The boids flocking model stands as one of the most elegant demonstrations of how complexity arises from simplicity. Three straightforward rules—separate, align, cohere—combined with continuous space and vector-based motion, generate patterns that capture the essence of natural flocking behavior. The model requires no central coordinator, no global communication, no predetermined choreography. Order emerges spontaneously from purely local interactions, creating the mesmerizing coordinated motion we observe in nature.</p>
<p>This emergence exemplifies a fundamental principle of complex systems: the whole can exhibit properties and behaviors that are not present in any individual component. No boid knows about the flock’s overall motion or shape, yet the flock moves as a coherent entity. No boid tries to create beautiful aerial patterns, yet the collective produces forms of striking aesthetic appeal. The disconnect between individual rules and collective outcomes reveals the surprising consequences of interaction and feedback in multi-agent systems.</p>
<p>As we’ve progressed from random walks through segregation to flocking, we’ve witnessed increasing sophistication in both the models themselves and our tools for analyzing them. We’ve moved from discrete to continuous space, from single agents to coordinated groups, from static preferences to dynamic forces. Each step has revealed new aspects of how complex patterns emerge from simple rules, building our intuition about agent-based modeling while developing practical skills in implementation and analysis.</p>
<p>The journey continues, with many fascinating agent-based models still to explore. From epidemic spread to economic markets, from ecosystem dynamics to cultural evolution, agent-based approaches illuminate phenomena across every scientific domain. The boids model, with its elegant simplicity and visual beauty, provides both inspiration and foundation for understanding these more complex systems. As we watch the simulated flock wheel and turn across our screens, we glimpse the profound truth that underlies all agent-based modeling: the universe’s most complex patterns may arise from rules simple enough to fit in a few lines of code.</p>
</div>
<div id="complete-implementation" class="section level2 hasAnchor" number="13.11">
<h2><span class="header-section-number">13.11</span> Complete Implementation<a href="the-boids-flocking-model.html#complete-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb105"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="the-boids-flocking-model.html#cb105-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb105-2"><a href="the-boids-flocking-model.html#cb105-2" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb105-3"><a href="the-boids-flocking-model.html#cb105-3" tabindex="-1"></a><span class="im">import</span> matplotlib.animation <span class="im">as</span> animation</span>
<span id="cb105-4"><a href="the-boids-flocking-model.html#cb105-4" tabindex="-1"></a><span class="im">from</span> mesa <span class="im">import</span> Agent, Model</span>
<span id="cb105-5"><a href="the-boids-flocking-model.html#cb105-5" tabindex="-1"></a><span class="im">from</span> mesa.space <span class="im">import</span> ContinuousSpace</span>
<span id="cb105-6"><a href="the-boids-flocking-model.html#cb105-6" tabindex="-1"></a><span class="im">from</span> mesa.datacollection <span class="im">import</span> DataCollector</span>
<span id="cb105-7"><a href="the-boids-flocking-model.html#cb105-7" tabindex="-1"></a></span>
<span id="cb105-8"><a href="the-boids-flocking-model.html#cb105-8" tabindex="-1"></a><span class="kw">class</span> Boid(Agent):</span>
<span id="cb105-9"><a href="the-boids-flocking-model.html#cb105-9" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb105-10"><a href="the-boids-flocking-model.html#cb105-10" tabindex="-1"></a><span class="co">    A Boid agent following flocking rules: separation, alignment, cohesion</span></span>
<span id="cb105-11"><a href="the-boids-flocking-model.html#cb105-11" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb105-12"><a href="the-boids-flocking-model.html#cb105-12" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model, pos, velocity<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb105-13"><a href="the-boids-flocking-model.html#cb105-13" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(model)</span>
<span id="cb105-14"><a href="the-boids-flocking-model.html#cb105-14" tabindex="-1"></a>        <span class="va">self</span>.pos <span class="op">=</span> np.array(pos, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb105-15"><a href="the-boids-flocking-model.html#cb105-15" tabindex="-1"></a>        </span>
<span id="cb105-16"><a href="the-boids-flocking-model.html#cb105-16" tabindex="-1"></a>        <span class="co"># Initialize random velocity if not provided</span></span>
<span id="cb105-17"><a href="the-boids-flocking-model.html#cb105-17" tabindex="-1"></a>        <span class="cf">if</span> velocity <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb105-18"><a href="the-boids-flocking-model.html#cb105-18" tabindex="-1"></a>            angle <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span> np.pi)</span>
<span id="cb105-19"><a href="the-boids-flocking-model.html#cb105-19" tabindex="-1"></a>            speed <span class="op">=</span> np.random.uniform(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb105-20"><a href="the-boids-flocking-model.html#cb105-20" tabindex="-1"></a>            <span class="va">self</span>.velocity <span class="op">=</span> np.array([np.cos(angle) <span class="op">*</span> speed, np.sin(angle) <span class="op">*</span> speed])</span>
<span id="cb105-21"><a href="the-boids-flocking-model.html#cb105-21" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb105-22"><a href="the-boids-flocking-model.html#cb105-22" tabindex="-1"></a>            <span class="va">self</span>.velocity <span class="op">=</span> np.array(velocity, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb105-23"><a href="the-boids-flocking-model.html#cb105-23" tabindex="-1"></a>        </span>
<span id="cb105-24"><a href="the-boids-flocking-model.html#cb105-24" tabindex="-1"></a>        <span class="co"># Boid parameters</span></span>
<span id="cb105-25"><a href="the-boids-flocking-model.html#cb105-25" tabindex="-1"></a>        <span class="va">self</span>.max_speed <span class="op">=</span> <span class="fl">4.0</span></span>
<span id="cb105-26"><a href="the-boids-flocking-model.html#cb105-26" tabindex="-1"></a>        <span class="va">self</span>.max_force <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb105-27"><a href="the-boids-flocking-model.html#cb105-27" tabindex="-1"></a>        <span class="va">self</span>.perception_radius <span class="op">=</span> <span class="fl">15.0</span></span>
<span id="cb105-28"><a href="the-boids-flocking-model.html#cb105-28" tabindex="-1"></a>    </span>
<span id="cb105-29"><a href="the-boids-flocking-model.html#cb105-29" tabindex="-1"></a>    <span class="kw">def</span> separate(<span class="va">self</span>, neighbors):</span>
<span id="cb105-30"><a href="the-boids-flocking-model.html#cb105-30" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Avoid crowding neighbors (short range repulsion)&quot;&quot;&quot;</span></span>
<span id="cb105-31"><a href="the-boids-flocking-model.html#cb105-31" tabindex="-1"></a>        separation_vector <span class="op">=</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb105-32"><a href="the-boids-flocking-model.html#cb105-32" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(neighbors) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb105-33"><a href="the-boids-flocking-model.html#cb105-33" tabindex="-1"></a>            <span class="cf">return</span> separation_vector</span>
<span id="cb105-34"><a href="the-boids-flocking-model.html#cb105-34" tabindex="-1"></a>        </span>
<span id="cb105-35"><a href="the-boids-flocking-model.html#cb105-35" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb105-36"><a href="the-boids-flocking-model.html#cb105-36" tabindex="-1"></a>            distance <span class="op">=</span> np.linalg.norm(<span class="va">self</span>.pos <span class="op">-</span> neighbor.pos)</span>
<span id="cb105-37"><a href="the-boids-flocking-model.html#cb105-37" tabindex="-1"></a>            <span class="cf">if</span> <span class="dv">0</span> <span class="op">&lt;</span> distance <span class="op">&lt;</span> <span class="va">self</span>.perception_radius <span class="op">/</span> <span class="dv">3</span>:</span>
<span id="cb105-38"><a href="the-boids-flocking-model.html#cb105-38" tabindex="-1"></a>                diff <span class="op">=</span> <span class="va">self</span>.pos <span class="op">-</span> neighbor.pos</span>
<span id="cb105-39"><a href="the-boids-flocking-model.html#cb105-39" tabindex="-1"></a>                separation_vector <span class="op">+=</span> diff <span class="op">/</span> (distance <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb105-40"><a href="the-boids-flocking-model.html#cb105-40" tabindex="-1"></a>        </span>
<span id="cb105-41"><a href="the-boids-flocking-model.html#cb105-41" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(separation_vector) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb105-42"><a href="the-boids-flocking-model.html#cb105-42" tabindex="-1"></a>            separation_vector <span class="op">=</span> (separation_vector <span class="op">/</span> np.linalg.norm(separation_vector)) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb105-43"><a href="the-boids-flocking-model.html#cb105-43" tabindex="-1"></a>            separation_vector <span class="op">=</span> separation_vector <span class="op">-</span> <span class="va">self</span>.velocity</span>
<span id="cb105-44"><a href="the-boids-flocking-model.html#cb105-44" tabindex="-1"></a>            <span class="cf">if</span> np.linalg.norm(separation_vector) <span class="op">&gt;</span> <span class="va">self</span>.max_force:</span>
<span id="cb105-45"><a href="the-boids-flocking-model.html#cb105-45" tabindex="-1"></a>                separation_vector <span class="op">=</span> (separation_vector <span class="op">/</span> np.linalg.norm(separation_vector)) <span class="op">*</span> <span class="va">self</span>.max_force</span>
<span id="cb105-46"><a href="the-boids-flocking-model.html#cb105-46" tabindex="-1"></a>        </span>
<span id="cb105-47"><a href="the-boids-flocking-model.html#cb105-47" tabindex="-1"></a>        <span class="cf">return</span> separation_vector</span>
<span id="cb105-48"><a href="the-boids-flocking-model.html#cb105-48" tabindex="-1"></a>    </span>
<span id="cb105-49"><a href="the-boids-flocking-model.html#cb105-49" tabindex="-1"></a>    <span class="kw">def</span> align(<span class="va">self</span>, neighbors):</span>
<span id="cb105-50"><a href="the-boids-flocking-model.html#cb105-50" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Steer towards average heading of neighbors&quot;&quot;&quot;</span></span>
<span id="cb105-51"><a href="the-boids-flocking-model.html#cb105-51" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(neighbors) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb105-52"><a href="the-boids-flocking-model.html#cb105-52" tabindex="-1"></a>            <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb105-53"><a href="the-boids-flocking-model.html#cb105-53" tabindex="-1"></a>        </span>
<span id="cb105-54"><a href="the-boids-flocking-model.html#cb105-54" tabindex="-1"></a>        avg_velocity <span class="op">=</span> np.mean([n.velocity <span class="cf">for</span> n <span class="kw">in</span> neighbors], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb105-55"><a href="the-boids-flocking-model.html#cb105-55" tabindex="-1"></a>        </span>
<span id="cb105-56"><a href="the-boids-flocking-model.html#cb105-56" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(avg_velocity) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb105-57"><a href="the-boids-flocking-model.html#cb105-57" tabindex="-1"></a>            avg_velocity <span class="op">=</span> (avg_velocity <span class="op">/</span> np.linalg.norm(avg_velocity)) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb105-58"><a href="the-boids-flocking-model.html#cb105-58" tabindex="-1"></a>            steering <span class="op">=</span> avg_velocity <span class="op">-</span> <span class="va">self</span>.velocity</span>
<span id="cb105-59"><a href="the-boids-flocking-model.html#cb105-59" tabindex="-1"></a>            <span class="cf">if</span> np.linalg.norm(steering) <span class="op">&gt;</span> <span class="va">self</span>.max_force:</span>
<span id="cb105-60"><a href="the-boids-flocking-model.html#cb105-60" tabindex="-1"></a>                steering <span class="op">=</span> (steering <span class="op">/</span> np.linalg.norm(steering)) <span class="op">*</span> <span class="va">self</span>.max_force</span>
<span id="cb105-61"><a href="the-boids-flocking-model.html#cb105-61" tabindex="-1"></a>            <span class="cf">return</span> steering</span>
<span id="cb105-62"><a href="the-boids-flocking-model.html#cb105-62" tabindex="-1"></a>        </span>
<span id="cb105-63"><a href="the-boids-flocking-model.html#cb105-63" tabindex="-1"></a>        <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb105-64"><a href="the-boids-flocking-model.html#cb105-64" tabindex="-1"></a>    </span>
<span id="cb105-65"><a href="the-boids-flocking-model.html#cb105-65" tabindex="-1"></a>    <span class="kw">def</span> cohere(<span class="va">self</span>, neighbors):</span>
<span id="cb105-66"><a href="the-boids-flocking-model.html#cb105-66" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Steer towards average position of neighbors&quot;&quot;&quot;</span></span>
<span id="cb105-67"><a href="the-boids-flocking-model.html#cb105-67" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(neighbors) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb105-68"><a href="the-boids-flocking-model.html#cb105-68" tabindex="-1"></a>            <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb105-69"><a href="the-boids-flocking-model.html#cb105-69" tabindex="-1"></a>        </span>
<span id="cb105-70"><a href="the-boids-flocking-model.html#cb105-70" tabindex="-1"></a>        center_of_mass <span class="op">=</span> np.mean([n.pos <span class="cf">for</span> n <span class="kw">in</span> neighbors], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb105-71"><a href="the-boids-flocking-model.html#cb105-71" tabindex="-1"></a>        desired <span class="op">=</span> center_of_mass <span class="op">-</span> <span class="va">self</span>.pos</span>
<span id="cb105-72"><a href="the-boids-flocking-model.html#cb105-72" tabindex="-1"></a>        </span>
<span id="cb105-73"><a href="the-boids-flocking-model.html#cb105-73" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(desired) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb105-74"><a href="the-boids-flocking-model.html#cb105-74" tabindex="-1"></a>            desired <span class="op">=</span> (desired <span class="op">/</span> np.linalg.norm(desired)) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb105-75"><a href="the-boids-flocking-model.html#cb105-75" tabindex="-1"></a>            steering <span class="op">=</span> desired <span class="op">-</span> <span class="va">self</span>.velocity</span>
<span id="cb105-76"><a href="the-boids-flocking-model.html#cb105-76" tabindex="-1"></a>            <span class="cf">if</span> np.linalg.norm(steering) <span class="op">&gt;</span> <span class="va">self</span>.max_force:</span>
<span id="cb105-77"><a href="the-boids-flocking-model.html#cb105-77" tabindex="-1"></a>                steering <span class="op">=</span> (steering <span class="op">/</span> np.linalg.norm(steering)) <span class="op">*</span> <span class="va">self</span>.max_force</span>
<span id="cb105-78"><a href="the-boids-flocking-model.html#cb105-78" tabindex="-1"></a>            <span class="cf">return</span> steering</span>
<span id="cb105-79"><a href="the-boids-flocking-model.html#cb105-79" tabindex="-1"></a>        </span>
<span id="cb105-80"><a href="the-boids-flocking-model.html#cb105-80" tabindex="-1"></a>        <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb105-81"><a href="the-boids-flocking-model.html#cb105-81" tabindex="-1"></a>    </span>
<span id="cb105-82"><a href="the-boids-flocking-model.html#cb105-82" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb105-83"><a href="the-boids-flocking-model.html#cb105-83" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Execute one step of the boid&quot;&quot;&quot;</span></span>
<span id="cb105-84"><a href="the-boids-flocking-model.html#cb105-84" tabindex="-1"></a>        neighbors <span class="op">=</span> <span class="va">self</span>.model.space.get_neighbors(<span class="va">self</span>.pos, <span class="va">self</span>.perception_radius, include_center<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb105-85"><a href="the-boids-flocking-model.html#cb105-85" tabindex="-1"></a>        </span>
<span id="cb105-86"><a href="the-boids-flocking-model.html#cb105-86" tabindex="-1"></a>        separation <span class="op">=</span> <span class="va">self</span>.separate(neighbors) <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb105-87"><a href="the-boids-flocking-model.html#cb105-87" tabindex="-1"></a>        alignment <span class="op">=</span> <span class="va">self</span>.align(neighbors) <span class="op">*</span> <span class="fl">1.0</span></span>
<span id="cb105-88"><a href="the-boids-flocking-model.html#cb105-88" tabindex="-1"></a>        cohesion <span class="op">=</span> <span class="va">self</span>.cohere(neighbors) <span class="op">*</span> <span class="fl">1.0</span></span>
<span id="cb105-89"><a href="the-boids-flocking-model.html#cb105-89" tabindex="-1"></a>        </span>
<span id="cb105-90"><a href="the-boids-flocking-model.html#cb105-90" tabindex="-1"></a>        acceleration <span class="op">=</span> separation <span class="op">+</span> alignment <span class="op">+</span> cohesion</span>
<span id="cb105-91"><a href="the-boids-flocking-model.html#cb105-91" tabindex="-1"></a>        <span class="va">self</span>.velocity <span class="op">+=</span> acceleration</span>
<span id="cb105-92"><a href="the-boids-flocking-model.html#cb105-92" tabindex="-1"></a>        </span>
<span id="cb105-93"><a href="the-boids-flocking-model.html#cb105-93" tabindex="-1"></a>        speed <span class="op">=</span> np.linalg.norm(<span class="va">self</span>.velocity)</span>
<span id="cb105-94"><a href="the-boids-flocking-model.html#cb105-94" tabindex="-1"></a>        <span class="cf">if</span> speed <span class="op">&gt;</span> <span class="va">self</span>.max_speed:</span>
<span id="cb105-95"><a href="the-boids-flocking-model.html#cb105-95" tabindex="-1"></a>            <span class="va">self</span>.velocity <span class="op">=</span> (<span class="va">self</span>.velocity <span class="op">/</span> speed) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb105-96"><a href="the-boids-flocking-model.html#cb105-96" tabindex="-1"></a>        </span>
<span id="cb105-97"><a href="the-boids-flocking-model.html#cb105-97" tabindex="-1"></a>        new_pos <span class="op">=</span> <span class="va">self</span>.pos <span class="op">+</span> <span class="va">self</span>.velocity</span>
<span id="cb105-98"><a href="the-boids-flocking-model.html#cb105-98" tabindex="-1"></a>        new_pos[<span class="dv">0</span>] <span class="op">=</span> new_pos[<span class="dv">0</span>] <span class="op">%</span> <span class="va">self</span>.model.space.x_max</span>
<span id="cb105-99"><a href="the-boids-flocking-model.html#cb105-99" tabindex="-1"></a>        new_pos[<span class="dv">1</span>] <span class="op">=</span> new_pos[<span class="dv">1</span>] <span class="op">%</span> <span class="va">self</span>.model.space.y_max</span>
<span id="cb105-100"><a href="the-boids-flocking-model.html#cb105-100" tabindex="-1"></a>        </span>
<span id="cb105-101"><a href="the-boids-flocking-model.html#cb105-101" tabindex="-1"></a>        <span class="va">self</span>.model.space.move_agent(<span class="va">self</span>, new_pos)</span>
<span id="cb105-102"><a href="the-boids-flocking-model.html#cb105-102" tabindex="-1"></a>        <span class="va">self</span>.pos <span class="op">=</span> new_pos</span>
<span id="cb105-103"><a href="the-boids-flocking-model.html#cb105-103" tabindex="-1"></a></span>
<span id="cb105-104"><a href="the-boids-flocking-model.html#cb105-104" tabindex="-1"></a></span>
<span id="cb105-105"><a href="the-boids-flocking-model.html#cb105-105" tabindex="-1"></a><span class="kw">class</span> FlockingModel(Model):</span>
<span id="cb105-106"><a href="the-boids-flocking-model.html#cb105-106" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb105-107"><a href="the-boids-flocking-model.html#cb105-107" tabindex="-1"></a><span class="co">    Model of flocking behavior using Boids algorithm</span></span>
<span id="cb105-108"><a href="the-boids-flocking-model.html#cb105-108" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb105-109"><a href="the-boids-flocking-model.html#cb105-109" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, n_boids<span class="op">=</span><span class="dv">100</span>, width<span class="op">=</span><span class="dv">100</span>, height<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb105-110"><a href="the-boids-flocking-model.html#cb105-110" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb105-111"><a href="the-boids-flocking-model.html#cb105-111" tabindex="-1"></a>        <span class="va">self</span>.n_boids <span class="op">=</span> n_boids</span>
<span id="cb105-112"><a href="the-boids-flocking-model.html#cb105-112" tabindex="-1"></a>        <span class="va">self</span>.space <span class="op">=</span> ContinuousSpace(width, height, torus<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb105-113"><a href="the-boids-flocking-model.html#cb105-113" tabindex="-1"></a>        </span>
<span id="cb105-114"><a href="the-boids-flocking-model.html#cb105-114" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.n_boids):</span>
<span id="cb105-115"><a href="the-boids-flocking-model.html#cb105-115" tabindex="-1"></a>            x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, width)</span>
<span id="cb105-116"><a href="the-boids-flocking-model.html#cb105-116" tabindex="-1"></a>            y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, height)</span>
<span id="cb105-117"><a href="the-boids-flocking-model.html#cb105-117" tabindex="-1"></a>            boid <span class="op">=</span> Boid(<span class="va">self</span>, (x, y))</span>
<span id="cb105-118"><a href="the-boids-flocking-model.html#cb105-118" tabindex="-1"></a>            <span class="va">self</span>.space.place_agent(boid, boid.pos)</span>
<span id="cb105-119"><a href="the-boids-flocking-model.html#cb105-119" tabindex="-1"></a>        </span>
<span id="cb105-120"><a href="the-boids-flocking-model.html#cb105-120" tabindex="-1"></a>        <span class="va">self</span>.datacollector <span class="op">=</span> DataCollector(</span>
<span id="cb105-121"><a href="the-boids-flocking-model.html#cb105-121" tabindex="-1"></a>            model_reporters<span class="op">=</span>{</span>
<span id="cb105-122"><a href="the-boids-flocking-model.html#cb105-122" tabindex="-1"></a>                <span class="st">&quot;Avg Speed&quot;</span>: <span class="kw">lambda</span> m: np.mean([np.linalg.norm(a.velocity) <span class="cf">for</span> a <span class="kw">in</span> m.agents]),</span>
<span id="cb105-123"><a href="the-boids-flocking-model.html#cb105-123" tabindex="-1"></a>                <span class="st">&quot;Avg Neighbors&quot;</span>: <span class="kw">lambda</span> m: np.mean([<span class="bu">len</span>(m.space.get_neighbors(a.pos, a.perception_radius, <span class="va">False</span>)) <span class="cf">for</span> a <span class="kw">in</span> m.agents])</span>
<span id="cb105-124"><a href="the-boids-flocking-model.html#cb105-124" tabindex="-1"></a>            }</span>
<span id="cb105-125"><a href="the-boids-flocking-model.html#cb105-125" tabindex="-1"></a>        )</span>
<span id="cb105-126"><a href="the-boids-flocking-model.html#cb105-126" tabindex="-1"></a>    </span>
<span id="cb105-127"><a href="the-boids-flocking-model.html#cb105-127" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb105-128"><a href="the-boids-flocking-model.html#cb105-128" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Advance the model by one step&quot;&quot;&quot;</span></span>
<span id="cb105-129"><a href="the-boids-flocking-model.html#cb105-129" tabindex="-1"></a>        <span class="va">self</span>.datacollector.collect(<span class="va">self</span>)</span>
<span id="cb105-130"><a href="the-boids-flocking-model.html#cb105-130" tabindex="-1"></a>        all_agents <span class="op">=</span> <span class="bu">list</span>(<span class="va">self</span>.agents)</span>
<span id="cb105-131"><a href="the-boids-flocking-model.html#cb105-131" tabindex="-1"></a>        <span class="va">self</span>.random.shuffle(all_agents)</span>
<span id="cb105-132"><a href="the-boids-flocking-model.html#cb105-132" tabindex="-1"></a>        <span class="cf">for</span> agent <span class="kw">in</span> all_agents:</span>
<span id="cb105-133"><a href="the-boids-flocking-model.html#cb105-133" tabindex="-1"></a>            agent.step()</span>
<span id="cb105-134"><a href="the-boids-flocking-model.html#cb105-134" tabindex="-1"></a></span>
<span id="cb105-135"><a href="the-boids-flocking-model.html#cb105-135" tabindex="-1"></a></span>
<span id="cb105-136"><a href="the-boids-flocking-model.html#cb105-136" tabindex="-1"></a><span class="co"># Run simulation</span></span>
<span id="cb105-137"><a href="the-boids-flocking-model.html#cb105-137" tabindex="-1"></a>model <span class="op">=</span> FlockingModel(n_boids<span class="op">=</span><span class="dv">80</span>, width<span class="op">=</span><span class="dv">100</span>, height<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb105-138"><a href="the-boids-flocking-model.html#cb105-138" tabindex="-1"></a></span>
<span id="cb105-139"><a href="the-boids-flocking-model.html#cb105-139" tabindex="-1"></a>n_steps <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb105-140"><a href="the-boids-flocking-model.html#cb105-140" tabindex="-1"></a>positions_history <span class="op">=</span> []</span>
<span id="cb105-141"><a href="the-boids-flocking-model.html#cb105-141" tabindex="-1"></a>velocities_history <span class="op">=</span> []</span>
<span id="cb105-142"><a href="the-boids-flocking-model.html#cb105-142" tabindex="-1"></a></span>
<span id="cb105-143"><a href="the-boids-flocking-model.html#cb105-143" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps):</span>
<span id="cb105-144"><a href="the-boids-flocking-model.html#cb105-144" tabindex="-1"></a>    model.step()</span>
<span id="cb105-145"><a href="the-boids-flocking-model.html#cb105-145" tabindex="-1"></a>    positions <span class="op">=</span> np.array([agent.pos <span class="cf">for</span> agent <span class="kw">in</span> model.agents])</span>
<span id="cb105-146"><a href="the-boids-flocking-model.html#cb105-146" tabindex="-1"></a>    velocities <span class="op">=</span> np.array([agent.velocity <span class="cf">for</span> agent <span class="kw">in</span> model.agents])</span>
<span id="cb105-147"><a href="the-boids-flocking-model.html#cb105-147" tabindex="-1"></a>    positions_history.append(positions)</span>
<span id="cb105-148"><a href="the-boids-flocking-model.html#cb105-148" tabindex="-1"></a>    velocities_history.append(velocities)</span>
<span id="cb105-149"><a href="the-boids-flocking-model.html#cb105-149" tabindex="-1"></a></span>
<span id="cb105-150"><a href="the-boids-flocking-model.html#cb105-150" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb105-151"><a href="the-boids-flocking-model.html#cb105-151" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">7</span>))</span>
<span id="cb105-152"><a href="the-boids-flocking-model.html#cb105-152" tabindex="-1"></a></span>
<span id="cb105-153"><a href="the-boids-flocking-model.html#cb105-153" tabindex="-1"></a><span class="kw">def</span> update(frame):</span>
<span id="cb105-154"><a href="the-boids-flocking-model.html#cb105-154" tabindex="-1"></a>    ax1.clear()</span>
<span id="cb105-155"><a href="the-boids-flocking-model.html#cb105-155" tabindex="-1"></a>    ax2.clear()</span>
<span id="cb105-156"><a href="the-boids-flocking-model.html#cb105-156" tabindex="-1"></a>    </span>
<span id="cb105-157"><a href="the-boids-flocking-model.html#cb105-157" tabindex="-1"></a>    positions <span class="op">=</span> positions_history[frame]</span>
<span id="cb105-158"><a href="the-boids-flocking-model.html#cb105-158" tabindex="-1"></a>    velocities <span class="op">=</span> velocities_history[frame]</span>
<span id="cb105-159"><a href="the-boids-flocking-model.html#cb105-159" tabindex="-1"></a>    </span>
<span id="cb105-160"><a href="the-boids-flocking-model.html#cb105-160" tabindex="-1"></a>    ax1.scatter(positions[:, <span class="dv">0</span>], positions[:, <span class="dv">1</span>], c<span class="op">=</span><span class="st">&#39;blue&#39;</span>, s<span class="op">=</span><span class="dv">30</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb105-161"><a href="the-boids-flocking-model.html#cb105-161" tabindex="-1"></a>    ax1.quiver(positions[:, <span class="dv">0</span>], positions[:, <span class="dv">1</span>], </span>
<span id="cb105-162"><a href="the-boids-flocking-model.html#cb105-162" tabindex="-1"></a>               velocities[:, <span class="dv">0</span>], velocities[:, <span class="dv">1</span>],</span>
<span id="cb105-163"><a href="the-boids-flocking-model.html#cb105-163" tabindex="-1"></a>               color<span class="op">=</span><span class="st">&#39;red&#39;</span>, alpha<span class="op">=</span><span class="fl">0.4</span>, scale<span class="op">=</span><span class="dv">50</span>, width<span class="op">=</span><span class="fl">0.003</span>)</span>
<span id="cb105-164"><a href="the-boids-flocking-model.html#cb105-164" tabindex="-1"></a>    ax1.set_xlim(<span class="dv">0</span>, model.space.x_max)</span>
<span id="cb105-165"><a href="the-boids-flocking-model.html#cb105-165" tabindex="-1"></a>    ax1.set_ylim(<span class="dv">0</span>, model.space.y_max)</span>
<span id="cb105-166"><a href="the-boids-flocking-model.html#cb105-166" tabindex="-1"></a>    ax1.set_title(<span class="ss">f&#39;Boids Flocking Simulation (Step </span><span class="sc">{</span>frame<span class="sc">}</span><span class="ss">)&#39;</span>)</span>
<span id="cb105-167"><a href="the-boids-flocking-model.html#cb105-167" tabindex="-1"></a>    </span>
<span id="cb105-168"><a href="the-boids-flocking-model.html#cb105-168" tabindex="-1"></a>    data <span class="op">=</span> model.datacollector.get_model_vars_dataframe()</span>
<span id="cb105-169"><a href="the-boids-flocking-model.html#cb105-169" tabindex="-1"></a>    ax2.plot(data[<span class="st">&#39;Avg Speed&#39;</span>], <span class="st">&#39;b-&#39;</span>, label<span class="op">=</span><span class="st">&#39;Avg Speed&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb105-170"><a href="the-boids-flocking-model.html#cb105-170" tabindex="-1"></a>    ax2_twin <span class="op">=</span> ax2.twinx()</span>
<span id="cb105-171"><a href="the-boids-flocking-model.html#cb105-171" tabindex="-1"></a>    ax2_twin.plot(data[<span class="st">&#39;Avg Neighbors&#39;</span>], <span class="st">&#39;g-&#39;</span>, label<span class="op">=</span><span class="st">&#39;Avg Neighbors&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb105-172"><a href="the-boids-flocking-model.html#cb105-172" tabindex="-1"></a>    ax2.axvline(x<span class="op">=</span>frame, color<span class="op">=</span><span class="st">&#39;red&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb105-173"><a href="the-boids-flocking-model.html#cb105-173" tabindex="-1"></a>    </span>
<span id="cb105-174"><a href="the-boids-flocking-model.html#cb105-174" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb105-175"><a href="the-boids-flocking-model.html#cb105-175" tabindex="-1"></a></span>
<span id="cb105-176"><a href="the-boids-flocking-model.html#cb105-176" tabindex="-1"></a>anim <span class="op">=</span> animation.FuncAnimation(fig, update, frames<span class="op">=</span><span class="bu">range</span>(<span class="dv">0</span>, n_steps, <span class="dv">2</span>), </span>
<span id="cb105-177"><a href="the-boids-flocking-model.html#cb105-177" tabindex="-1"></a>                              interval<span class="op">=</span><span class="dv">50</span>, repeat<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb105-178"><a href="the-boids-flocking-model.html#cb105-178" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="the-boids-flocking-model.html#cb106-1" tabindex="-1"></a><span class="co"># Install Mesa if not already installed</span></span>
<span id="cb106-2"><a href="the-boids-flocking-model.html#cb106-2" tabindex="-1"></a><span class="co"># !pip install mesa matplotlib numpy</span></span>
<span id="cb106-3"><a href="the-boids-flocking-model.html#cb106-3" tabindex="-1"></a></span>
<span id="cb106-4"><a href="the-boids-flocking-model.html#cb106-4" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb106-5"><a href="the-boids-flocking-model.html#cb106-5" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb106-6"><a href="the-boids-flocking-model.html#cb106-6" tabindex="-1"></a><span class="im">import</span> matplotlib.animation <span class="im">as</span> animation</span>
<span id="cb106-7"><a href="the-boids-flocking-model.html#cb106-7" tabindex="-1"></a><span class="im">from</span> mesa <span class="im">import</span> Agent, Model</span>
<span id="cb106-8"><a href="the-boids-flocking-model.html#cb106-8" tabindex="-1"></a><span class="im">from</span> mesa.space <span class="im">import</span> ContinuousSpace</span>
<span id="cb106-9"><a href="the-boids-flocking-model.html#cb106-9" tabindex="-1"></a><span class="im">from</span> mesa.datacollection <span class="im">import</span> DataCollector</span>
<span id="cb106-10"><a href="the-boids-flocking-model.html#cb106-10" tabindex="-1"></a></span>
<span id="cb106-11"><a href="the-boids-flocking-model.html#cb106-11" tabindex="-1"></a><span class="kw">class</span> Boid(Agent):</span>
<span id="cb106-12"><a href="the-boids-flocking-model.html#cb106-12" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb106-13"><a href="the-boids-flocking-model.html#cb106-13" tabindex="-1"></a><span class="co">    A Boid agent following flocking rules: separation, alignment, cohesion</span></span>
<span id="cb106-14"><a href="the-boids-flocking-model.html#cb106-14" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb106-15"><a href="the-boids-flocking-model.html#cb106-15" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model, pos, velocity<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb106-16"><a href="the-boids-flocking-model.html#cb106-16" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(model)</span>
<span id="cb106-17"><a href="the-boids-flocking-model.html#cb106-17" tabindex="-1"></a>        <span class="va">self</span>.pos <span class="op">=</span> np.array(pos, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb106-18"><a href="the-boids-flocking-model.html#cb106-18" tabindex="-1"></a>        </span>
<span id="cb106-19"><a href="the-boids-flocking-model.html#cb106-19" tabindex="-1"></a>        <span class="co"># Initialize random velocity if not provided</span></span>
<span id="cb106-20"><a href="the-boids-flocking-model.html#cb106-20" tabindex="-1"></a>        <span class="cf">if</span> velocity <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb106-21"><a href="the-boids-flocking-model.html#cb106-21" tabindex="-1"></a>            angle <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span> np.pi)</span>
<span id="cb106-22"><a href="the-boids-flocking-model.html#cb106-22" tabindex="-1"></a>            speed <span class="op">=</span> np.random.uniform(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb106-23"><a href="the-boids-flocking-model.html#cb106-23" tabindex="-1"></a>            <span class="va">self</span>.velocity <span class="op">=</span> np.array([np.cos(angle) <span class="op">*</span> speed, np.sin(angle) <span class="op">*</span> speed])</span>
<span id="cb106-24"><a href="the-boids-flocking-model.html#cb106-24" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb106-25"><a href="the-boids-flocking-model.html#cb106-25" tabindex="-1"></a>            <span class="va">self</span>.velocity <span class="op">=</span> np.array(velocity, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb106-26"><a href="the-boids-flocking-model.html#cb106-26" tabindex="-1"></a>        </span>
<span id="cb106-27"><a href="the-boids-flocking-model.html#cb106-27" tabindex="-1"></a>        <span class="co"># Boid parameters</span></span>
<span id="cb106-28"><a href="the-boids-flocking-model.html#cb106-28" tabindex="-1"></a>        <span class="va">self</span>.max_speed <span class="op">=</span> <span class="fl">4.0</span></span>
<span id="cb106-29"><a href="the-boids-flocking-model.html#cb106-29" tabindex="-1"></a>        <span class="va">self</span>.max_force <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb106-30"><a href="the-boids-flocking-model.html#cb106-30" tabindex="-1"></a>        <span class="va">self</span>.perception_radius <span class="op">=</span> <span class="fl">15.0</span></span>
<span id="cb106-31"><a href="the-boids-flocking-model.html#cb106-31" tabindex="-1"></a>    </span>
<span id="cb106-32"><a href="the-boids-flocking-model.html#cb106-32" tabindex="-1"></a>    <span class="kw">def</span> separate(<span class="va">self</span>, neighbors):</span>
<span id="cb106-33"><a href="the-boids-flocking-model.html#cb106-33" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Avoid crowding neighbors (short range repulsion)&quot;&quot;&quot;</span></span>
<span id="cb106-34"><a href="the-boids-flocking-model.html#cb106-34" tabindex="-1"></a>        separation_vector <span class="op">=</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb106-35"><a href="the-boids-flocking-model.html#cb106-35" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(neighbors) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb106-36"><a href="the-boids-flocking-model.html#cb106-36" tabindex="-1"></a>            <span class="cf">return</span> separation_vector</span>
<span id="cb106-37"><a href="the-boids-flocking-model.html#cb106-37" tabindex="-1"></a>        </span>
<span id="cb106-38"><a href="the-boids-flocking-model.html#cb106-38" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb106-39"><a href="the-boids-flocking-model.html#cb106-39" tabindex="-1"></a>            distance <span class="op">=</span> np.linalg.norm(<span class="va">self</span>.pos <span class="op">-</span> neighbor.pos)</span>
<span id="cb106-40"><a href="the-boids-flocking-model.html#cb106-40" tabindex="-1"></a>            <span class="cf">if</span> <span class="dv">0</span> <span class="op">&lt;</span> distance <span class="op">&lt;</span> <span class="va">self</span>.perception_radius <span class="op">/</span> <span class="dv">3</span>:</span>
<span id="cb106-41"><a href="the-boids-flocking-model.html#cb106-41" tabindex="-1"></a>                diff <span class="op">=</span> <span class="va">self</span>.pos <span class="op">-</span> neighbor.pos</span>
<span id="cb106-42"><a href="the-boids-flocking-model.html#cb106-42" tabindex="-1"></a>                <span class="co"># Weight by distance (closer = stronger repulsion)</span></span>
<span id="cb106-43"><a href="the-boids-flocking-model.html#cb106-43" tabindex="-1"></a>                separation_vector <span class="op">+=</span> diff <span class="op">/</span> (distance <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb106-44"><a href="the-boids-flocking-model.html#cb106-44" tabindex="-1"></a>        </span>
<span id="cb106-45"><a href="the-boids-flocking-model.html#cb106-45" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(separation_vector) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb106-46"><a href="the-boids-flocking-model.html#cb106-46" tabindex="-1"></a>            <span class="co"># Normalize and scale to max_speed</span></span>
<span id="cb106-47"><a href="the-boids-flocking-model.html#cb106-47" tabindex="-1"></a>            separation_vector <span class="op">=</span> (separation_vector <span class="op">/</span> np.linalg.norm(separation_vector)) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb106-48"><a href="the-boids-flocking-model.html#cb106-48" tabindex="-1"></a>            <span class="co"># Steering = desired - velocity</span></span>
<span id="cb106-49"><a href="the-boids-flocking-model.html#cb106-49" tabindex="-1"></a>            separation_vector <span class="op">=</span> separation_vector <span class="op">-</span> <span class="va">self</span>.velocity</span>
<span id="cb106-50"><a href="the-boids-flocking-model.html#cb106-50" tabindex="-1"></a>            <span class="co"># Limit force</span></span>
<span id="cb106-51"><a href="the-boids-flocking-model.html#cb106-51" tabindex="-1"></a>            <span class="cf">if</span> np.linalg.norm(separation_vector) <span class="op">&gt;</span> <span class="va">self</span>.max_force:</span>
<span id="cb106-52"><a href="the-boids-flocking-model.html#cb106-52" tabindex="-1"></a>                separation_vector <span class="op">=</span> (separation_vector <span class="op">/</span> np.linalg.norm(separation_vector)) <span class="op">*</span> <span class="va">self</span>.max_force</span>
<span id="cb106-53"><a href="the-boids-flocking-model.html#cb106-53" tabindex="-1"></a>        </span>
<span id="cb106-54"><a href="the-boids-flocking-model.html#cb106-54" tabindex="-1"></a>        <span class="cf">return</span> separation_vector</span>
<span id="cb106-55"><a href="the-boids-flocking-model.html#cb106-55" tabindex="-1"></a>    </span>
<span id="cb106-56"><a href="the-boids-flocking-model.html#cb106-56" tabindex="-1"></a>    <span class="kw">def</span> align(<span class="va">self</span>, neighbors):</span>
<span id="cb106-57"><a href="the-boids-flocking-model.html#cb106-57" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Steer towards average heading of neighbors&quot;&quot;&quot;</span></span>
<span id="cb106-58"><a href="the-boids-flocking-model.html#cb106-58" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(neighbors) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb106-59"><a href="the-boids-flocking-model.html#cb106-59" tabindex="-1"></a>            <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb106-60"><a href="the-boids-flocking-model.html#cb106-60" tabindex="-1"></a>        </span>
<span id="cb106-61"><a href="the-boids-flocking-model.html#cb106-61" tabindex="-1"></a>        avg_velocity <span class="op">=</span> np.mean([n.velocity <span class="cf">for</span> n <span class="kw">in</span> neighbors], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb106-62"><a href="the-boids-flocking-model.html#cb106-62" tabindex="-1"></a>        </span>
<span id="cb106-63"><a href="the-boids-flocking-model.html#cb106-63" tabindex="-1"></a>        <span class="co"># Normalize and scale to max_speed</span></span>
<span id="cb106-64"><a href="the-boids-flocking-model.html#cb106-64" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(avg_velocity) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb106-65"><a href="the-boids-flocking-model.html#cb106-65" tabindex="-1"></a>            avg_velocity <span class="op">=</span> (avg_velocity <span class="op">/</span> np.linalg.norm(avg_velocity)) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb106-66"><a href="the-boids-flocking-model.html#cb106-66" tabindex="-1"></a>            <span class="co"># Steering = desired - velocity</span></span>
<span id="cb106-67"><a href="the-boids-flocking-model.html#cb106-67" tabindex="-1"></a>            steering <span class="op">=</span> avg_velocity <span class="op">-</span> <span class="va">self</span>.velocity</span>
<span id="cb106-68"><a href="the-boids-flocking-model.html#cb106-68" tabindex="-1"></a>            <span class="co"># Limit force</span></span>
<span id="cb106-69"><a href="the-boids-flocking-model.html#cb106-69" tabindex="-1"></a>            <span class="cf">if</span> np.linalg.norm(steering) <span class="op">&gt;</span> <span class="va">self</span>.max_force:</span>
<span id="cb106-70"><a href="the-boids-flocking-model.html#cb106-70" tabindex="-1"></a>                steering <span class="op">=</span> (steering <span class="op">/</span> np.linalg.norm(steering)) <span class="op">*</span> <span class="va">self</span>.max_force</span>
<span id="cb106-71"><a href="the-boids-flocking-model.html#cb106-71" tabindex="-1"></a>            <span class="cf">return</span> steering</span>
<span id="cb106-72"><a href="the-boids-flocking-model.html#cb106-72" tabindex="-1"></a>        </span>
<span id="cb106-73"><a href="the-boids-flocking-model.html#cb106-73" tabindex="-1"></a>        <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb106-74"><a href="the-boids-flocking-model.html#cb106-74" tabindex="-1"></a>    </span>
<span id="cb106-75"><a href="the-boids-flocking-model.html#cb106-75" tabindex="-1"></a>    <span class="kw">def</span> cohere(<span class="va">self</span>, neighbors):</span>
<span id="cb106-76"><a href="the-boids-flocking-model.html#cb106-76" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Steer towards average position of neighbors&quot;&quot;&quot;</span></span>
<span id="cb106-77"><a href="the-boids-flocking-model.html#cb106-77" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(neighbors) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb106-78"><a href="the-boids-flocking-model.html#cb106-78" tabindex="-1"></a>            <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb106-79"><a href="the-boids-flocking-model.html#cb106-79" tabindex="-1"></a>        </span>
<span id="cb106-80"><a href="the-boids-flocking-model.html#cb106-80" tabindex="-1"></a>        center_of_mass <span class="op">=</span> np.mean([n.pos <span class="cf">for</span> n <span class="kw">in</span> neighbors], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb106-81"><a href="the-boids-flocking-model.html#cb106-81" tabindex="-1"></a>        desired <span class="op">=</span> center_of_mass <span class="op">-</span> <span class="va">self</span>.pos</span>
<span id="cb106-82"><a href="the-boids-flocking-model.html#cb106-82" tabindex="-1"></a>        </span>
<span id="cb106-83"><a href="the-boids-flocking-model.html#cb106-83" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(desired) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb106-84"><a href="the-boids-flocking-model.html#cb106-84" tabindex="-1"></a>            <span class="co"># Normalize and scale to max_speed</span></span>
<span id="cb106-85"><a href="the-boids-flocking-model.html#cb106-85" tabindex="-1"></a>            desired <span class="op">=</span> (desired <span class="op">/</span> np.linalg.norm(desired)) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb106-86"><a href="the-boids-flocking-model.html#cb106-86" tabindex="-1"></a>            <span class="co"># Steering = desired - velocity</span></span>
<span id="cb106-87"><a href="the-boids-flocking-model.html#cb106-87" tabindex="-1"></a>            steering <span class="op">=</span> desired <span class="op">-</span> <span class="va">self</span>.velocity</span>
<span id="cb106-88"><a href="the-boids-flocking-model.html#cb106-88" tabindex="-1"></a>            <span class="co"># Limit force</span></span>
<span id="cb106-89"><a href="the-boids-flocking-model.html#cb106-89" tabindex="-1"></a>            <span class="cf">if</span> np.linalg.norm(steering) <span class="op">&gt;</span> <span class="va">self</span>.max_force:</span>
<span id="cb106-90"><a href="the-boids-flocking-model.html#cb106-90" tabindex="-1"></a>                steering <span class="op">=</span> (steering <span class="op">/</span> np.linalg.norm(steering)) <span class="op">*</span> <span class="va">self</span>.max_force</span>
<span id="cb106-91"><a href="the-boids-flocking-model.html#cb106-91" tabindex="-1"></a>            <span class="cf">return</span> steering</span>
<span id="cb106-92"><a href="the-boids-flocking-model.html#cb106-92" tabindex="-1"></a>        </span>
<span id="cb106-93"><a href="the-boids-flocking-model.html#cb106-93" tabindex="-1"></a>        <span class="cf">return</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb106-94"><a href="the-boids-flocking-model.html#cb106-94" tabindex="-1"></a>    </span>
<span id="cb106-95"><a href="the-boids-flocking-model.html#cb106-95" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb106-96"><a href="the-boids-flocking-model.html#cb106-96" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Execute one step of the boid&quot;&quot;&quot;</span></span>
<span id="cb106-97"><a href="the-boids-flocking-model.html#cb106-97" tabindex="-1"></a>        <span class="co"># Get neighbors within perception radius</span></span>
<span id="cb106-98"><a href="the-boids-flocking-model.html#cb106-98" tabindex="-1"></a>        neighbors <span class="op">=</span> <span class="va">self</span>.model.space.get_neighbors(<span class="va">self</span>.pos, <span class="va">self</span>.perception_radius, include_center<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb106-99"><a href="the-boids-flocking-model.html#cb106-99" tabindex="-1"></a>        </span>
<span id="cb106-100"><a href="the-boids-flocking-model.html#cb106-100" tabindex="-1"></a>        <span class="co"># Apply flocking rules</span></span>
<span id="cb106-101"><a href="the-boids-flocking-model.html#cb106-101" tabindex="-1"></a>        separation <span class="op">=</span> <span class="va">self</span>.separate(neighbors) <span class="op">*</span> <span class="fl">1.5</span>  <span class="co"># Weight separation more</span></span>
<span id="cb106-102"><a href="the-boids-flocking-model.html#cb106-102" tabindex="-1"></a>        alignment <span class="op">=</span> <span class="va">self</span>.align(neighbors) <span class="op">*</span> <span class="fl">1.0</span></span>
<span id="cb106-103"><a href="the-boids-flocking-model.html#cb106-103" tabindex="-1"></a>        cohesion <span class="op">=</span> <span class="va">self</span>.cohere(neighbors) <span class="op">*</span> <span class="fl">1.0</span></span>
<span id="cb106-104"><a href="the-boids-flocking-model.html#cb106-104" tabindex="-1"></a>        </span>
<span id="cb106-105"><a href="the-boids-flocking-model.html#cb106-105" tabindex="-1"></a>        <span class="co"># Update velocity</span></span>
<span id="cb106-106"><a href="the-boids-flocking-model.html#cb106-106" tabindex="-1"></a>        acceleration <span class="op">=</span> separation <span class="op">+</span> alignment <span class="op">+</span> cohesion</span>
<span id="cb106-107"><a href="the-boids-flocking-model.html#cb106-107" tabindex="-1"></a>        <span class="va">self</span>.velocity <span class="op">+=</span> acceleration</span>
<span id="cb106-108"><a href="the-boids-flocking-model.html#cb106-108" tabindex="-1"></a>        </span>
<span id="cb106-109"><a href="the-boids-flocking-model.html#cb106-109" tabindex="-1"></a>        <span class="co"># Limit speed</span></span>
<span id="cb106-110"><a href="the-boids-flocking-model.html#cb106-110" tabindex="-1"></a>        speed <span class="op">=</span> np.linalg.norm(<span class="va">self</span>.velocity)</span>
<span id="cb106-111"><a href="the-boids-flocking-model.html#cb106-111" tabindex="-1"></a>        <span class="cf">if</span> speed <span class="op">&gt;</span> <span class="va">self</span>.max_speed:</span>
<span id="cb106-112"><a href="the-boids-flocking-model.html#cb106-112" tabindex="-1"></a>            <span class="va">self</span>.velocity <span class="op">=</span> (<span class="va">self</span>.velocity <span class="op">/</span> speed) <span class="op">*</span> <span class="va">self</span>.max_speed</span>
<span id="cb106-113"><a href="the-boids-flocking-model.html#cb106-113" tabindex="-1"></a>        </span>
<span id="cb106-114"><a href="the-boids-flocking-model.html#cb106-114" tabindex="-1"></a>        <span class="co"># Update position</span></span>
<span id="cb106-115"><a href="the-boids-flocking-model.html#cb106-115" tabindex="-1"></a>        new_pos <span class="op">=</span> <span class="va">self</span>.pos <span class="op">+</span> <span class="va">self</span>.velocity</span>
<span id="cb106-116"><a href="the-boids-flocking-model.html#cb106-116" tabindex="-1"></a>        </span>
<span id="cb106-117"><a href="the-boids-flocking-model.html#cb106-117" tabindex="-1"></a>        <span class="co"># Wrap around edges (toroidal space)</span></span>
<span id="cb106-118"><a href="the-boids-flocking-model.html#cb106-118" tabindex="-1"></a>        new_pos[<span class="dv">0</span>] <span class="op">=</span> new_pos[<span class="dv">0</span>] <span class="op">%</span> <span class="va">self</span>.model.space.x_max</span>
<span id="cb106-119"><a href="the-boids-flocking-model.html#cb106-119" tabindex="-1"></a>        new_pos[<span class="dv">1</span>] <span class="op">=</span> new_pos[<span class="dv">1</span>] <span class="op">%</span> <span class="va">self</span>.model.space.y_max</span>
<span id="cb106-120"><a href="the-boids-flocking-model.html#cb106-120" tabindex="-1"></a>        </span>
<span id="cb106-121"><a href="the-boids-flocking-model.html#cb106-121" tabindex="-1"></a>        <span class="va">self</span>.model.space.move_agent(<span class="va">self</span>, new_pos)</span>
<span id="cb106-122"><a href="the-boids-flocking-model.html#cb106-122" tabindex="-1"></a>        <span class="va">self</span>.pos <span class="op">=</span> new_pos</span>
<span id="cb106-123"><a href="the-boids-flocking-model.html#cb106-123" tabindex="-1"></a></span>
<span id="cb106-124"><a href="the-boids-flocking-model.html#cb106-124" tabindex="-1"></a></span>
<span id="cb106-125"><a href="the-boids-flocking-model.html#cb106-125" tabindex="-1"></a><span class="kw">class</span> FlockingModel(Model):</span>
<span id="cb106-126"><a href="the-boids-flocking-model.html#cb106-126" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb106-127"><a href="the-boids-flocking-model.html#cb106-127" tabindex="-1"></a><span class="co">    Model of flocking behavior using Boids algorithm</span></span>
<span id="cb106-128"><a href="the-boids-flocking-model.html#cb106-128" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb106-129"><a href="the-boids-flocking-model.html#cb106-129" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, n_boids<span class="op">=</span><span class="dv">100</span>, width<span class="op">=</span><span class="dv">100</span>, height<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb106-130"><a href="the-boids-flocking-model.html#cb106-130" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb106-131"><a href="the-boids-flocking-model.html#cb106-131" tabindex="-1"></a>        <span class="va">self</span>.n_boids <span class="op">=</span> n_boids</span>
<span id="cb106-132"><a href="the-boids-flocking-model.html#cb106-132" tabindex="-1"></a>        <span class="va">self</span>.space <span class="op">=</span> ContinuousSpace(width, height, torus<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb106-133"><a href="the-boids-flocking-model.html#cb106-133" tabindex="-1"></a>        </span>
<span id="cb106-134"><a href="the-boids-flocking-model.html#cb106-134" tabindex="-1"></a>        <span class="co"># Create boids - Mesa 3.0 automatically tracks agents</span></span>
<span id="cb106-135"><a href="the-boids-flocking-model.html#cb106-135" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.n_boids):</span>
<span id="cb106-136"><a href="the-boids-flocking-model.html#cb106-136" tabindex="-1"></a>            x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, width)</span>
<span id="cb106-137"><a href="the-boids-flocking-model.html#cb106-137" tabindex="-1"></a>            y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, height)</span>
<span id="cb106-138"><a href="the-boids-flocking-model.html#cb106-138" tabindex="-1"></a>            boid <span class="op">=</span> Boid(<span class="va">self</span>, (x, y))</span>
<span id="cb106-139"><a href="the-boids-flocking-model.html#cb106-139" tabindex="-1"></a>            <span class="va">self</span>.space.place_agent(boid, boid.pos)</span>
<span id="cb106-140"><a href="the-boids-flocking-model.html#cb106-140" tabindex="-1"></a>        </span>
<span id="cb106-141"><a href="the-boids-flocking-model.html#cb106-141" tabindex="-1"></a>        <span class="co"># Data collection</span></span>
<span id="cb106-142"><a href="the-boids-flocking-model.html#cb106-142" tabindex="-1"></a>        <span class="va">self</span>.datacollector <span class="op">=</span> DataCollector(</span>
<span id="cb106-143"><a href="the-boids-flocking-model.html#cb106-143" tabindex="-1"></a>            model_reporters<span class="op">=</span>{</span>
<span id="cb106-144"><a href="the-boids-flocking-model.html#cb106-144" tabindex="-1"></a>                <span class="st">&quot;Avg Speed&quot;</span>: <span class="kw">lambda</span> m: np.mean([np.linalg.norm(a.velocity) <span class="cf">for</span> a <span class="kw">in</span> m.agents]),</span>
<span id="cb106-145"><a href="the-boids-flocking-model.html#cb106-145" tabindex="-1"></a>                <span class="st">&quot;Avg Neighbors&quot;</span>: <span class="kw">lambda</span> m: np.mean([<span class="bu">len</span>(m.space.get_neighbors(a.pos, a.perception_radius, <span class="va">False</span>)) <span class="cf">for</span> a <span class="kw">in</span> m.agents])</span>
<span id="cb106-146"><a href="the-boids-flocking-model.html#cb106-146" tabindex="-1"></a>            }</span>
<span id="cb106-147"><a href="the-boids-flocking-model.html#cb106-147" tabindex="-1"></a>        )</span>
<span id="cb106-148"><a href="the-boids-flocking-model.html#cb106-148" tabindex="-1"></a>    </span>
<span id="cb106-149"><a href="the-boids-flocking-model.html#cb106-149" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb106-150"><a href="the-boids-flocking-model.html#cb106-150" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Advance the model by one step&quot;&quot;&quot;</span></span>
<span id="cb106-151"><a href="the-boids-flocking-model.html#cb106-151" tabindex="-1"></a>        <span class="va">self</span>.datacollector.collect(<span class="va">self</span>)</span>
<span id="cb106-152"><a href="the-boids-flocking-model.html#cb106-152" tabindex="-1"></a>        <span class="co"># Get all agents and shuffle for random activation</span></span>
<span id="cb106-153"><a href="the-boids-flocking-model.html#cb106-153" tabindex="-1"></a>        all_agents <span class="op">=</span> <span class="bu">list</span>(<span class="va">self</span>.agents)</span>
<span id="cb106-154"><a href="the-boids-flocking-model.html#cb106-154" tabindex="-1"></a>        <span class="va">self</span>.random.shuffle(all_agents)</span>
<span id="cb106-155"><a href="the-boids-flocking-model.html#cb106-155" tabindex="-1"></a>        <span class="cf">for</span> agent <span class="kw">in</span> all_agents:</span>
<span id="cb106-156"><a href="the-boids-flocking-model.html#cb106-156" tabindex="-1"></a>            agent.step()</span>
<span id="cb106-157"><a href="the-boids-flocking-model.html#cb106-157" tabindex="-1"></a></span>
<span id="cb106-158"><a href="the-boids-flocking-model.html#cb106-158" tabindex="-1"></a></span>
<span id="cb106-159"><a href="the-boids-flocking-model.html#cb106-159" tabindex="-1"></a><span class="co"># Initialize and run model</span></span>
<span id="cb106-160"><a href="the-boids-flocking-model.html#cb106-160" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Initializing Boids Flocking Model...&quot;</span>)</span>
<span id="cb106-161"><a href="the-boids-flocking-model.html#cb106-161" tabindex="-1"></a>model <span class="op">=</span> FlockingModel(n_boids<span class="op">=</span><span class="dv">80</span>, width<span class="op">=</span><span class="dv">100</span>, height<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb106-162"><a href="the-boids-flocking-model.html#cb106-162" tabindex="-1"></a></span>
<span id="cb106-163"><a href="the-boids-flocking-model.html#cb106-163" tabindex="-1"></a><span class="co"># Run simulation and collect data for animation</span></span>
<span id="cb106-164"><a href="the-boids-flocking-model.html#cb106-164" tabindex="-1"></a>n_steps <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb106-165"><a href="the-boids-flocking-model.html#cb106-165" tabindex="-1"></a>positions_history <span class="op">=</span> []</span>
<span id="cb106-166"><a href="the-boids-flocking-model.html#cb106-166" tabindex="-1"></a>velocities_history <span class="op">=</span> []</span>
<span id="cb106-167"><a href="the-boids-flocking-model.html#cb106-167" tabindex="-1"></a></span>
<span id="cb106-168"><a href="the-boids-flocking-model.html#cb106-168" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps):</span>
<span id="cb106-169"><a href="the-boids-flocking-model.html#cb106-169" tabindex="-1"></a>    model.step()</span>
<span id="cb106-170"><a href="the-boids-flocking-model.html#cb106-170" tabindex="-1"></a>    positions <span class="op">=</span> np.array([agent.pos <span class="cf">for</span> agent <span class="kw">in</span> model.agents])</span>
<span id="cb106-171"><a href="the-boids-flocking-model.html#cb106-171" tabindex="-1"></a>    velocities <span class="op">=</span> np.array([agent.velocity <span class="cf">for</span> agent <span class="kw">in</span> model.agents])</span>
<span id="cb106-172"><a href="the-boids-flocking-model.html#cb106-172" tabindex="-1"></a>    positions_history.append(positions)</span>
<span id="cb106-173"><a href="the-boids-flocking-model.html#cb106-173" tabindex="-1"></a>    velocities_history.append(velocities)</span>
<span id="cb106-174"><a href="the-boids-flocking-model.html#cb106-174" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="dv">50</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb106-175"><a href="the-boids-flocking-model.html#cb106-175" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Step </span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>n_steps<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb106-176"><a href="the-boids-flocking-model.html#cb106-176" tabindex="-1"></a></span>
<span id="cb106-177"><a href="the-boids-flocking-model.html#cb106-177" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Simulation complete!&quot;</span>)</span>
<span id="cb106-178"><a href="the-boids-flocking-model.html#cb106-178" tabindex="-1"></a></span>
<span id="cb106-179"><a href="the-boids-flocking-model.html#cb106-179" tabindex="-1"></a><span class="co"># Create animation</span></span>
<span id="cb106-180"><a href="the-boids-flocking-model.html#cb106-180" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">7</span>))</span>
<span id="cb106-181"><a href="the-boids-flocking-model.html#cb106-181" tabindex="-1"></a></span>
<span id="cb106-182"><a href="the-boids-flocking-model.html#cb106-182" tabindex="-1"></a><span class="kw">def</span> update(frame):</span>
<span id="cb106-183"><a href="the-boids-flocking-model.html#cb106-183" tabindex="-1"></a>    ax1.clear()</span>
<span id="cb106-184"><a href="the-boids-flocking-model.html#cb106-184" tabindex="-1"></a>    ax2.clear()</span>
<span id="cb106-185"><a href="the-boids-flocking-model.html#cb106-185" tabindex="-1"></a>    </span>
<span id="cb106-186"><a href="the-boids-flocking-model.html#cb106-186" tabindex="-1"></a>    positions <span class="op">=</span> positions_history[frame]</span>
<span id="cb106-187"><a href="the-boids-flocking-model.html#cb106-187" tabindex="-1"></a>    velocities <span class="op">=</span> velocities_history[frame]</span>
<span id="cb106-188"><a href="the-boids-flocking-model.html#cb106-188" tabindex="-1"></a>    </span>
<span id="cb106-189"><a href="the-boids-flocking-model.html#cb106-189" tabindex="-1"></a>    <span class="co"># Main flocking visualization</span></span>
<span id="cb106-190"><a href="the-boids-flocking-model.html#cb106-190" tabindex="-1"></a>    ax1.scatter(positions[:, <span class="dv">0</span>], positions[:, <span class="dv">1</span>], c<span class="op">=</span><span class="st">&#39;blue&#39;</span>, s<span class="op">=</span><span class="dv">30</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb106-191"><a href="the-boids-flocking-model.html#cb106-191" tabindex="-1"></a>    <span class="co"># Draw velocity vectors</span></span>
<span id="cb106-192"><a href="the-boids-flocking-model.html#cb106-192" tabindex="-1"></a>    ax1.quiver(positions[:, <span class="dv">0</span>], positions[:, <span class="dv">1</span>], </span>
<span id="cb106-193"><a href="the-boids-flocking-model.html#cb106-193" tabindex="-1"></a>               velocities[:, <span class="dv">0</span>], velocities[:, <span class="dv">1</span>],</span>
<span id="cb106-194"><a href="the-boids-flocking-model.html#cb106-194" tabindex="-1"></a>               color<span class="op">=</span><span class="st">&#39;red&#39;</span>, alpha<span class="op">=</span><span class="fl">0.4</span>, scale<span class="op">=</span><span class="dv">50</span>, width<span class="op">=</span><span class="fl">0.003</span>)</span>
<span id="cb106-195"><a href="the-boids-flocking-model.html#cb106-195" tabindex="-1"></a>    ax1.set_xlim(<span class="dv">0</span>, model.space.x_max)</span>
<span id="cb106-196"><a href="the-boids-flocking-model.html#cb106-196" tabindex="-1"></a>    ax1.set_ylim(<span class="dv">0</span>, model.space.y_max)</span>
<span id="cb106-197"><a href="the-boids-flocking-model.html#cb106-197" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;X Position&#39;</span>)</span>
<span id="cb106-198"><a href="the-boids-flocking-model.html#cb106-198" tabindex="-1"></a>    ax1.set_ylabel(<span class="st">&#39;Y Position&#39;</span>)</span>
<span id="cb106-199"><a href="the-boids-flocking-model.html#cb106-199" tabindex="-1"></a>    ax1.set_title(<span class="ss">f&#39;Boids Flocking Simulation (Step </span><span class="sc">{</span>frame<span class="sc">}</span><span class="ss">)&#39;</span>)</span>
<span id="cb106-200"><a href="the-boids-flocking-model.html#cb106-200" tabindex="-1"></a>    ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb106-201"><a href="the-boids-flocking-model.html#cb106-201" tabindex="-1"></a>    ax1.set_aspect(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb106-202"><a href="the-boids-flocking-model.html#cb106-202" tabindex="-1"></a>    </span>
<span id="cb106-203"><a href="the-boids-flocking-model.html#cb106-203" tabindex="-1"></a>    <span class="co"># Statistics plot</span></span>
<span id="cb106-204"><a href="the-boids-flocking-model.html#cb106-204" tabindex="-1"></a>    data <span class="op">=</span> model.datacollector.get_model_vars_dataframe()</span>
<span id="cb106-205"><a href="the-boids-flocking-model.html#cb106-205" tabindex="-1"></a>    steps <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(data))</span>
<span id="cb106-206"><a href="the-boids-flocking-model.html#cb106-206" tabindex="-1"></a>    </span>
<span id="cb106-207"><a href="the-boids-flocking-model.html#cb106-207" tabindex="-1"></a>    ax2_twin <span class="op">=</span> ax2.twinx()</span>
<span id="cb106-208"><a href="the-boids-flocking-model.html#cb106-208" tabindex="-1"></a>    </span>
<span id="cb106-209"><a href="the-boids-flocking-model.html#cb106-209" tabindex="-1"></a>    line1 <span class="op">=</span> ax2.plot(steps, data[<span class="st">&#39;Avg Speed&#39;</span>], <span class="st">&#39;b-&#39;</span>, label<span class="op">=</span><span class="st">&#39;Avg Speed&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb106-210"><a href="the-boids-flocking-model.html#cb106-210" tabindex="-1"></a>    line2 <span class="op">=</span> ax2_twin.plot(steps, data[<span class="st">&#39;Avg Neighbors&#39;</span>], <span class="st">&#39;g-&#39;</span>, label<span class="op">=</span><span class="st">&#39;Avg Neighbors&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb106-211"><a href="the-boids-flocking-model.html#cb106-211" tabindex="-1"></a>    </span>
<span id="cb106-212"><a href="the-boids-flocking-model.html#cb106-212" tabindex="-1"></a>    ax2.axvline(x<span class="op">=</span>frame, color<span class="op">=</span><span class="st">&#39;red&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb106-213"><a href="the-boids-flocking-model.html#cb106-213" tabindex="-1"></a>    </span>
<span id="cb106-214"><a href="the-boids-flocking-model.html#cb106-214" tabindex="-1"></a>    ax2.set_xlabel(<span class="st">&#39;Step&#39;</span>)</span>
<span id="cb106-215"><a href="the-boids-flocking-model.html#cb106-215" tabindex="-1"></a>    ax2.set_ylabel(<span class="st">&#39;Average Speed&#39;</span>, color<span class="op">=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb106-216"><a href="the-boids-flocking-model.html#cb106-216" tabindex="-1"></a>    ax2_twin.set_ylabel(<span class="st">&#39;Average Neighbors&#39;</span>, color<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb106-217"><a href="the-boids-flocking-model.html#cb106-217" tabindex="-1"></a>    ax2.tick_params(axis<span class="op">=</span><span class="st">&#39;y&#39;</span>, labelcolor<span class="op">=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb106-218"><a href="the-boids-flocking-model.html#cb106-218" tabindex="-1"></a>    ax2_twin.tick_params(axis<span class="op">=</span><span class="st">&#39;y&#39;</span>, labelcolor<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb106-219"><a href="the-boids-flocking-model.html#cb106-219" tabindex="-1"></a>    ax2.set_title(<span class="st">&#39;Swarm Metrics Over Time&#39;</span>)</span>
<span id="cb106-220"><a href="the-boids-flocking-model.html#cb106-220" tabindex="-1"></a>    ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb106-221"><a href="the-boids-flocking-model.html#cb106-221" tabindex="-1"></a>    </span>
<span id="cb106-222"><a href="the-boids-flocking-model.html#cb106-222" tabindex="-1"></a>    <span class="co"># Combine legends</span></span>
<span id="cb106-223"><a href="the-boids-flocking-model.html#cb106-223" tabindex="-1"></a>    lines <span class="op">=</span> line1 <span class="op">+</span> line2</span>
<span id="cb106-224"><a href="the-boids-flocking-model.html#cb106-224" tabindex="-1"></a>    labels <span class="op">=</span> [l.get_label() <span class="cf">for</span> l <span class="kw">in</span> lines]</span>
<span id="cb106-225"><a href="the-boids-flocking-model.html#cb106-225" tabindex="-1"></a>    ax2.legend(lines, labels, loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb106-226"><a href="the-boids-flocking-model.html#cb106-226" tabindex="-1"></a>    </span>
<span id="cb106-227"><a href="the-boids-flocking-model.html#cb106-227" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb106-228"><a href="the-boids-flocking-model.html#cb106-228" tabindex="-1"></a></span>
<span id="cb106-229"><a href="the-boids-flocking-model.html#cb106-229" tabindex="-1"></a><span class="co"># Create animation</span></span>
<span id="cb106-230"><a href="the-boids-flocking-model.html#cb106-230" tabindex="-1"></a>anim <span class="op">=</span> animation.FuncAnimation(fig, update, frames<span class="op">=</span><span class="bu">range</span>(<span class="dv">0</span>, n_steps, <span class="dv">2</span>), </span>
<span id="cb106-231"><a href="the-boids-flocking-model.html#cb106-231" tabindex="-1"></a>                              interval<span class="op">=</span><span class="dv">50</span>, repeat<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb106-232"><a href="the-boids-flocking-model.html#cb106-232" tabindex="-1"></a></span>
<span id="cb106-233"><a href="the-boids-flocking-model.html#cb106-233" tabindex="-1"></a>plt.show()</span>
<span id="cb106-234"><a href="the-boids-flocking-model.html#cb106-234" tabindex="-1"></a></span>
<span id="cb106-235"><a href="the-boids-flocking-model.html#cb106-235" tabindex="-1"></a><span class="co"># Display final statistics</span></span>
<span id="cb106-236"><a href="the-boids-flocking-model.html#cb106-236" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">=== Simulation Statistics ===&quot;</span>)</span>
<span id="cb106-237"><a href="the-boids-flocking-model.html#cb106-237" tabindex="-1"></a>data <span class="op">=</span> model.datacollector.get_model_vars_dataframe()</span>
<span id="cb106-238"><a href="the-boids-flocking-model.html#cb106-238" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Final Average Speed: </span><span class="sc">{</span>data[<span class="st">&#39;Avg Speed&#39;</span>]<span class="sc">.</span>iloc[<span class="op">-</span><span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb106-239"><a href="the-boids-flocking-model.html#cb106-239" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Final Average Neighbors: </span><span class="sc">{</span>data[<span class="st">&#39;Avg Neighbors&#39;</span>]<span class="sc">.</span>iloc[<span class="op">-</span><span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb106-240"><a href="the-boids-flocking-model.html#cb106-240" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Speed Std Dev: </span><span class="sc">{</span>data[<span class="st">&#39;Avg Speed&#39;</span>]<span class="sc">.</span>std()<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb106-241"><a href="the-boids-flocking-model.html#cb106-241" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Neighbors Std Dev: </span><span class="sc">{</span>data[<span class="st">&#39;Avg Neighbors&#39;</span>]<span class="sc">.</span>std()<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb106-242"><a href="the-boids-flocking-model.html#cb106-242" tabindex="-1"></a></span>
<span id="cb106-243"><a href="the-boids-flocking-model.html#cb106-243" tabindex="-1"></a><span class="co"># Show final state</span></span>
<span id="cb106-244"><a href="the-boids-flocking-model.html#cb106-244" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb106-245"><a href="the-boids-flocking-model.html#cb106-245" tabindex="-1"></a>final_positions <span class="op">=</span> positions_history[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb106-246"><a href="the-boids-flocking-model.html#cb106-246" tabindex="-1"></a>final_velocities <span class="op">=</span> velocities_history[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb106-247"><a href="the-boids-flocking-model.html#cb106-247" tabindex="-1"></a></span>
<span id="cb106-248"><a href="the-boids-flocking-model.html#cb106-248" tabindex="-1"></a>ax.scatter(final_positions[:, <span class="dv">0</span>], final_positions[:, <span class="dv">1</span>], c<span class="op">=</span><span class="st">&#39;blue&#39;</span>, s<span class="op">=</span><span class="dv">50</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, label<span class="op">=</span><span class="st">&#39;Boids&#39;</span>)</span>
<span id="cb106-249"><a href="the-boids-flocking-model.html#cb106-249" tabindex="-1"></a>ax.quiver(final_positions[:, <span class="dv">0</span>], final_positions[:, <span class="dv">1</span>], </span>
<span id="cb106-250"><a href="the-boids-flocking-model.html#cb106-250" tabindex="-1"></a>          final_velocities[:, <span class="dv">0</span>], final_velocities[:, <span class="dv">1</span>],</span>
<span id="cb106-251"><a href="the-boids-flocking-model.html#cb106-251" tabindex="-1"></a>          color<span class="op">=</span><span class="st">&#39;red&#39;</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, scale<span class="op">=</span><span class="dv">40</span>, width<span class="op">=</span><span class="fl">0.004</span>, label<span class="op">=</span><span class="st">&#39;Velocity&#39;</span>)</span>
<span id="cb106-252"><a href="the-boids-flocking-model.html#cb106-252" tabindex="-1"></a>ax.set_xlim(<span class="dv">0</span>, model.space.x_max)</span>
<span id="cb106-253"><a href="the-boids-flocking-model.html#cb106-253" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, model.space.y_max)</span>
<span id="cb106-254"><a href="the-boids-flocking-model.html#cb106-254" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;X Position&#39;</span>)</span>
<span id="cb106-255"><a href="the-boids-flocking-model.html#cb106-255" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Y Position&#39;</span>)</span>
<span id="cb106-256"><a href="the-boids-flocking-model.html#cb106-256" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Final Flocking Pattern&#39;</span>)</span>
<span id="cb106-257"><a href="the-boids-flocking-model.html#cb106-257" tabindex="-1"></a>ax.legend()</span>
<span id="cb106-258"><a href="the-boids-flocking-model.html#cb106-258" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb106-259"><a href="the-boids-flocking-model.html#cb106-259" tabindex="-1"></a>ax.set_aspect(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb106-260"><a href="the-boids-flocking-model.html#cb106-260" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb106-261"><a href="the-boids-flocking-model.html#cb106-261" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="the-boids-flocking-model.html#cb107-1" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb107-2"><a href="the-boids-flocking-model.html#cb107-2" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb107-3"><a href="the-boids-flocking-model.html#cb107-3" tabindex="-1"></a><span class="im">import</span> matplotlib.animation <span class="im">as</span> animation</span>
<span id="cb107-4"><a href="the-boids-flocking-model.html#cb107-4" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb107-5"><a href="the-boids-flocking-model.html#cb107-5" tabindex="-1"></a></span>
<span id="cb107-6"><a href="the-boids-flocking-model.html#cb107-6" tabindex="-1"></a><span class="co"># The &#39;model&#39;, &#39;positions_history&#39;, &#39;velocities_history&#39;, &#39;n_steps&#39; variables</span></span>
<span id="cb107-7"><a href="the-boids-flocking-model.html#cb107-7" tabindex="-1"></a><span class="co"># are already available in the kernel state from the previous cell&#39;s execution.</span></span>
<span id="cb107-8"><a href="the-boids-flocking-model.html#cb107-8" tabindex="-1"></a></span>
<span id="cb107-9"><a href="the-boids-flocking-model.html#cb107-9" tabindex="-1"></a><span class="co"># Create animation</span></span>
<span id="cb107-10"><a href="the-boids-flocking-model.html#cb107-10" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">7</span>))</span>
<span id="cb107-11"><a href="the-boids-flocking-model.html#cb107-11" tabindex="-1"></a></span>
<span id="cb107-12"><a href="the-boids-flocking-model.html#cb107-12" tabindex="-1"></a><span class="kw">def</span> update(frame):</span>
<span id="cb107-13"><a href="the-boids-flocking-model.html#cb107-13" tabindex="-1"></a>    ax1.clear()</span>
<span id="cb107-14"><a href="the-boids-flocking-model.html#cb107-14" tabindex="-1"></a>    ax2.clear()</span>
<span id="cb107-15"><a href="the-boids-flocking-model.html#cb107-15" tabindex="-1"></a></span>
<span id="cb107-16"><a href="the-boids-flocking-model.html#cb107-16" tabindex="-1"></a>    positions <span class="op">=</span> positions_history[frame]</span>
<span id="cb107-17"><a href="the-boids-flocking-model.html#cb107-17" tabindex="-1"></a>    velocities <span class="op">=</span> velocities_history[frame]</span>
<span id="cb107-18"><a href="the-boids-flocking-model.html#cb107-18" tabindex="-1"></a></span>
<span id="cb107-19"><a href="the-boids-flocking-model.html#cb107-19" tabindex="-1"></a>    <span class="co"># Main flocking visualization</span></span>
<span id="cb107-20"><a href="the-boids-flocking-model.html#cb107-20" tabindex="-1"></a>    ax1.scatter(positions[:, <span class="dv">0</span>], positions[:, <span class="dv">1</span>], c<span class="op">=</span><span class="st">&#39;blue&#39;</span>, s<span class="op">=</span><span class="dv">30</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb107-21"><a href="the-boids-flocking-model.html#cb107-21" tabindex="-1"></a>    <span class="co"># Draw velocity vectors</span></span>
<span id="cb107-22"><a href="the-boids-flocking-model.html#cb107-22" tabindex="-1"></a>    ax1.quiver(positions[:, <span class="dv">0</span>], positions[:, <span class="dv">1</span>],</span>
<span id="cb107-23"><a href="the-boids-flocking-model.html#cb107-23" tabindex="-1"></a>               velocities[:, <span class="dv">0</span>], velocities[:, <span class="dv">1</span>],</span>
<span id="cb107-24"><a href="the-boids-flocking-model.html#cb107-24" tabindex="-1"></a>               color<span class="op">=</span><span class="st">&#39;red&#39;</span>, alpha<span class="op">=</span><span class="fl">0.4</span>, scale<span class="op">=</span><span class="dv">50</span>, width<span class="op">=</span><span class="fl">0.003</span>)</span>
<span id="cb107-25"><a href="the-boids-flocking-model.html#cb107-25" tabindex="-1"></a>    ax1.set_xlim(<span class="dv">0</span>, model.space.x_max)</span>
<span id="cb107-26"><a href="the-boids-flocking-model.html#cb107-26" tabindex="-1"></a>    ax1.set_ylim(<span class="dv">0</span>, model.space.y_max)</span>
<span id="cb107-27"><a href="the-boids-flocking-model.html#cb107-27" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;X Position&#39;</span>)</span>
<span id="cb107-28"><a href="the-boids-flocking-model.html#cb107-28" tabindex="-1"></a>    ax1.set_ylabel(<span class="st">&#39;Y Position&#39;</span>)</span>
<span id="cb107-29"><a href="the-boids-flocking-model.html#cb107-29" tabindex="-1"></a>    ax1.set_title(<span class="ss">f&#39;Boids Flocking Simulation (Step </span><span class="sc">{</span>frame<span class="sc">}</span><span class="ss">)&#39;</span>)</span>
<span id="cb107-30"><a href="the-boids-flocking-model.html#cb107-30" tabindex="-1"></a>    ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb107-31"><a href="the-boids-flocking-model.html#cb107-31" tabindex="-1"></a>    ax1.set_aspect(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb107-32"><a href="the-boids-flocking-model.html#cb107-32" tabindex="-1"></a></span>
<span id="cb107-33"><a href="the-boids-flocking-model.html#cb107-33" tabindex="-1"></a>    <span class="co"># Statistics plot</span></span>
<span id="cb107-34"><a href="the-boids-flocking-model.html#cb107-34" tabindex="-1"></a>    data <span class="op">=</span> model.datacollector.get_model_vars_dataframe()</span>
<span id="cb107-35"><a href="the-boids-flocking-model.html#cb107-35" tabindex="-1"></a>    steps <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(data))</span>
<span id="cb107-36"><a href="the-boids-flocking-model.html#cb107-36" tabindex="-1"></a></span>
<span id="cb107-37"><a href="the-boids-flocking-model.html#cb107-37" tabindex="-1"></a>    ax2_twin <span class="op">=</span> ax2.twinx()</span>
<span id="cb107-38"><a href="the-boids-flocking-model.html#cb107-38" tabindex="-1"></a></span>
<span id="cb107-39"><a href="the-boids-flocking-model.html#cb107-39" tabindex="-1"></a>    line1 <span class="op">=</span> ax2.plot(steps, data[<span class="st">&#39;Avg Speed&#39;</span>], <span class="st">&#39;b-&#39;</span>, label<span class="op">=</span><span class="st">&#39;Avg Speed&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb107-40"><a href="the-boids-flocking-model.html#cb107-40" tabindex="-1"></a>    line2 <span class="op">=</span> ax2_twin.plot(steps, data[<span class="st">&#39;Avg Neighbors&#39;</span>], <span class="st">&#39;g-&#39;</span>, label<span class="op">=</span><span class="st">&#39;Avg Neighbors&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb107-41"><a href="the-boids-flocking-model.html#cb107-41" tabindex="-1"></a></span>
<span id="cb107-42"><a href="the-boids-flocking-model.html#cb107-42" tabindex="-1"></a>    ax2.axvline(x<span class="op">=</span>frame, color<span class="op">=</span><span class="st">&#39;red&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb107-43"><a href="the-boids-flocking-model.html#cb107-43" tabindex="-1"></a></span>
<span id="cb107-44"><a href="the-boids-flocking-model.html#cb107-44" tabindex="-1"></a>    ax2.set_xlabel(<span class="st">&#39;Step&#39;</span>)</span>
<span id="cb107-45"><a href="the-boids-flocking-model.html#cb107-45" tabindex="-1"></a>    ax2.set_ylabel(<span class="st">&#39;Average Speed&#39;</span>, color<span class="op">=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb107-46"><a href="the-boids-flocking-model.html#cb107-46" tabindex="-1"></a>    ax2_twin.set_ylabel(<span class="st">&#39;Average Neighbors&#39;</span>, color<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb107-47"><a href="the-boids-flocking-model.html#cb107-47" tabindex="-1"></a>    ax2.tick_params(axis<span class="op">=</span><span class="st">&#39;y&#39;</span>, labelcolor<span class="op">=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb107-48"><a href="the-boids-flocking-model.html#cb107-48" tabindex="-1"></a>    ax2_twin.tick_params(axis<span class="op">=</span><span class="st">&#39;y&#39;</span>, labelcolor<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb107-49"><a href="the-boids-flocking-model.html#cb107-49" tabindex="-1"></a>    ax2.set_title(<span class="st">&#39;Swarm Metrics Over Time&#39;</span>)</span>
<span id="cb107-50"><a href="the-boids-flocking-model.html#cb107-50" tabindex="-1"></a>    ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb107-51"><a href="the-boids-flocking-model.html#cb107-51" tabindex="-1"></a></span>
<span id="cb107-52"><a href="the-boids-flocking-model.html#cb107-52" tabindex="-1"></a>    <span class="co"># Combine legends</span></span>
<span id="cb107-53"><a href="the-boids-flocking-model.html#cb107-53" tabindex="-1"></a>    lines <span class="op">=</span> line1 <span class="op">+</span> line2</span>
<span id="cb107-54"><a href="the-boids-flocking-model.html#cb107-54" tabindex="-1"></a>    labels <span class="op">=</span> [l.get_label() <span class="cf">for</span> l <span class="kw">in</span> lines]</span>
<span id="cb107-55"><a href="the-boids-flocking-model.html#cb107-55" tabindex="-1"></a>    ax2.legend(lines, labels, loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb107-56"><a href="the-boids-flocking-model.html#cb107-56" tabindex="-1"></a></span>
<span id="cb107-57"><a href="the-boids-flocking-model.html#cb107-57" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb107-58"><a href="the-boids-flocking-model.html#cb107-58" tabindex="-1"></a></span>
<span id="cb107-59"><a href="the-boids-flocking-model.html#cb107-59" tabindex="-1"></a><span class="co"># Create animation</span></span>
<span id="cb107-60"><a href="the-boids-flocking-model.html#cb107-60" tabindex="-1"></a><span class="co"># Note: frames are skipped (range(0, n_steps, 2)) to reduce animation size/length</span></span>
<span id="cb107-61"><a href="the-boids-flocking-model.html#cb107-61" tabindex="-1"></a>anim <span class="op">=</span> animation.FuncAnimation(fig, update, frames<span class="op">=</span><span class="bu">range</span>(<span class="dv">0</span>, n_steps, <span class="dv">2</span>),</span>
<span id="cb107-62"><a href="the-boids-flocking-model.html#cb107-62" tabindex="-1"></a>                              interval<span class="op">=</span><span class="dv">50</span>, repeat<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb107-63"><a href="the-boids-flocking-model.html#cb107-63" tabindex="-1"></a></span>
<span id="cb107-64"><a href="the-boids-flocking-model.html#cb107-64" tabindex="-1"></a><span class="co"># Display the animation in Colab output using HTML</span></span>
<span id="cb107-65"><a href="the-boids-flocking-model.html#cb107-65" tabindex="-1"></a>HTML(anim.to_jshtml())</span>
<span id="cb107-66"><a href="the-boids-flocking-model.html#cb107-66" tabindex="-1"></a></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-emergence-of-inequality-the-sugarscape-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-disease-spread-the-sir-epidemic-framework.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/Kamran-Afzali/Agent-Based-Modelling/edit/main/12-Boids.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/Kamran-Afzali/Agent-Based-Modelling/blob/main/12-Boids.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
