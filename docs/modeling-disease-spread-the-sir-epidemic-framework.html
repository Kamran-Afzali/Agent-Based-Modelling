<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Modeling Disease Spread: The SIR Epidemic Framework | Agent Based Modelling</title>
  <meta name="description" content="Chapter 14 Modeling Disease Spread: The SIR Epidemic Framework | Agent Based Modelling" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Modeling Disease Spread: The SIR Epidemic Framework | Agent Based Modelling" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Modeling Disease Spread: The SIR Epidemic Framework | Agent Based Modelling" />
  
  
  

<meta name="author" content="Kamran Afzali" />


<meta name="date" content="2025-12-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-boids-flocking-model.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Agent Based Modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Agent Based Modelling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#agent-based-modelling-and-complexity"><i class="fa fa-check"></i><b>1.1</b> Agent-based modelling and complexity</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#structure-of-an-agent-based-model"><i class="fa fa-check"></i><b>1.2</b> Structure of an agent-based model</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#agents"><i class="fa fa-check"></i><b>1.2.1</b> Agents</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#environment"><i class="fa fa-check"></i><b>1.2.2</b> Environment</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#when-to-do-abm"><i class="fa fa-check"></i><b>1.3</b> When to do ABM</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="random-walks-i.html"><a href="random-walks-i.html"><i class="fa fa-check"></i><b>2</b> Random Walks I</a>
<ul>
<li class="chapter" data-level="2.1" data-path="random-walks-i.html"><a href="random-walks-i.html#what-makes-random-walks-special"><i class="fa fa-check"></i><b>2.1</b> What Makes Random Walks Special?</a></li>
<li class="chapter" data-level="2.2" data-path="random-walks-i.html"><a href="random-walks-i.html#building-our-random-walk-simulation"><i class="fa fa-check"></i><b>2.2</b> Building Our Random Walk Simulation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="random-walks-i.html"><a href="random-walks-i.html#setting-up-the-environment"><i class="fa fa-check"></i><b>2.2.1</b> Setting Up the Environment</a></li>
<li class="chapter" data-level="2.2.2" data-path="random-walks-i.html"><a href="random-walks-i.html#creating-the-random-walker-agent"><i class="fa fa-check"></i><b>2.2.2</b> Creating the Random Walker Agent</a></li>
<li class="chapter" data-level="2.2.3" data-path="random-walks-i.html"><a href="random-walks-i.html#designing-the-model-architecture"><i class="fa fa-check"></i><b>2.2.3</b> Designing the Model Architecture</a></li>
<li class="chapter" data-level="2.2.4" data-path="random-walks-i.html"><a href="random-walks-i.html#implementing-the-simulation-loop"><i class="fa fa-check"></i><b>2.2.4</b> Implementing the Simulation Loop</a></li>
<li class="chapter" data-level="2.2.5" data-path="random-walks-i.html"><a href="random-walks-i.html#running-and-analyzing-the-simulation"><i class="fa fa-check"></i><b>2.2.5</b> Running and Analyzing the Simulation</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="random-walks-i.html"><a href="random-walks-i.html#the-complete-implementation"><i class="fa fa-check"></i><b>2.3</b> The Complete Implementation</a></li>
<li class="chapter" data-level="2.4" data-path="random-walks-i.html"><a href="random-walks-i.html#discussion-and-implications"><i class="fa fa-check"></i><b>2.4</b> Discussion and Implications</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="random-walks-i.html"><a href="random-walks-i.html#from-particles-to-populations"><i class="fa fa-check"></i><b>2.4.1</b> From Particles to Populations</a></li>
<li class="chapter" data-level="2.4.2" data-path="random-walks-i.html"><a href="random-walks-i.html#the-power-of-emergence"><i class="fa fa-check"></i><b>2.4.2</b> The Power of Emergence</a></li>
<li class="chapter" data-level="2.4.3" data-path="random-walks-i.html"><a href="random-walks-i.html#extending-the-framework"><i class="fa fa-check"></i><b>2.4.3</b> Extending the Framework</a></li>
<li class="chapter" data-level="2.4.4" data-path="random-walks-i.html"><a href="random-walks-i.html#computational-insights"><i class="fa fa-check"></i><b>2.4.4</b> Computational Insights</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="random-walks-i.html"><a href="random-walks-i.html#visualizing-the-journey"><i class="fa fa-check"></i><b>2.5</b> Visualizing the Journey</a></li>
<li class="chapter" data-level="2.6" data-path="random-walks-i.html"><a href="random-walks-i.html#conclusion-random-walks-as-research-tools"><i class="fa fa-check"></i><b>2.6</b> Conclusion: Random Walks as Research Tools</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="random-walks-i.html"><a href="random-walks-i.html#full-code"><i class="fa fa-check"></i><b>2.6.1</b> Full Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><i class="fa fa-check"></i><b>3</b> Scaling Up: Multi-Agent Random Walks and Emergent Collective Patterns</a>
<ul>
<li class="chapter" data-level="3.1" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#from-solo-to-symphony-the-multi-agent-paradigm"><i class="fa fa-check"></i><b>3.1</b> From Solo to Symphony: The Multi-Agent Paradigm</a></li>
<li class="chapter" data-level="3.2" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#architectural-improvements-professional-mesa-development"><i class="fa fa-check"></i><b>3.2</b> Architectural Improvements: Professional Mesa Development</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#enhanced-agent-design"><i class="fa fa-check"></i><b>3.2.1</b> Enhanced Agent Design</a></li>
<li class="chapter" data-level="3.2.2" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#professional-data-collection"><i class="fa fa-check"></i><b>3.2.2</b> Professional Data Collection</a></li>
<li class="chapter" data-level="3.2.3" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#scalable-model-architecture"><i class="fa fa-check"></i><b>3.2.3</b> Scalable Model Architecture</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#the-complete-enhanced-implementation"><i class="fa fa-check"></i><b>3.3</b> The Complete Enhanced Implementation</a></li>
<li class="chapter" data-level="3.4" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#emergent-patterns-in-multi-agent-systems"><i class="fa fa-check"></i><b>3.4</b> Emergent Patterns in Multi-Agent Systems</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#collective-coverage-patterns"><i class="fa fa-check"></i><b>3.4.1</b> Collective Coverage Patterns</a></li>
<li class="chapter" data-level="3.4.2" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#spatial-distribution-dynamics"><i class="fa fa-check"></i><b>3.4.2</b> Spatial Distribution Dynamics</a></li>
<li class="chapter" data-level="3.4.3" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#temporal-synchronization-and-divergence"><i class="fa fa-check"></i><b>3.4.3</b> Temporal Synchronization and Divergence</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#data-analysis-opportunities"><i class="fa fa-check"></i><b>3.5</b> Data Analysis Opportunities</a></li>
<li class="chapter" data-level="3.6" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#performance-considerations-and-scalability"><i class="fa fa-check"></i><b>3.6</b> Performance Considerations and Scalability</a></li>
<li class="chapter" data-level="3.7" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#research-applications-and-extensions"><i class="fa fa-check"></i><b>3.7</b> Research Applications and Extensions</a></li>
<li class="chapter" data-level="3.8" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#visualization-and-communication"><i class="fa fa-check"></i><b>3.8</b> Visualization and Communication</a></li>
<li class="chapter" data-level="3.9" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#conclusion-from-randomness-to-understanding"><i class="fa fa-check"></i><b>3.9</b> Conclusion: From Randomness to Understanding</a></li>
<li class="chapter" data-level="3.10" data-path="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html"><a href="scaling-up-multi-agent-random-walks-and-emergent-collective-patterns.html#full-code-1"><i class="fa fa-check"></i><b>3.10</b> Full code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html"><i class="fa fa-check"></i><b>4</b> Beyond Random: When Agents Learn to Navigate Their World</a>
<ul>
<li class="chapter" data-level="4.1" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#from-random-to-rational-the-learning-paradigm"><i class="fa fa-check"></i><b>4.1</b> From Random to Rational: The Learning Paradigm</a></li>
<li class="chapter" data-level="4.2" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#environmental-complexity-resources-and-hazards"><i class="fa fa-check"></i><b>4.2</b> Environmental Complexity: Resources and Hazards</a></li>
<li class="chapter" data-level="4.3" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#the-architecture-of-adaptive-behavior"><i class="fa fa-check"></i><b>4.3</b> The Architecture of Adaptive Behavior</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#the-exploration-exploitation-dilemma"><i class="fa fa-check"></i><b>4.3.1</b> The Exploration-Exploitation Dilemma</a></li>
<li class="chapter" data-level="4.3.2" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#adaptive-decision-making"><i class="fa fa-check"></i><b>4.3.2</b> Adaptive Decision Making</a></li>
<li class="chapter" data-level="4.3.3" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#learning-through-experience"><i class="fa fa-check"></i><b>4.3.3</b> Learning Through Experience</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#environmental-architecture-and-complexity"><i class="fa fa-check"></i><b>4.4</b> Environmental Architecture and Complexity</a></li>
<li class="chapter" data-level="4.5" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#comprehensive-data-collection-and-analysis"><i class="fa fa-check"></i><b>4.5</b> Comprehensive Data Collection and Analysis</a></li>
<li class="chapter" data-level="4.6" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#the-complete-learning-walker-implementation"><i class="fa fa-check"></i><b>4.6</b> The Complete Learning Walker Implementation</a></li>
<li class="chapter" data-level="4.7" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#emergent-intelligence-what-the-data-reveals"><i class="fa fa-check"></i><b>4.7</b> Emergent Intelligence: What the Data Reveals</a></li>
<li class="chapter" data-level="4.8" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#research-implications-and-real-world-connections"><i class="fa fa-check"></i><b>4.8</b> Research Implications and Real-World Connections</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#extensions-and-future-directions"><i class="fa fa-check"></i><b>4.8.1</b> Extensions and Future Directions</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#computational-insights-and-performance"><i class="fa fa-check"></i><b>4.9</b> Computational Insights and Performance</a></li>
<li class="chapter" data-level="4.10" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#conclusion-intelligence-as-emergent-property"><i class="fa fa-check"></i><b>4.10</b> Conclusion: Intelligence as Emergent Property</a></li>
<li class="chapter" data-level="4.11" data-path="beyond-random-when-agents-learn-to-navigate-their-world.html"><a href="beyond-random-when-agents-learn-to-navigate-their-world.html#full-code-2"><i class="fa fa-check"></i><b>4.11</b> Full code</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html"><i class="fa fa-check"></i><b>5</b> From Random Walks to Social Segregation: The Schelling Model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#the-mechanics-of-social-preference"><i class="fa fa-check"></i><b>5.1</b> The Mechanics of Social Preference</a></li>
<li class="chapter" data-level="5.2" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#implementation-architecture-and-design-decisions"><i class="fa fa-check"></i><b>5.2</b> Implementation Architecture and Design Decisions</a></li>
<li class="chapter" data-level="5.3" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#the-emergence-of-segregated-patterns"><i class="fa fa-check"></i><b>5.3</b> The Emergence of Segregated Patterns</a></li>
<li class="chapter" data-level="5.4" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#quantifying-segregation-dynamics"><i class="fa fa-check"></i><b>5.4</b> Quantifying Segregation Dynamics</a></li>
<li class="chapter" data-level="5.5" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#extensions-and-variations"><i class="fa fa-check"></i><b>5.5</b> Extensions and Variations</a></li>
<li class="chapter" data-level="5.6" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#policy-implications-and-interventions"><i class="fa fa-check"></i><b>5.6</b> Policy Implications and Interventions</a></li>
<li class="chapter" data-level="5.7" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#computational-considerations-and-future-directions"><i class="fa fa-check"></i><b>5.7</b> Computational Considerations and Future Directions</a></li>
<li class="chapter" data-level="5.8" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#connecting-theory-and-reality"><i class="fa fa-check"></i><b>5.8</b> Connecting Theory and Reality</a></li>
<li class="chapter" data-level="5.9" data-path="from-random-walks-to-social-segregation-the-schelling-model.html"><a href="from-random-walks-to-social-segregation-the-schelling-model.html#emergence-and-individual-responsibility"><i class="fa fa-check"></i><b>5.9</b> Emergence and Individual Responsibility</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html"><i class="fa fa-check"></i><b>6</b> An Economic Extension of the Schelling Segregation Model</a>
<ul>
<li class="chapter" data-level="6.1" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#introduction-the-missing-economic-dimension"><i class="fa fa-check"></i><b>6.1</b> Introduction: The Missing Economic Dimension</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#redefining-agents-in-economic-terms"><i class="fa fa-check"></i><b>6.1.1</b> Redefining Agents in Economic Terms</a></li>
<li class="chapter" data-level="6.1.2" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#emergent-dynamics-when-constraints-reshape-preferences"><i class="fa fa-check"></i><b>6.1.2</b> Emergent Dynamics: When Constraints Reshape Preferences</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#research-applications-from-theory-to-policy"><i class="fa fa-check"></i><b>6.2</b> Research Applications: From Theory to Policy</a></li>
<li class="chapter" data-level="6.3" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#methodological-innovations-and-extensions"><i class="fa fa-check"></i><b>6.3</b> Methodological Innovations and Extensions</a></li>
<li class="chapter" data-level="6.4" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#key-findings-the-economic-reality-of-social-sorting"><i class="fa fa-check"></i><b>6.4</b> Key Findings: The Economic Reality of Social Sorting</a></li>
<li class="chapter" data-level="6.5" data-path="an-economic-extension-of-the-schelling-segregation-model.html"><a href="an-economic-extension-of-the-schelling-segregation-model.html#conclusion"><i class="fa fa-check"></i><b>6.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><i class="fa fa-check"></i><b>7</b> Space Matters: Grids, Neighborhoods, and Spatial Dynamics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#the-architecture-of-space-in-agent-based-models"><i class="fa fa-check"></i><b>7.1</b> The Architecture of Space in Agent-Based Models</a></li>
<li class="chapter" data-level="7.2" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#conways-game-of-life-emergence-from-simplicity"><i class="fa fa-check"></i><b>7.2</b> Conway’s Game of Life: Emergence from Simplicity</a></li>
<li class="chapter" data-level="7.3" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#patterns-structures-and-emergent-behaviors"><i class="fa fa-check"></i><b>7.3</b> Patterns, Structures, and Emergent Behaviors</a></li>
<li class="chapter" data-level="7.4" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#boundary-conditions-and-spatial-topology"><i class="fa fa-check"></i><b>7.4</b> Boundary Conditions and Spatial Topology</a></li>
<li class="chapter" data-level="7.5" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#extending-the-framework-custom-rules-and-variations"><i class="fa fa-check"></i><b>7.5</b> Extending the Framework: Custom Rules and Variations</a></li>
<li class="chapter" data-level="7.6" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#computational-complexity-and-performance-considerations"><i class="fa fa-check"></i><b>7.6</b> Computational Complexity and Performance Considerations</a></li>
<li class="chapter" data-level="7.7" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#connections-to-complex-systems-theory"><i class="fa fa-check"></i><b>7.7</b> Connections to Complex Systems Theory</a></li>
<li class="chapter" data-level="7.8" data-path="space-matters-grids-neighborhoods-and-spatial-dynamics.html"><a href="space-matters-grids-neighborhoods-and-spatial-dynamics.html#spatial-dynamics-and-future-directions"><i class="fa fa-check"></i><b>7.8</b> Spatial Dynamics and Future Directions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><i class="fa fa-check"></i><b>8</b> Beyond Binary: Multi-State Cellular Automata and Emergent Ecosystems</a>
<ul>
<li class="chapter" data-level="8.1" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#mathematical-foundations-of-multi-state-systems"><i class="fa fa-check"></i><b>8.1</b> Mathematical Foundations of Multi-State Systems</a></li>
<li class="chapter" data-level="8.2" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#implementation-architecture"><i class="fa fa-check"></i><b>8.2</b> Implementation Architecture</a></li>
<li class="chapter" data-level="8.3" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#cyclic-dynamics-and-spatial-patterns"><i class="fa fa-check"></i><b>8.3</b> Cyclic Dynamics and Spatial Patterns</a></li>
<li class="chapter" data-level="8.4" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#parameter-sensitivity-and-system-stability"><i class="fa fa-check"></i><b>8.4</b> Parameter Sensitivity and System Stability</a></li>
<li class="chapter" data-level="8.5" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#complete-implementation-and-execution"><i class="fa fa-check"></i><b>8.5</b> Complete Implementation and Execution</a></li>
<li class="chapter" data-level="8.6" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#extensions-and-future-directions-1"><i class="fa fa-check"></i><b>8.6</b> Extensions and Future Directions</a></li>
<li class="chapter" data-level="8.7" data-path="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html"><a href="beyond-binary-multi-state-cellular-automata-and-emergent-ecosystems.html#connecting-theory-to-reality"><i class="fa fa-check"></i><b>8.7</b> Connecting Theory to Reality</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html"><i class="fa fa-check"></i><b>9</b> Forest Fire Dynamics Modeling I</a>
<ul>
<li class="chapter" data-level="9.1" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#introduction-when-simple-rules-create-complex-patterns"><i class="fa fa-check"></i><b>9.1</b> Introduction: When Simple Rules Create Complex Patterns</a></li>
<li class="chapter" data-level="9.2" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#the-forest-fire-model-four-states-infinite-possibilities"><i class="fa fa-check"></i><b>9.2</b> The Forest Fire Model: Four States, Infinite Possibilities</a></li>
<li class="chapter" data-level="9.3" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#two-phase-evolution-separating-growth-from-fire"><i class="fa fa-check"></i><b>9.3</b> Two-Phase Evolution: Separating Growth from Fire</a></li>
<li class="chapter" data-level="9.4" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#building-the-complete-model"><i class="fa fa-check"></i><b>9.4</b> Building the Complete Model</a></li>
<li class="chapter" data-level="9.5" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#emergent-dynamics-self-organized-criticality"><i class="fa fa-check"></i><b>9.5</b> Emergent Dynamics: Self-Organized Criticality</a></li>
<li class="chapter" data-level="9.6" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#the-critical-fire-spread-probability"><i class="fa fa-check"></i><b>9.6</b> The Critical Fire Spread Probability</a></li>
<li class="chapter" data-level="9.7" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#spatial-patterns-forest-mosaics"><i class="fa fa-check"></i><b>9.7</b> Spatial Patterns: Forest Mosaics</a></li>
<li class="chapter" data-level="9.8" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#temporal-oscillations-boom-and-bust-cycles"><i class="fa fa-check"></i><b>9.8</b> Temporal Oscillations: Boom and Bust Cycles</a></li>
<li class="chapter" data-level="9.9" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#equilibrium-and-stability"><i class="fa fa-check"></i><b>9.9</b> Equilibrium and Stability</a></li>
<li class="chapter" data-level="9.10" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#applications-from-theory-to-management"><i class="fa fa-check"></i><b>9.10</b> Applications: From Theory to Management</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#fuel-reduction-strategies"><i class="fa fa-check"></i><b>9.10.1</b> Fuel Reduction Strategies</a></li>
<li class="chapter" data-level="9.10.2" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#climate-change-scenarios"><i class="fa fa-check"></i><b>9.10.2</b> Climate Change Scenarios</a></li>
<li class="chapter" data-level="9.10.3" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#firebreak-design"><i class="fa fa-check"></i><b>9.10.3</b> Firebreak Design</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#applications-and-policy-implications"><i class="fa fa-check"></i><b>9.11</b> Applications and Policy Implications</a>
<ul>
<li class="chapter" data-level="9.11.1" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#forest-management-strategies"><i class="fa fa-check"></i><b>9.11.1</b> Forest Management Strategies</a></li>
<li class="chapter" data-level="9.11.2" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#climate-change-adaptation"><i class="fa fa-check"></i><b>9.11.2</b> Climate Change Adaptation</a></li>
<li class="chapter" data-level="9.11.3" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#conservation-planning"><i class="fa fa-check"></i><b>9.11.3</b> Conservation Planning</a></li>
</ul></li>
<li class="chapter" data-level="9.12" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#model-extensions-and-future-directions"><i class="fa fa-check"></i><b>9.12</b> Model Extensions and Future Directions</a>
<ul>
<li class="chapter" data-level="9.12.1" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#spatial-heterogeneity"><i class="fa fa-check"></i><b>9.12.1</b> Spatial Heterogeneity</a></li>
<li class="chapter" data-level="9.12.2" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#multi-scale-dynamics"><i class="fa fa-check"></i><b>9.12.2</b> Multi-scale Dynamics</a></li>
<li class="chapter" data-level="9.12.3" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#stochastic-fire-spread"><i class="fa fa-check"></i><b>9.12.3</b> Stochastic Fire Spread</a></li>
</ul></li>
<li class="chapter" data-level="9.13" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#limitations-and-model-assumptions"><i class="fa fa-check"></i><b>9.13</b> Limitations and Model Assumptions</a>
<ul>
<li class="chapter" data-level="9.13.1" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#temporal-resolution"><i class="fa fa-check"></i><b>9.13.1</b> Temporal Resolution</a></li>
<li class="chapter" data-level="9.13.2" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#spatial-resolution"><i class="fa fa-check"></i><b>9.13.2</b> Spatial Resolution</a></li>
<li class="chapter" data-level="9.13.3" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#deterministic-vs.-stochastic-elements"><i class="fa fa-check"></i><b>9.13.3</b> Deterministic vs. Stochastic Elements</a></li>
<li class="chapter" data-level="9.13.4" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#human-dimensions"><i class="fa fa-check"></i><b>9.13.4</b> Human Dimensions</a></li>
</ul></li>
<li class="chapter" data-level="9.14" data-path="forest-fire-dynamics-modeling-i.html"><a href="forest-fire-dynamics-modeling-i.html#conclusion-emergent-complexity-from-simple-rules"><i class="fa fa-check"></i><b>9.14</b> Conclusion: Emergent Complexity from Simple Rules</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html"><i class="fa fa-check"></i><b>10</b> Forest Fire Dynamics Modeling II</a>
<ul>
<li class="chapter" data-level="10.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#introduction-the-complex-dynamics-of-fire-suppression"><i class="fa fa-check"></i><b>10.1</b> Introduction: The Complex Dynamics of Fire Suppression</a></li>
<li class="chapter" data-level="10.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#mathematical-framework-multi-agent-fire-suppression-dynamics"><i class="fa fa-check"></i><b>10.2</b> Mathematical Framework: Multi-Agent Fire-Suppression Dynamics</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#enhanced-state-space-definition"><i class="fa fa-check"></i><b>10.2.1</b> Enhanced State Space Definition</a></li>
<li class="chapter" data-level="10.2.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#firefighter-agent-dynamics"><i class="fa fa-check"></i><b>10.2.2</b> Firefighter Agent Dynamics</a></li>
<li class="chapter" data-level="10.2.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#modified-fire-propagation-with-suppression"><i class="fa fa-check"></i><b>10.2.3</b> Modified Fire Propagation with Suppression</a></li>
<li class="chapter" data-level="10.2.4" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#firefighter-behavioral-rules"><i class="fa fa-check"></i><b>10.2.4</b> Firefighter Behavioral Rules</a></li>
<li class="chapter" data-level="10.2.5" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#infrastructure-effects-on-fire-dynamics"><i class="fa fa-check"></i><b>10.2.5</b> Infrastructure Effects on Fire Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#policy-architecture-comparative-strategy-frameworks"><i class="fa fa-check"></i><b>10.3</b> Policy Architecture: Comparative Strategy Frameworks</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#reactive-suppression-policy"><i class="fa fa-check"></i><b>10.3.1</b> Reactive Suppression Policy</a></li>
<li class="chapter" data-level="10.3.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#preventive-suppression-policy"><i class="fa fa-check"></i><b>10.3.2</b> Preventive Suppression Policy</a></li>
<li class="chapter" data-level="10.3.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#aggressive-suppression-policy"><i class="fa fa-check"></i><b>10.3.3</b> Aggressive Suppression Policy</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#implementation-architecture-multi-phase-staged-activation"><i class="fa fa-check"></i><b>10.4</b> Implementation Architecture: Multi-Phase Staged Activation</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#staged-temporal-dynamics"><i class="fa fa-check"></i><b>10.4.1</b> Staged Temporal Dynamics</a></li>
<li class="chapter" data-level="10.4.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#multi-agent-coordination-mechanisms"><i class="fa fa-check"></i><b>10.4.2</b> Multi-Agent Coordination Mechanisms</a></li>
<li class="chapter" data-level="10.4.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#state-machine-implementation"><i class="fa fa-check"></i><b>10.4.3</b> State Machine Implementation</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#emergent-dynamics-resource-allocation-and-spatial-coverage"><i class="fa fa-check"></i><b>10.5</b> Emergent Dynamics: Resource Allocation and Spatial Coverage</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#spatial-response-patterns"><i class="fa fa-check"></i><b>10.5.1</b> Spatial Response Patterns</a></li>
<li class="chapter" data-level="10.5.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#temporal-resource-utilization"><i class="fa fa-check"></i><b>10.5.2</b> Temporal Resource Utilization</a></li>
<li class="chapter" data-level="10.5.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#fire-size-distribution-effects"><i class="fa fa-check"></i><b>10.5.3</b> Fire Size Distribution Effects</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#performance-metrics-multi-objective-policy-evaluation"><i class="fa fa-check"></i><b>10.6</b> Performance Metrics: Multi-Objective Policy Evaluation</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#suppression-effectiveness-measures"><i class="fa fa-check"></i><b>10.6.1</b> Suppression Effectiveness Measures</a></li>
<li class="chapter" data-level="10.6.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#resource-efficiency-indicators"><i class="fa fa-check"></i><b>10.6.2</b> Resource Efficiency Indicators</a></li>
<li class="chapter" data-level="10.6.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#economic-cost-considerations"><i class="fa fa-check"></i><b>10.6.3</b> Economic Cost Considerations</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#simulation-results-comparative-policy-analysis"><i class="fa fa-check"></i><b>10.7</b> Simulation Results: Comparative Policy Analysis</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#burned-area-performance"><i class="fa fa-check"></i><b>10.7.1</b> Burned Area Performance</a></li>
<li class="chapter" data-level="10.7.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#temporal-dynamics-comparison"><i class="fa fa-check"></i><b>10.7.2</b> Temporal Dynamics Comparison</a></li>
<li class="chapter" data-level="10.7.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#resource-utilization-trade-offs"><i class="fa fa-check"></i><b>10.7.3</b> Resource Utilization Trade-offs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#policy-implications-strategic-fire-management"><i class="fa fa-check"></i><b>10.8</b> Policy Implications: Strategic Fire Management</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#cost-benefit-optimization"><i class="fa fa-check"></i><b>10.8.1</b> Cost-Benefit Optimization</a></li>
<li class="chapter" data-level="10.8.2" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#infrastructure-investment-strategies"><i class="fa fa-check"></i><b>10.8.2</b> Infrastructure Investment Strategies</a></li>
<li class="chapter" data-level="10.8.3" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#adaptive-management-frameworks"><i class="fa fa-check"></i><b>10.8.3</b> Adaptive Management Frameworks</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#model-extensions-and-future-directions-1"><i class="fa fa-check"></i><b>10.9</b> Model Extensions and Future Directions</a></li>
<li class="chapter" data-level="10.10" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#limitations-and-critical-assessment"><i class="fa fa-check"></i><b>10.10</b> Limitations and Critical Assessment</a></li>
<li class="chapter" data-level="10.11" data-path="forest-fire-dynamics-modeling-ii.html"><a href="forest-fire-dynamics-modeling-ii.html#conclusion-1"><i class="fa fa-check"></i><b>10.11</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html"><i class="fa fa-check"></i><b>11</b> Predator-Prey Dynamics: The Wolf-Sheep Model</a>
<ul>
<li class="chapter" data-level="11.1" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#the-mathematical-foundation"><i class="fa fa-check"></i><b>11.1</b> The Mathematical Foundation</a></li>
<li class="chapter" data-level="11.2" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#agent-architecture-and-behavioral-rules"><i class="fa fa-check"></i><b>11.2</b> Agent Architecture and Behavioral Rules</a></li>
<li class="chapter" data-level="11.3" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#model-initialization-and-parameter-space"><i class="fa fa-check"></i><b>11.3</b> Model Initialization and Parameter Space</a></li>
<li class="chapter" data-level="11.4" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#data-collection-and-population-tracking"><i class="fa fa-check"></i><b>11.4</b> Data Collection and Population Tracking</a></li>
<li class="chapter" data-level="11.5" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#emergent-population-dynamics"><i class="fa fa-check"></i><b>11.5</b> Emergent Population Dynamics</a></li>
<li class="chapter" data-level="11.6" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#spatial-patterns-and-local-dynamics"><i class="fa fa-check"></i><b>11.6</b> Spatial Patterns and Local Dynamics</a></li>
<li class="chapter" data-level="11.7" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#parameter-sensitivity-and-system-stability-1"><i class="fa fa-check"></i><b>11.7</b> Parameter Sensitivity and System Stability</a></li>
<li class="chapter" data-level="11.8" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#extensions-and-ecological-complexity"><i class="fa fa-check"></i><b>11.8</b> Extensions and Ecological Complexity</a></li>
<li class="chapter" data-level="11.9" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#connections-to-conservation-and-management"><i class="fa fa-check"></i><b>11.9</b> Connections to Conservation and Management</a></li>
<li class="chapter" data-level="11.10" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#computational-and-theoretical-reflections"><i class="fa fa-check"></i><b>11.10</b> Computational and Theoretical Reflections</a></li>
<li class="chapter" data-level="11.11" data-path="predator-prey-dynamics-the-wolf-sheep-model.html"><a href="predator-prey-dynamics-the-wolf-sheep-model.html#from-individual-decisions-to-collective-patterns"><i class="fa fa-check"></i><b>11.11</b> From Individual Decisions to Collective Patterns</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html"><i class="fa fa-check"></i><b>12</b> The Emergence of Inequality: The sugarscape Model</a>
<ul>
<li class="chapter" data-level="12.1" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#the-mathematical-framework-of-random-exchange"><i class="fa fa-check"></i><b>12.1</b> The Mathematical Framework of Random Exchange</a></li>
<li class="chapter" data-level="12.2" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#measuring-inequality-through-the-gini-coefficient"><i class="fa fa-check"></i><b>12.2</b> Measuring Inequality Through the Gini Coefficient</a></li>
<li class="chapter" data-level="12.3" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#model-architecture-and-data-collection"><i class="fa fa-check"></i><b>12.3</b> Model Architecture and Data Collection</a></li>
<li class="chapter" data-level="12.4" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#the-dynamics-of-inequality-emergence"><i class="fa fa-check"></i><b>12.4</b> The Dynamics of Inequality Emergence</a></li>
<li class="chapter" data-level="12.5" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#statistical-properties-and-theoretical-insights"><i class="fa fa-check"></i><b>12.5</b> Statistical Properties and Theoretical Insights</a></li>
<li class="chapter" data-level="12.6" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#visualizing-inequality-through-multiple-lenses"><i class="fa fa-check"></i><b>12.6</b> Visualizing Inequality Through Multiple Lenses</a></li>
<li class="chapter" data-level="12.7" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#policy-implications-and-model-extensions"><i class="fa fa-check"></i><b>12.7</b> Policy Implications and Model Extensions</a></li>
<li class="chapter" data-level="12.8" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#connections-to-econophysics-and-statistical-mechanics"><i class="fa fa-check"></i><b>12.8</b> Connections to Econophysics and Statistical Mechanics</a></li>
<li class="chapter" data-level="12.9" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#computational-considerations-and-simulation-design"><i class="fa fa-check"></i><b>12.9</b> Computational Considerations and Simulation Design</a></li>
<li class="chapter" data-level="12.10" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#interpreting-results-and-avoiding-common-pitfalls"><i class="fa fa-check"></i><b>12.10</b> Interpreting Results and Avoiding Common Pitfalls</a></li>
<li class="chapter" data-level="12.11" data-path="the-emergence-of-inequality-the-sugarscape-model.html"><a href="the-emergence-of-inequality-the-sugarscape-model.html#from-simple-models-to-complex-realities"><i class="fa fa-check"></i><b>12.11</b> From Simple Models to Complex Realities</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html"><i class="fa fa-check"></i><b>13</b> The Boids Flocking Model</a>
<ul>
<li class="chapter" data-level="13.1" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#the-mathematics-of-flocking"><i class="fa fa-check"></i><b>13.1</b> The Mathematics of Flocking</a></li>
<li class="chapter" data-level="13.2" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#implementation-in-continuous-space"><i class="fa fa-check"></i><b>13.2</b> Implementation in Continuous Space</a></li>
<li class="chapter" data-level="13.3" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#model-architecture-and-data-collection-1"><i class="fa fa-check"></i><b>13.3</b> Model Architecture and Data Collection</a></li>
<li class="chapter" data-level="13.4" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#emergent-phenomena-and-pattern-formation"><i class="fa fa-check"></i><b>13.4</b> Emergent Phenomena and Pattern Formation</a></li>
<li class="chapter" data-level="13.5" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#variations-and-extensions"><i class="fa fa-check"></i><b>13.5</b> Variations and Extensions</a></li>
<li class="chapter" data-level="13.6" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#computational-considerations"><i class="fa fa-check"></i><b>13.6</b> Computational Considerations</a></li>
<li class="chapter" data-level="13.7" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#biological-parallels-and-theoretical-insights"><i class="fa fa-check"></i><b>13.7</b> Biological Parallels and Theoretical Insights</a></li>
<li class="chapter" data-level="13.8" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#from-local-rules-to-global-order"><i class="fa fa-check"></i><b>13.8</b> From Local Rules to Global Order</a></li>
<li class="chapter" data-level="13.9" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#practical-applications-and-future-directions"><i class="fa fa-check"></i><b>13.9</b> Practical Applications and Future Directions</a></li>
<li class="chapter" data-level="13.10" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#conclusion-the-beauty-of-emergent-coordination"><i class="fa fa-check"></i><b>13.10</b> Conclusion: The Beauty of Emergent Coordination</a></li>
<li class="chapter" data-level="13.11" data-path="the-boids-flocking-model.html"><a href="the-boids-flocking-model.html#complete-implementation"><i class="fa fa-check"></i><b>13.11</b> Complete Implementation</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html"><i class="fa fa-check"></i><b>14</b> Modeling Disease Spread: The SIR Epidemic Framework</a>
<ul>
<li class="chapter" data-level="14.1" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#the-mathematics-of-contagion"><i class="fa fa-check"></i><b>14.1</b> The Mathematics of Contagion</a></li>
<li class="chapter" data-level="14.2" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#building-the-epidemic-agents"><i class="fa fa-check"></i><b>14.2</b> Building the Epidemic Agents</a></li>
<li class="chapter" data-level="14.3" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#orchestrating-the-epidemic"><i class="fa fa-check"></i><b>14.3</b> Orchestrating the Epidemic</a></li>
<li class="chapter" data-level="14.4" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#the-temporal-evolution-of-epidemics"><i class="fa fa-check"></i><b>14.4</b> The Temporal Evolution of Epidemics</a></li>
<li class="chapter" data-level="14.5" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#analyzing-epidemic-dynamics"><i class="fa fa-check"></i><b>14.5</b> Analyzing Epidemic Dynamics</a></li>
<li class="chapter" data-level="14.6" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#the-role-of-stochasticity"><i class="fa fa-check"></i><b>14.6</b> The Role of Stochasticity</a></li>
<li class="chapter" data-level="14.7" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#extensions-and-variations-1"><i class="fa fa-check"></i><b>14.7</b> Extensions and Variations</a></li>
<li class="chapter" data-level="14.8" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#public-health-implications"><i class="fa fa-check"></i><b>14.8</b> Public Health Implications</a></li>
<li class="chapter" data-level="14.9" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#computational-considerations-1"><i class="fa fa-check"></i><b>14.9</b> Computational Considerations</a></li>
<li class="chapter" data-level="14.10" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#limitations-and-future-directions"><i class="fa fa-check"></i><b>14.10</b> Limitations and Future Directions</a></li>
<li class="chapter" data-level="14.11" data-path="modeling-disease-spread-the-sir-epidemic-framework.html"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#from-individuals-to-populations"><i class="fa fa-check"></i><b>14.11</b> From Individuals to Populations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Agent Based Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modeling-disease-spread-the-sir-epidemic-framework" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> Modeling Disease Spread: The SIR Epidemic Framework<a href="modeling-disease-spread-the-sir-epidemic-framework.html#modeling-disease-spread-the-sir-epidemic-framework" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>From the aimless wandering of our random walker to the preference-driven relocations in Schelling’s segregation model, we’ve explored how agent-based systems generate emergent patterns through individual behavior. Now we turn to a domain where these principles carry profound real-world implications: epidemic modeling. The spread of infectious diseases through populations represents one of the most pressing applications of agent-based modeling, combining spatial dynamics, state transitions, and temporal evolution into a framework that has guided public health policy for over a century.</p>
<p>The SIR model—representing Susceptible, Infected, and Recovered compartments—provides the foundational paradigm for understanding disease transmission. Originally formulated as a system of differential equations by Kermack and McKendrick in 1927, the model captures the essential dynamics of how infections propagate through populations. Our agent-based implementation brings these classical equations to life, allowing us to observe individual infection events while tracking population-level epidemic curves.</p>
<div id="the-mathematics-of-contagion" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> The Mathematics of Contagion<a href="modeling-disease-spread-the-sir-epidemic-framework.html#the-mathematics-of-contagion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The classical SIR model operates through a system of ordinary differential equations that describe how populations flow between three states. Let S(t), I(t), and R(t) represent the number of susceptible, infected, and recovered individuals at time t, with total population N = S(t) + I(t) + R(t). The dynamics follow:</p>
<p>dS/dt = -β S I / N</p>
<p>dI/dt = β S I / N - γ I</p>
<p>dR/dt = γ I</p>
<p>Here β represents the transmission rate—the probability per unit time that a susceptible individual becomes infected through contact with an infectious individual. The parameter γ denotes the recovery rate, with 1/γ giving the average duration of infection. The ratio R₀ = β/γ, known as the basic reproduction number, determines whether an epidemic will grow (R₀ &gt; 1) or fade (R₀ &lt; 1).</p>
<p>These differential equations assume homogeneous mixing—every individual has equal probability of contacting every other individual. Our agent-based approach relaxes this assumption, allowing us to incorporate spatial structure, heterogeneous contact patterns, and stochastic effects that deterministic models cannot capture. The agent-based formulation preserves the essential disease dynamics while adding layers of realism through explicit spatial representation.</p>
</div>
<div id="building-the-epidemic-agents" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Building the Epidemic Agents<a href="modeling-disease-spread-the-sir-epidemic-framework.html#building-the-epidemic-agents" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our implementation begins with agents who carry disease states and transition between them according to epidemiological rules. Each agent exists in one of three states at any given time, with transitions governed by both deterministic timing and stochastic transmission:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb108-1" tabindex="-1"></a><span class="kw">class</span> PersonAgent(Agent):</span>
<span id="cb108-2"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb108-2" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model, state<span class="op">=</span><span class="st">&#39;S&#39;</span>):</span>
<span id="cb108-3"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb108-3" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(model)</span>
<span id="cb108-4"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb108-4" tabindex="-1"></a>        <span class="va">self</span>.state <span class="op">=</span> state  <span class="co"># &#39;S&#39;, &#39;I&#39;, or &#39;R&#39;</span></span>
<span id="cb108-5"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb108-5" tabindex="-1"></a>        <span class="va">self</span>.infection_time <span class="op">=</span> <span class="dv">0</span></span></code></pre></div>
<p>The state attribute encodes the fundamental epidemiological information—whether an individual can contract the disease, currently carries it, or has recovered and gained immunity. The infection_time counter tracks how long an agent has been infected, enabling us to implement recovery after a specified duration. This temporal tracking distinguishes our implementation from simpler models where recovery occurs probabilistically at each time step.</p>
<p>The agent’s behavioral logic implements the core transmission dynamics. Infected agents have the opportunity to transmit disease to susceptible neighbors at each time step, with transmission probability determined by the model’s infection rate parameter:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-1" tabindex="-1"></a><span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb109-2"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-2" tabindex="-1"></a>    <span class="cf">if</span> <span class="va">self</span>.state <span class="op">==</span> <span class="st">&#39;I&#39;</span>:</span>
<span id="cb109-3"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-3" tabindex="-1"></a>        <span class="va">self</span>.infect()</span>
<span id="cb109-4"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-4" tabindex="-1"></a>        <span class="va">self</span>.infection_time <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb109-5"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-5" tabindex="-1"></a>        <span class="co"># Recover after infection period</span></span>
<span id="cb109-6"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-6" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.infection_time <span class="op">&gt;=</span> <span class="va">self</span>.model.recovery_time:</span>
<span id="cb109-7"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-7" tabindex="-1"></a>            <span class="va">self</span>.state <span class="op">=</span> <span class="st">&#39;R&#39;</span></span>
<span id="cb109-8"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-8" tabindex="-1"></a>            <span class="va">self</span>.infection_time <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb109-9"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-9" tabindex="-1"></a></span>
<span id="cb109-10"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-10" tabindex="-1"></a><span class="kw">def</span> infect(<span class="va">self</span>):</span>
<span id="cb109-11"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-11" tabindex="-1"></a>    neighbors <span class="op">=</span> <span class="va">self</span>.model.grid.get_neighbors(</span>
<span id="cb109-12"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-12" tabindex="-1"></a>        <span class="va">self</span>.pos, moore<span class="op">=</span><span class="va">True</span>, include_center<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb109-13"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-13" tabindex="-1"></a>    susceptible_neighbors <span class="op">=</span> [agent <span class="cf">for</span> agent <span class="kw">in</span> neighbors </span>
<span id="cb109-14"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-14" tabindex="-1"></a>                            <span class="cf">if</span> agent.state <span class="op">==</span> <span class="st">&#39;S&#39;</span>]</span>
<span id="cb109-15"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-15" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> susceptible_neighbors:</span>
<span id="cb109-16"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-16" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.random.random() <span class="op">&lt;</span> <span class="va">self</span>.model.infection_rate:</span>
<span id="cb109-17"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb109-17" tabindex="-1"></a>            neighbor.state <span class="op">=</span> <span class="st">&#39;I&#39;</span></span></code></pre></div>
<p>This infection mechanism embodies the spatial nature of disease transmission. Rather than having equal probability of contacting any individual in the population, agents only interact with immediate neighbors on the grid. This spatial constraint more accurately reflects real-world transmission, where diseases spread primarily through local contact networks rather than uniformly across entire populations.</p>
<p>The recovery process operates deterministically—after a fixed number of time steps in the infected state, agents transition to recovered status. This deterministic recovery simplifies the model while capturing the essential feature that infections have finite duration. In reality, recovery times vary across individuals, but the fixed duration provides a reasonable approximation that keeps the model tractable while preserving key dynamics.</p>
</div>
<div id="orchestrating-the-epidemic" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Orchestrating the Epidemic<a href="modeling-disease-spread-the-sir-epidemic-framework.html#orchestrating-the-epidemic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The model class coordinates the initialization and evolution of the epidemic, managing both the spatial arrangement of agents and the collection of population-level statistics:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-1" tabindex="-1"></a><span class="kw">class</span> EpidemicModel(Model):</span>
<span id="cb110-2"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-2" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, width<span class="op">=</span><span class="dv">50</span>, height<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="fl">0.8</span>, </span>
<span id="cb110-3"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-3" tabindex="-1"></a>                 initial_infected<span class="op">=</span><span class="dv">5</span>, infection_rate<span class="op">=</span><span class="fl">0.3</span>, recovery_time<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb110-4"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-4" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb110-5"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-5" tabindex="-1"></a>        <span class="va">self</span>.width <span class="op">=</span> width</span>
<span id="cb110-6"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-6" tabindex="-1"></a>        <span class="va">self</span>.height <span class="op">=</span> height</span>
<span id="cb110-7"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-7" tabindex="-1"></a>        <span class="va">self</span>.infection_rate <span class="op">=</span> infection_rate</span>
<span id="cb110-8"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-8" tabindex="-1"></a>        <span class="va">self</span>.recovery_time <span class="op">=</span> recovery_time</span>
<span id="cb110-9"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-9" tabindex="-1"></a>        <span class="va">self</span>.grid <span class="op">=</span> MultiGrid(width, height, torus<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb110-10"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-10" tabindex="-1"></a>        </span>
<span id="cb110-11"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-11" tabindex="-1"></a>        <span class="co"># Create agents</span></span>
<span id="cb110-12"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-12" tabindex="-1"></a>        n_agents <span class="op">=</span> <span class="bu">int</span>(width <span class="op">*</span> height <span class="op">*</span> density)</span>
<span id="cb110-13"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-13" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_agents):</span>
<span id="cb110-14"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-14" tabindex="-1"></a>            state <span class="op">=</span> <span class="st">&#39;I&#39;</span> <span class="cf">if</span> i <span class="op">&lt;</span> initial_infected <span class="cf">else</span> <span class="st">&#39;S&#39;</span></span>
<span id="cb110-15"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-15" tabindex="-1"></a>            agent <span class="op">=</span> PersonAgent(<span class="va">self</span>, state)</span>
<span id="cb110-16"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-16" tabindex="-1"></a>            </span>
<span id="cb110-17"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-17" tabindex="-1"></a>            <span class="co"># Place agent on grid</span></span>
<span id="cb110-18"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-18" tabindex="-1"></a>            x <span class="op">=</span> <span class="va">self</span>.random.randrange(<span class="va">self</span>.width)</span>
<span id="cb110-19"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-19" tabindex="-1"></a>            y <span class="op">=</span> <span class="va">self</span>.random.randrange(<span class="va">self</span>.height)</span>
<span id="cb110-20"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb110-20" tabindex="-1"></a>            <span class="va">self</span>.grid.place_agent(agent, (x, y))</span></code></pre></div>
<p>The initialization establishes a population where a small number of infected individuals—the index cases—exist within a largely susceptible population. This setup mirrors real epidemic scenarios where diseases typically enter populations through a limited number of initial infections. The random spatial distribution ensures that starting configurations don’t bias the subsequent dynamics, though the specific locations of initial infections can significantly influence early epidemic trajectories.</p>
<p>The model’s parameters provide levers for exploring different epidemic scenarios. Population density determines how many agents occupy the grid, affecting the average number of neighbors each agent encounters. Higher density increases contact rates, accelerating transmission but also allowing faster spatial spread. The infection rate β controls transmission probability per contact, while the recovery time 1/γ determines infection duration. Together, these parameters determine the epidemic’s overall trajectory.</p>
<p>Data collection mechanisms track the population-level dynamics that emerge from individual transmission events:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb111-1" tabindex="-1"></a><span class="va">self</span>.datacollector <span class="op">=</span> DataCollector(</span>
<span id="cb111-2"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb111-2" tabindex="-1"></a>    model_reporters<span class="op">=</span>{</span>
<span id="cb111-3"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb111-3" tabindex="-1"></a>        <span class="st">&quot;Susceptible&quot;</span>: <span class="kw">lambda</span> m: <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> a <span class="kw">in</span> m.agents <span class="cf">if</span> a.state <span class="op">==</span> <span class="st">&#39;S&#39;</span>),</span>
<span id="cb111-4"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb111-4" tabindex="-1"></a>        <span class="st">&quot;Infected&quot;</span>: <span class="kw">lambda</span> m: <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> a <span class="kw">in</span> m.agents <span class="cf">if</span> a.state <span class="op">==</span> <span class="st">&#39;I&#39;</span>),</span>
<span id="cb111-5"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb111-5" tabindex="-1"></a>        <span class="st">&quot;Recovered&quot;</span>: <span class="kw">lambda</span> m: <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> a <span class="kw">in</span> m.agents <span class="cf">if</span> a.state <span class="op">==</span> <span class="st">&#39;R&#39;</span>)</span>
<span id="cb111-6"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb111-6" tabindex="-1"></a>    }</span>
<span id="cb111-7"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb111-7" tabindex="-1"></a>)</span></code></pre></div>
<p>These reporters count agents in each state at every time step, generating the familiar epidemic curves that show how disease prevalence evolves over time. The susceptible population typically declines monotonically as individuals become infected, while the infected population first rises then falls as recovery outpaces new infections. The recovered population accumulates over time, eventually comprising most of the population if the epidemic runs its course.</p>
</div>
<div id="the-temporal-evolution-of-epidemics" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">14.4</span> The Temporal Evolution of Epidemics<a href="modeling-disease-spread-the-sir-epidemic-framework.html#the-temporal-evolution-of-epidemics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The simulation’s step function advances the epidemic by allowing all agents to execute their behavioral rules:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb112-1" tabindex="-1"></a><span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb112-2"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb112-2" tabindex="-1"></a>    <span class="co"># Shuffle and activate all agents</span></span>
<span id="cb112-3"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb112-3" tabindex="-1"></a>    <span class="va">self</span>.agents.shuffle_do(<span class="st">&quot;step&quot;</span>)</span>
<span id="cb112-4"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb112-4" tabindex="-1"></a>    <span class="va">self</span>.datacollector.collect(<span class="va">self</span>)</span></code></pre></div>
<p>The shuffling ensures that agent activation order doesn’t systematically bias transmission patterns—a subtle but important consideration in agent-based models where temporal ordering can affect outcomes. Without shuffling, agents processed early in each step would have systematic advantages or disadvantages compared to those processed later.</p>
<p>Running the simulation reveals the characteristic trajectory of epidemic spread:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-1" tabindex="-1"></a>model <span class="op">=</span> EpidemicModel(</span>
<span id="cb113-2"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-2" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">50</span>, </span>
<span id="cb113-3"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-3" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">50</span>, </span>
<span id="cb113-4"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-4" tabindex="-1"></a>    density<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb113-5"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-5" tabindex="-1"></a>    initial_infected<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb113-6"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-6" tabindex="-1"></a>    infection_rate<span class="op">=</span><span class="fl">0.25</span>,</span>
<span id="cb113-7"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-7" tabindex="-1"></a>    recovery_time<span class="op">=</span><span class="dv">10</span></span>
<span id="cb113-8"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-8" tabindex="-1"></a>)</span>
<span id="cb113-9"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-9" tabindex="-1"></a></span>
<span id="cb113-10"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-10" tabindex="-1"></a><span class="cf">for</span> step <span class="kw">in</span> <span class="bu">range</span>(n_steps):</span>
<span id="cb113-11"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-11" tabindex="-1"></a>    grid_state <span class="op">=</span> np.zeros((model.height, model.width))</span>
<span id="cb113-12"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-12" tabindex="-1"></a>    <span class="cf">for</span> agent <span class="kw">in</span> model.agents:</span>
<span id="cb113-13"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-13" tabindex="-1"></a>        x, y <span class="op">=</span> agent.pos</span>
<span id="cb113-14"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-14" tabindex="-1"></a>        <span class="cf">if</span> agent.state <span class="op">==</span> <span class="st">&#39;S&#39;</span>:</span>
<span id="cb113-15"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-15" tabindex="-1"></a>            grid_state[y, x] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb113-16"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-16" tabindex="-1"></a>        <span class="cf">elif</span> agent.state <span class="op">==</span> <span class="st">&#39;I&#39;</span>:</span>
<span id="cb113-17"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-17" tabindex="-1"></a>            grid_state[y, x] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb113-18"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-18" tabindex="-1"></a>        <span class="cf">elif</span> agent.state <span class="op">==</span> <span class="st">&#39;R&#39;</span>:</span>
<span id="cb113-19"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-19" tabindex="-1"></a>            grid_state[y, x] <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb113-20"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-20" tabindex="-1"></a>    grid_states.append(grid_state.copy())</span>
<span id="cb113-21"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb113-21" tabindex="-1"></a>    model.step()</span></code></pre></div>
<p>This execution loop captures snapshots of the spatial distribution at each time step, enabling visualization of how infection spreads across the population. The progression typically shows initial growth from the index cases, followed by rapid spatial expansion as the infection wave propagates through susceptible neighborhoods, and eventually deceleration as the pool of susceptible individuals depletes.</p>
</div>
<div id="analyzing-epidemic-dynamics" class="section level2 hasAnchor" number="14.5">
<h2><span class="header-section-number">14.5</span> Analyzing Epidemic Dynamics<a href="modeling-disease-spread-the-sir-epidemic-framework.html#analyzing-epidemic-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The collected data reveals several key epidemiological features. The epidemic curve—the time series of infected individuals—typically exhibits a characteristic shape: exponential growth during early stages when most contacts involve susceptible individuals, a peak when depletion of susceptibles slows transmission below recovery rates, and eventual decline as few susceptible individuals remain. The timing and magnitude of this peak carry crucial public health implications, determining healthcare system strain and overall disease burden.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb114-1" tabindex="-1"></a>data <span class="op">=</span> model.datacollector.get_model_vars_dataframe()</span>
<span id="cb114-2"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb114-2" tabindex="-1"></a></span>
<span id="cb114-3"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb114-3" tabindex="-1"></a>plt.plot(data[<span class="st">&#39;Susceptible&#39;</span>], label<span class="op">=</span><span class="st">&#39;Susceptible&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb114-4"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb114-4" tabindex="-1"></a>plt.plot(data[<span class="st">&#39;Infected&#39;</span>], label<span class="op">=</span><span class="st">&#39;Infected&#39;</span>, color<span class="op">=</span><span class="st">&#39;red&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb114-5"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb114-5" tabindex="-1"></a>plt.plot(data[<span class="st">&#39;Recovered&#39;</span>], label<span class="op">=</span><span class="st">&#39;Recovered&#39;</span>, color<span class="op">=</span><span class="st">&#39;green&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb114-6"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb114-6" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Time Steps&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb114-7"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb114-7" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of Agents&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb114-8"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb114-8" tabindex="-1"></a>plt.title(<span class="st">&#39;SIR Epidemic Model Dynamics&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb114-9"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb114-9" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb114-10"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb114-10" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span></code></pre></div>
<p>The final size of the epidemic—the total proportion of the population that eventually becomes infected—depends critically on the basic reproduction number R₀. For R₀ &gt; 1, the epidemic takes off, ultimately infecting a substantial fraction of the population. The final size relation provides a transcendental equation connecting R₀ to the proportion escaping infection:</p>
<p>S(∞)/N = exp(-R₀(1 - S(∞)/N))</p>
<p>where S(∞) represents the number of individuals who never become infected. This equation has no closed-form solution but can be solved numerically to predict epidemic outcomes from model parameters.</p>
<p>The spatial visualization captures another critical feature—the wave-like propagation of infection through space:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb115-1" tabindex="-1"></a>plt.imshow(grid_states[<span class="op">-</span><span class="dv">1</span>], cmap<span class="op">=</span><span class="st">&#39;RdYlGn_r&#39;</span>, interpolation<span class="op">=</span><span class="st">&#39;nearest&#39;</span>)</span>
<span id="cb115-2"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb115-2" tabindex="-1"></a>plt.colorbar(ticks<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>], label<span class="op">=</span><span class="st">&#39;State&#39;</span>)</span>
<span id="cb115-3"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb115-3" tabindex="-1"></a>plt.title(<span class="st">&#39;Final Spatial Distribution&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb115-4"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb115-4" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;X Position&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb115-5"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb115-5" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Y Position&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span></code></pre></div>
<p>Unlike well-mixed models where everyone has equal infection risk, spatial structure creates traveling waves where infection spreads outward from initial foci. These waves generate complex spatial patterns influenced by population density, spatial heterogeneity, and stochastic fluctuations. The final state typically shows clusters of recovered individuals surrounding the initial infection sites, with remaining susceptible individuals concentrated in areas the epidemic wave never reached.</p>
</div>
<div id="the-role-of-stochasticity" class="section level2 hasAnchor" number="14.6">
<h2><span class="header-section-number">14.6</span> The Role of Stochasticity<a href="modeling-disease-spread-the-sir-epidemic-framework.html#the-role-of-stochasticity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Agent-based epidemic models inherently incorporate stochastic effects that deterministic differential equations cannot capture. In small populations or during early epidemic stages, random fluctuations can significantly alter outcomes. An infection introduced into a population might spark a major epidemic or might stochastically die out before gaining momentum—a phenomenon called “fade-out” that deterministic models cannot represent.</p>
<p>The transmission probability creates binomial uncertainty at each contact event. When an infected agent encounters a susceptible neighbor, transmission occurs with probability β but fails with probability (1-β). This randomness accumulates across many contact events, generating variability in epidemic trajectories even when starting from identical initial conditions. Running multiple replicate simulations reveals this intrinsic stochasticity through the distribution of epidemic sizes and peak timing.</p>
<p>The spatial structure interacts with stochasticity in subtle ways. In spatially structured populations, local clusters of infected individuals can create infection hotspots that drive regional outbreaks. Random placement of index cases determines which regions experience early seeding, setting the stage for different spatial patterns. This interplay between spatial structure and stochastic transmission generates rich dynamics that homogeneous models miss entirely.</p>
</div>
<div id="extensions-and-variations-1" class="section level2 hasAnchor" number="14.7">
<h2><span class="header-section-number">14.7</span> Extensions and Variations<a href="modeling-disease-spread-the-sir-epidemic-framework.html#extensions-and-variations-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The basic SIR framework admits numerous extensions that capture additional epidemiological realities. Adding an exposed (E) state creates the SEIR model, where newly infected individuals undergo a latency period before becoming infectious. This modification better represents diseases like influenza or COVID-19, where substantial delays exist between infection and symptom onset:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb116-1" tabindex="-1"></a><span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb116-2"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb116-2" tabindex="-1"></a>    <span class="cf">if</span> <span class="va">self</span>.state <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</span>
<span id="cb116-3"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb116-3" tabindex="-1"></a>        <span class="va">self</span>.exposure_time <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb116-4"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb116-4" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.exposure_time <span class="op">&gt;=</span> <span class="va">self</span>.model.latency_period:</span>
<span id="cb116-5"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb116-5" tabindex="-1"></a>            <span class="va">self</span>.state <span class="op">=</span> <span class="st">&#39;I&#39;</span></span>
<span id="cb116-6"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb116-6" tabindex="-1"></a>            <span class="va">self</span>.exposure_time <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb116-7"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb116-7" tabindex="-1"></a>    <span class="cf">elif</span> <span class="va">self</span>.state <span class="op">==</span> <span class="st">&#39;I&#39;</span>:</span>
<span id="cb116-8"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb116-8" tabindex="-1"></a>        <span class="va">self</span>.infect()</span>
<span id="cb116-9"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb116-9" tabindex="-1"></a>        <span class="va">self</span>.infection_time <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb116-10"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb116-10" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.infection_time <span class="op">&gt;=</span> <span class="va">self</span>.model.recovery_time:</span>
<span id="cb116-11"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb116-11" tabindex="-1"></a>            <span class="va">self</span>.state <span class="op">=</span> <span class="st">&#39;R&#39;</span></span></code></pre></div>
<p>Vital dynamics—births and deaths—transform short-term epidemic models into long-term endemic disease models. Adding a birth rate that creates new susceptible individuals and a natural death rate allows examination of how diseases persist in populations over time. Some diseases reach endemic equilibria where new infections exactly balance recoveries, maintaining constant disease prevalence indefinitely.</p>
<p>Heterogeneous contact patterns provide another important extension. Rather than uniform spatial grids, more realistic models might incorporate social network structures where individuals have varying numbers of contacts. High-degree nodes—individuals with many contacts—play disproportionate roles in disease spread, suggesting targeted interventions focusing on these super-spreaders might efficiently control transmission.</p>
<p>Behavioral responses to epidemics add feedback loops between disease prevalence and transmission rates. As epidemics become more visible, individuals might reduce contacts through social distancing or increase protective behaviors like mask-wearing. These behavioral changes effectively reduce transmission rates β during epidemic peaks, potentially preventing healthcare system collapse but also prolonging epidemic duration by allowing susceptible populations to persist longer.</p>
</div>
<div id="public-health-implications" class="section level2 hasAnchor" number="14.8">
<h2><span class="header-section-number">14.8</span> Public Health Implications<a href="modeling-disease-spread-the-sir-epidemic-framework.html#public-health-implications" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Agent-based epidemic models inform public health decision-making by allowing exploration of intervention scenarios. Vaccination campaigns can be modeled by moving a proportion of agents from susceptible to recovered states before epidemic initiation. The herd immunity threshold—the vaccination coverage needed to prevent epidemic spread—emerges naturally from simulations, typically occurring when (1 - 1/R₀) of the population gains immunity.</p>
<p>Pharmaceutical interventions like treatment that reduces infection duration can be explored by modifying recovery times for treated individuals. The model can assess how different treatment coverages and timings affect epidemic trajectories, informing resource allocation decisions during disease outbreaks. Non-pharmaceutical interventions like quarantine can be implemented by restricting movement or contacts for infected individuals, revealing how different quarantine strategies influence transmission.</p>
<p>The spatial aspects of agent-based models prove particularly valuable for understanding how local interventions affect regional disease dynamics. Targeted interventions in high-transmission neighborhoods might prevent broader spread more efficiently than population-wide measures. Geographic targeting of limited resources—whether vaccines, treatments, or public health messaging—can be optimized through spatial epidemic simulations.</p>
</div>
<div id="computational-considerations-1" class="section level2 hasAnchor" number="14.9">
<h2><span class="header-section-number">14.9</span> Computational Considerations<a href="modeling-disease-spread-the-sir-epidemic-framework.html#computational-considerations-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>From an implementation perspective, epidemic models demonstrate efficient use of Mesa’s agent-based modeling capabilities. The state-based agent architecture cleanly separates different disease stages while the grid structure naturally represents spatial contact patterns. Data collection through Mesa’s DataCollector provides automatic time series generation without manual bookkeeping.</p>
<p>The visualization capabilities showcase the power of combining temporal and spatial representations:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb117-1"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-1" tabindex="-1"></a>fig_anim, ax_anim <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb117-2"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-2" tabindex="-1"></a>im_anim <span class="op">=</span> ax_anim.imshow(grid_states[<span class="dv">0</span>], cmap<span class="op">=</span><span class="st">&#39;RdYlGn_r&#39;</span>, interpolation<span class="op">=</span><span class="st">&#39;nearest&#39;</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb117-3"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-3" tabindex="-1"></a>plt.colorbar(im_anim, ax<span class="op">=</span>ax_anim, ticks<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>], label<span class="op">=</span><span class="st">&#39;State (0=S, 1=I, 2=R)&#39;</span>)</span>
<span id="cb117-4"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-4" tabindex="-1"></a>title_anim <span class="op">=</span> ax_anim.set_title(<span class="st">&#39;SIR Epidemic Spread - Step 0&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb117-5"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-5" tabindex="-1"></a></span>
<span id="cb117-6"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-6" tabindex="-1"></a>stats_text <span class="op">=</span> ax_anim.text(<span class="fl">0.02</span>, <span class="fl">0.98</span>, <span class="st">&#39;&#39;</span>, transform<span class="op">=</span>ax_anim.transAxes, </span>
<span id="cb117-7"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-7" tabindex="-1"></a>                          fontsize<span class="op">=</span><span class="dv">10</span>, verticalalignment<span class="op">=</span><span class="st">&#39;top&#39;</span>,</span>
<span id="cb117-8"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-8" tabindex="-1"></a>                          bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">&#39;round&#39;</span>, facecolor<span class="op">=</span><span class="st">&#39;wheat&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb117-9"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-9" tabindex="-1"></a></span>
<span id="cb117-10"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-10" tabindex="-1"></a><span class="kw">def</span> animate(frame):</span>
<span id="cb117-11"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-11" tabindex="-1"></a>    im_anim.set_array(grid_states[frame])</span>
<span id="cb117-12"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-12" tabindex="-1"></a>    title_anim.set_text(<span class="ss">f&#39;SIR Epidemic Spread - Step </span><span class="sc">{</span>frame<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb117-13"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-13" tabindex="-1"></a>    </span>
<span id="cb117-14"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-14" tabindex="-1"></a>    s_count <span class="op">=</span> <span class="bu">int</span>(data[<span class="st">&#39;Susceptible&#39;</span>].iloc[frame])</span>
<span id="cb117-15"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-15" tabindex="-1"></a>    i_count <span class="op">=</span> <span class="bu">int</span>(data[<span class="st">&#39;Infected&#39;</span>].iloc[frame])</span>
<span id="cb117-16"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-16" tabindex="-1"></a>    r_count <span class="op">=</span> <span class="bu">int</span>(data[<span class="st">&#39;Recovered&#39;</span>].iloc[frame])</span>
<span id="cb117-17"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-17" tabindex="-1"></a>    stats_text.set_text(<span class="ss">f&#39;S: </span><span class="sc">{</span>s_count<span class="sc">}</span><span class="ch">\n</span><span class="ss">I: </span><span class="sc">{</span>i_count<span class="sc">}</span><span class="ch">\n</span><span class="ss">R: </span><span class="sc">{</span>r_count<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb117-18"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-18" tabindex="-1"></a>    </span>
<span id="cb117-19"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-19" tabindex="-1"></a>    <span class="cf">return</span> [im_anim, title_anim, stats_text]</span>
<span id="cb117-20"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-20" tabindex="-1"></a></span>
<span id="cb117-21"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-21" tabindex="-1"></a>anim <span class="op">=</span> FuncAnimation(fig_anim, animate, frames<span class="op">=</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(grid_states), <span class="dv">2</span>), </span>
<span id="cb117-22"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb117-22" tabindex="-1"></a>                     interval<span class="op">=</span><span class="dv">100</span>, blit<span class="op">=</span><span class="va">True</span>, repeat<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>These animations reveal spatial-temporal dynamics that static plots cannot capture, showing how infection waves propagate through populations and how spatial heterogeneities influence disease spread. The real-time statistics overlay provides quantitative context for the visual patterns, connecting individual transmission events to population-level epidemic curves.</p>
</div>
<div id="limitations-and-future-directions" class="section level2 hasAnchor" number="14.10">
<h2><span class="header-section-number">14.10</span> Limitations and Future Directions<a href="modeling-disease-spread-the-sir-epidemic-framework.html#limitations-and-future-directions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While agent-based epidemic models offer significant advantages over classical differential equation approaches, they also face important limitations. Computational costs scale with population size, potentially limiting the size of populations that can be simulated efficiently. Large-scale epidemic modeling might require hybrid approaches combining agent-based detail in critical regions with coarser representations elsewhere.</p>
<p>Parameter estimation presents another challenge. Real epidemic data typically provide only aggregate counts of cases over time, not detailed information about individual transmission events or contact patterns. Calibrating agent-based models to real data requires sophisticated inference methods, often involving computationally intensive approaches like approximate Bayesian computation or likelihood-free inference.</p>
<p>Model validation remains an ongoing concern. Agent-based models involve numerous design choices—grid topology, neighborhood structures, agent behaviors—that might influence outcomes in ways that aren’t immediately obvious. Careful sensitivity analysis examining how results depend on these structural assumptions becomes essential for building confidence in model predictions.</p>
<p>Despite these challenges, agent-based epidemic modeling continues advancing, incorporating increasing realism through detailed demographic structure, realistic contact networks derived from empirical data, and sophisticated behavioral responses. These enhanced models played crucial roles in guiding policy responses to recent disease outbreaks, demonstrating how computational modeling can directly inform public health decision-making.</p>
</div>
<div id="from-individuals-to-populations" class="section level2 hasAnchor" number="14.11">
<h2><span class="header-section-number">14.11</span> From Individuals to Populations<a href="modeling-disease-spread-the-sir-epidemic-framework.html#from-individuals-to-populations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The SIR epidemic model exemplifies how agent-based approaches bridge individual behavior and population-level outcomes. Each agent follows simple rules—attempt to infect neighbors when infected, recover after a specified duration—yet these individual actions aggregate into complex population dynamics characterized by exponential growth, epidemic peaks, and eventual decline. The spatial patterns emerging from local transmission create traveling waves and clustering phenomena absent from well-mixed models.</p>
<p>This connection between individual and collective scales appears throughout agent-based modeling, from our original random walker exploring space to Schelling agents creating segregated neighborhoods. In each case, simple individual rules generate emergent patterns that transcend their components. For epidemic models, this emergence carries life-and-death consequences, making the careful study of how individual transmission events shape population health trajectories not just intellectually fascinating but critically important.</p>
<p>As we continue exploring agent-based modeling techniques, the epidemic framework provides a template for thinking about state transitions, temporal dynamics, and spatial propagation. These concepts recur across domains—from information spreading through social networks to innovations diffusing through markets—suggesting that the lessons learned from modeling disease spread extend far beyond epidemiology itself. The fundamental insight remains constant: understanding how systems evolve requires examining both the rules governing individual behavior and the structures through which those individuals interact.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-1" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb118-2"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-2" tabindex="-1"></a>    <span class="im">import</span> mesa</span>
<span id="cb118-3"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-3" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb118-4"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-4" tabindex="-1"></a>    <span class="op">!</span>pip install <span class="op">-</span>q mesa</span>
<span id="cb118-5"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-5" tabindex="-1"></a>    <span class="im">import</span> mesa</span>
<span id="cb118-6"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-6" tabindex="-1"></a></span>
<span id="cb118-7"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-7" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb118-8"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-8" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb118-9"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-9" tabindex="-1"></a><span class="im">from</span> matplotlib.animation <span class="im">import</span> FuncAnimation</span>
<span id="cb118-10"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-10" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb118-11"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-11" tabindex="-1"></a><span class="im">from</span> mesa <span class="im">import</span> Agent, Model</span>
<span id="cb118-12"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-12" tabindex="-1"></a><span class="im">from</span> mesa.space <span class="im">import</span> MultiGrid</span>
<span id="cb118-13"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-13" tabindex="-1"></a><span class="im">from</span> mesa.datacollection <span class="im">import</span> DataCollector</span>
<span id="cb118-14"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-14" tabindex="-1"></a></span>
<span id="cb118-15"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-15" tabindex="-1"></a><span class="co"># Agent class</span></span>
<span id="cb118-16"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-16" tabindex="-1"></a><span class="kw">class</span> PersonAgent(Agent):</span>
<span id="cb118-17"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-17" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model, state<span class="op">=</span><span class="st">&#39;S&#39;</span>):</span>
<span id="cb118-18"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-18" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(model)</span>
<span id="cb118-19"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-19" tabindex="-1"></a>        <span class="va">self</span>.state <span class="op">=</span> state  <span class="co"># &#39;S&#39;, &#39;I&#39;, or &#39;R&#39;</span></span>
<span id="cb118-20"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-20" tabindex="-1"></a>        <span class="va">self</span>.infection_time <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb118-21"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-21" tabindex="-1"></a>        </span>
<span id="cb118-22"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-22" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb118-23"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-23" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.state <span class="op">==</span> <span class="st">&#39;I&#39;</span>:</span>
<span id="cb118-24"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-24" tabindex="-1"></a>            <span class="va">self</span>.infect()</span>
<span id="cb118-25"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-25" tabindex="-1"></a>            <span class="va">self</span>.infection_time <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb118-26"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-26" tabindex="-1"></a>            <span class="co"># Recover after infection period</span></span>
<span id="cb118-27"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-27" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.infection_time <span class="op">&gt;=</span> <span class="va">self</span>.model.recovery_time:</span>
<span id="cb118-28"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-28" tabindex="-1"></a>                <span class="va">self</span>.state <span class="op">=</span> <span class="st">&#39;R&#39;</span></span>
<span id="cb118-29"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-29" tabindex="-1"></a>                <span class="va">self</span>.infection_time <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb118-30"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-30" tabindex="-1"></a>    </span>
<span id="cb118-31"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-31" tabindex="-1"></a>    <span class="kw">def</span> infect(<span class="va">self</span>):</span>
<span id="cb118-32"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-32" tabindex="-1"></a>        neighbors <span class="op">=</span> <span class="va">self</span>.model.grid.get_neighbors(</span>
<span id="cb118-33"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-33" tabindex="-1"></a>            <span class="va">self</span>.pos, moore<span class="op">=</span><span class="va">True</span>, include_center<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb118-34"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-34" tabindex="-1"></a>        susceptible_neighbors <span class="op">=</span> [agent <span class="cf">for</span> agent <span class="kw">in</span> neighbors </span>
<span id="cb118-35"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-35" tabindex="-1"></a>                                <span class="cf">if</span> agent.state <span class="op">==</span> <span class="st">&#39;S&#39;</span>]</span>
<span id="cb118-36"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-36" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> susceptible_neighbors:</span>
<span id="cb118-37"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-37" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.random.random() <span class="op">&lt;</span> <span class="va">self</span>.model.infection_rate:</span>
<span id="cb118-38"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-38" tabindex="-1"></a>                neighbor.state <span class="op">=</span> <span class="st">&#39;I&#39;</span></span>
<span id="cb118-39"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-39" tabindex="-1"></a></span>
<span id="cb118-40"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-40" tabindex="-1"></a><span class="co"># Model class</span></span>
<span id="cb118-41"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-41" tabindex="-1"></a><span class="kw">class</span> EpidemicModel(Model):</span>
<span id="cb118-42"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-42" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, width<span class="op">=</span><span class="dv">50</span>, height<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="fl">0.8</span>, </span>
<span id="cb118-43"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-43" tabindex="-1"></a>                 initial_infected<span class="op">=</span><span class="dv">5</span>, infection_rate<span class="op">=</span><span class="fl">0.3</span>, recovery_time<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb118-44"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-44" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb118-45"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-45" tabindex="-1"></a>        <span class="va">self</span>.width <span class="op">=</span> width</span>
<span id="cb118-46"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-46" tabindex="-1"></a>        <span class="va">self</span>.height <span class="op">=</span> height</span>
<span id="cb118-47"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-47" tabindex="-1"></a>        <span class="va">self</span>.infection_rate <span class="op">=</span> infection_rate</span>
<span id="cb118-48"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-48" tabindex="-1"></a>        <span class="va">self</span>.recovery_time <span class="op">=</span> recovery_time</span>
<span id="cb118-49"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-49" tabindex="-1"></a>        <span class="va">self</span>.grid <span class="op">=</span> MultiGrid(width, height, torus<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb118-50"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-50" tabindex="-1"></a>        </span>
<span id="cb118-51"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-51" tabindex="-1"></a>        <span class="co"># Create agents</span></span>
<span id="cb118-52"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-52" tabindex="-1"></a>        n_agents <span class="op">=</span> <span class="bu">int</span>(width <span class="op">*</span> height <span class="op">*</span> density)</span>
<span id="cb118-53"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-53" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_agents):</span>
<span id="cb118-54"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-54" tabindex="-1"></a>            state <span class="op">=</span> <span class="st">&#39;I&#39;</span> <span class="cf">if</span> i <span class="op">&lt;</span> initial_infected <span class="cf">else</span> <span class="st">&#39;S&#39;</span></span>
<span id="cb118-55"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-55" tabindex="-1"></a>            agent <span class="op">=</span> PersonAgent(<span class="va">self</span>, state)</span>
<span id="cb118-56"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-56" tabindex="-1"></a>            </span>
<span id="cb118-57"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-57" tabindex="-1"></a>            <span class="co"># Place agent on grid</span></span>
<span id="cb118-58"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-58" tabindex="-1"></a>            x <span class="op">=</span> <span class="va">self</span>.random.randrange(<span class="va">self</span>.width)</span>
<span id="cb118-59"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-59" tabindex="-1"></a>            y <span class="op">=</span> <span class="va">self</span>.random.randrange(<span class="va">self</span>.height)</span>
<span id="cb118-60"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-60" tabindex="-1"></a>            <span class="va">self</span>.grid.place_agent(agent, (x, y))</span>
<span id="cb118-61"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-61" tabindex="-1"></a>        </span>
<span id="cb118-62"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-62" tabindex="-1"></a>        <span class="co"># Data collection</span></span>
<span id="cb118-63"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-63" tabindex="-1"></a>        <span class="va">self</span>.datacollector <span class="op">=</span> DataCollector(</span>
<span id="cb118-64"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-64" tabindex="-1"></a>            model_reporters<span class="op">=</span>{</span>
<span id="cb118-65"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-65" tabindex="-1"></a>                <span class="st">&quot;Susceptible&quot;</span>: <span class="kw">lambda</span> m: <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> a <span class="kw">in</span> m.agents <span class="cf">if</span> a.state <span class="op">==</span> <span class="st">&#39;S&#39;</span>),</span>
<span id="cb118-66"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-66" tabindex="-1"></a>                <span class="st">&quot;Infected&quot;</span>: <span class="kw">lambda</span> m: <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> a <span class="kw">in</span> m.agents <span class="cf">if</span> a.state <span class="op">==</span> <span class="st">&#39;I&#39;</span>),</span>
<span id="cb118-67"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-67" tabindex="-1"></a>                <span class="st">&quot;Recovered&quot;</span>: <span class="kw">lambda</span> m: <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> a <span class="kw">in</span> m.agents <span class="cf">if</span> a.state <span class="op">==</span> <span class="st">&#39;R&#39;</span>)</span>
<span id="cb118-68"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-68" tabindex="-1"></a>            }</span>
<span id="cb118-69"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-69" tabindex="-1"></a>        )</span>
<span id="cb118-70"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-70" tabindex="-1"></a>        <span class="va">self</span>.datacollector.collect(<span class="va">self</span>)</span>
<span id="cb118-71"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-71" tabindex="-1"></a>    </span>
<span id="cb118-72"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-72" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb118-73"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-73" tabindex="-1"></a>        <span class="co"># Shuffle and activate all agents</span></span>
<span id="cb118-74"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-74" tabindex="-1"></a>        <span class="va">self</span>.agents.shuffle_do(<span class="st">&quot;step&quot;</span>)</span>
<span id="cb118-75"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-75" tabindex="-1"></a>        <span class="va">self</span>.datacollector.collect(<span class="va">self</span>)</span>
<span id="cb118-76"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-76" tabindex="-1"></a></span>
<span id="cb118-77"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-77" tabindex="-1"></a><span class="co"># Run simulation and collect frames for animation</span></span>
<span id="cb118-78"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-78" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Running SIR Epidemic Model with animation...&quot;</span>)</span>
<span id="cb118-79"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-79" tabindex="-1"></a>model <span class="op">=</span> EpidemicModel(</span>
<span id="cb118-80"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-80" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">50</span>, </span>
<span id="cb118-81"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-81" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">50</span>, </span>
<span id="cb118-82"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-82" tabindex="-1"></a>    density<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb118-83"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-83" tabindex="-1"></a>    initial_infected<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb118-84"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-84" tabindex="-1"></a>    infection_rate<span class="op">=</span><span class="fl">0.25</span>,</span>
<span id="cb118-85"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-85" tabindex="-1"></a>    recovery_time<span class="op">=</span><span class="dv">10</span></span>
<span id="cb118-86"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-86" tabindex="-1"></a>)</span>
<span id="cb118-87"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-87" tabindex="-1"></a></span>
<span id="cb118-88"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-88" tabindex="-1"></a><span class="co"># Store grid states for animation</span></span>
<span id="cb118-89"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-89" tabindex="-1"></a>grid_states <span class="op">=</span> []</span>
<span id="cb118-90"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-90" tabindex="-1"></a>n_steps <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb118-91"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-91" tabindex="-1"></a></span>
<span id="cb118-92"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-92" tabindex="-1"></a><span class="cf">for</span> step <span class="kw">in</span> <span class="bu">range</span>(n_steps):</span>
<span id="cb118-93"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-93" tabindex="-1"></a>    <span class="co"># Capture grid state</span></span>
<span id="cb118-94"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-94" tabindex="-1"></a>    grid_state <span class="op">=</span> np.zeros((model.height, model.width))</span>
<span id="cb118-95"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-95" tabindex="-1"></a>    <span class="cf">for</span> agent <span class="kw">in</span> model.agents:</span>
<span id="cb118-96"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-96" tabindex="-1"></a>        x, y <span class="op">=</span> agent.pos</span>
<span id="cb118-97"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-97" tabindex="-1"></a>        <span class="cf">if</span> agent.state <span class="op">==</span> <span class="st">&#39;S&#39;</span>:</span>
<span id="cb118-98"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-98" tabindex="-1"></a>            grid_state[y, x] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb118-99"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-99" tabindex="-1"></a>        <span class="cf">elif</span> agent.state <span class="op">==</span> <span class="st">&#39;I&#39;</span>:</span>
<span id="cb118-100"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-100" tabindex="-1"></a>            grid_state[y, x] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb118-101"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-101" tabindex="-1"></a>        <span class="cf">elif</span> agent.state <span class="op">==</span> <span class="st">&#39;R&#39;</span>:</span>
<span id="cb118-102"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-102" tabindex="-1"></a>            grid_state[y, x] <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb118-103"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-103" tabindex="-1"></a>    grid_states.append(grid_state.copy())</span>
<span id="cb118-104"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-104" tabindex="-1"></a>    </span>
<span id="cb118-105"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-105" tabindex="-1"></a>    model.step()</span>
<span id="cb118-106"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-106" tabindex="-1"></a>    <span class="cf">if</span> step <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb118-107"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-107" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Step </span><span class="sc">{</span>step<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>n_steps<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb118-108"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-108" tabindex="-1"></a></span>
<span id="cb118-109"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-109" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Simulation complete! Creating visualizations...&quot;</span>)</span>
<span id="cb118-110"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-110" tabindex="-1"></a>    </span>
<span id="cb118-111"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-111" tabindex="-1"></a><span class="co"># Get and plot results</span></span>
<span id="cb118-112"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-112" tabindex="-1"></a>data <span class="op">=</span> model.datacollector.get_model_vars_dataframe()</span>
<span id="cb118-113"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-113" tabindex="-1"></a></span>
<span id="cb118-114"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-114" tabindex="-1"></a><span class="co"># Create figure with 3 subplots</span></span>
<span id="cb118-115"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-115" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">5</span>))</span>
<span id="cb118-116"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-116" tabindex="-1"></a></span>
<span id="cb118-117"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-117" tabindex="-1"></a><span class="co"># Plot 1: Time series</span></span>
<span id="cb118-118"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-118" tabindex="-1"></a>ax1 <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb118-119"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-119" tabindex="-1"></a>plt.plot(data[<span class="st">&#39;Susceptible&#39;</span>], label<span class="op">=</span><span class="st">&#39;Susceptible&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb118-120"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-120" tabindex="-1"></a>plt.plot(data[<span class="st">&#39;Infected&#39;</span>], label<span class="op">=</span><span class="st">&#39;Infected&#39;</span>, color<span class="op">=</span><span class="st">&#39;red&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb118-121"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-121" tabindex="-1"></a>plt.plot(data[<span class="st">&#39;Recovered&#39;</span>], label<span class="op">=</span><span class="st">&#39;Recovered&#39;</span>, color<span class="op">=</span><span class="st">&#39;green&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb118-122"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-122" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Time Steps&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb118-123"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-123" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of Agents&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb118-124"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-124" tabindex="-1"></a>plt.title(<span class="st">&#39;SIR Epidemic Model Dynamics&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb118-125"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-125" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb118-126"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-126" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb118-127"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-127" tabindex="-1"></a></span>
<span id="cb118-128"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-128" tabindex="-1"></a><span class="co"># Plot 2: Final state visualization</span></span>
<span id="cb118-129"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-129" tabindex="-1"></a>ax2 <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb118-130"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-130" tabindex="-1"></a>plt.imshow(grid_states[<span class="op">-</span><span class="dv">1</span>], cmap<span class="op">=</span><span class="st">&#39;RdYlGn_r&#39;</span>, interpolation<span class="op">=</span><span class="st">&#39;nearest&#39;</span>)</span>
<span id="cb118-131"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-131" tabindex="-1"></a>plt.colorbar(ticks<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>], label<span class="op">=</span><span class="st">&#39;State&#39;</span>)</span>
<span id="cb118-132"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-132" tabindex="-1"></a>plt.title(<span class="st">&#39;Final Spatial Distribution&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb118-133"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-133" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;X Position&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb118-134"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-134" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Y Position&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb118-135"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-135" tabindex="-1"></a></span>
<span id="cb118-136"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-136" tabindex="-1"></a><span class="co"># Plot 3: Animation frame</span></span>
<span id="cb118-137"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-137" tabindex="-1"></a>ax3 <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb118-138"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-138" tabindex="-1"></a>im <span class="op">=</span> ax3.imshow(grid_states[<span class="dv">0</span>], cmap<span class="op">=</span><span class="st">&#39;RdYlGn_r&#39;</span>, interpolation<span class="op">=</span><span class="st">&#39;nearest&#39;</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb118-139"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-139" tabindex="-1"></a>plt.colorbar(im, ax<span class="op">=</span>ax3, ticks<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>], label<span class="op">=</span><span class="st">&#39;State&#39;</span>)</span>
<span id="cb118-140"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-140" tabindex="-1"></a>title <span class="op">=</span> ax3.set_title(<span class="st">&#39;Animation - Step 0&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb118-141"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-141" tabindex="-1"></a>ax3.set_xlabel(<span class="st">&#39;X Position&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb118-142"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-142" tabindex="-1"></a>ax3.set_ylabel(<span class="st">&#39;Y Position&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb118-143"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-143" tabindex="-1"></a></span>
<span id="cb118-144"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-144" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb118-145"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-145" tabindex="-1"></a>plt.show()</span>
<span id="cb118-146"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-146" tabindex="-1"></a></span>
<span id="cb118-147"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-147" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Final Statistics (after </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> steps):&quot;</span>)</span>
<span id="cb118-148"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-148" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Susceptible: </span><span class="sc">{</span>data[<span class="st">&#39;Susceptible&#39;</span>]<span class="sc">.</span>iloc[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb118-149"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-149" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Infected: </span><span class="sc">{</span>data[<span class="st">&#39;Infected&#39;</span>]<span class="sc">.</span>iloc[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb118-150"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-150" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Recovered: </span><span class="sc">{</span>data[<span class="st">&#39;Recovered&#39;</span>]<span class="sc">.</span>iloc[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb118-151"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-151" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Peak infection: </span><span class="sc">{</span>data[<span class="st">&#39;Infected&#39;</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss"> at step </span><span class="sc">{</span>data[<span class="st">&#39;Infected&#39;</span>]<span class="sc">.</span>idxmax()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb118-152"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-152" tabindex="-1"></a></span>
<span id="cb118-153"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-153" tabindex="-1"></a><span class="co"># Create animation</span></span>
<span id="cb118-154"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-154" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Creating animation (this may take a moment)...&quot;</span>)</span>
<span id="cb118-155"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-155" tabindex="-1"></a>fig_anim, ax_anim <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb118-156"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-156" tabindex="-1"></a>im_anim <span class="op">=</span> ax_anim.imshow(grid_states[<span class="dv">0</span>], cmap<span class="op">=</span><span class="st">&#39;RdYlGn_r&#39;</span>, interpolation<span class="op">=</span><span class="st">&#39;nearest&#39;</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb118-157"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-157" tabindex="-1"></a>plt.colorbar(im_anim, ax<span class="op">=</span>ax_anim, ticks<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>], label<span class="op">=</span><span class="st">&#39;State (0=S, 1=I, 2=R)&#39;</span>)</span>
<span id="cb118-158"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-158" tabindex="-1"></a>title_anim <span class="op">=</span> ax_anim.set_title(<span class="st">&#39;SIR Epidemic Spread - Step 0&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb118-159"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-159" tabindex="-1"></a>ax_anim.set_xlabel(<span class="st">&#39;X Position&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb118-160"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-160" tabindex="-1"></a>ax_anim.set_ylabel(<span class="st">&#39;Y Position&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb118-161"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-161" tabindex="-1"></a></span>
<span id="cb118-162"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-162" tabindex="-1"></a><span class="co"># Add statistics text</span></span>
<span id="cb118-163"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-163" tabindex="-1"></a>stats_text <span class="op">=</span> ax_anim.text(<span class="fl">0.02</span>, <span class="fl">0.98</span>, <span class="st">&#39;&#39;</span>, transform<span class="op">=</span>ax_anim.transAxes, </span>
<span id="cb118-164"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-164" tabindex="-1"></a>                          fontsize<span class="op">=</span><span class="dv">10</span>, verticalalignment<span class="op">=</span><span class="st">&#39;top&#39;</span>,</span>
<span id="cb118-165"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-165" tabindex="-1"></a>                          bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">&#39;round&#39;</span>, facecolor<span class="op">=</span><span class="st">&#39;wheat&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb118-166"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-166" tabindex="-1"></a></span>
<span id="cb118-167"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-167" tabindex="-1"></a><span class="kw">def</span> animate(frame):</span>
<span id="cb118-168"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-168" tabindex="-1"></a>    im_anim.set_array(grid_states[frame])</span>
<span id="cb118-169"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-169" tabindex="-1"></a>    title_anim.set_text(<span class="ss">f&#39;SIR Epidemic Spread - Step </span><span class="sc">{</span>frame<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb118-170"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-170" tabindex="-1"></a>    </span>
<span id="cb118-171"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-171" tabindex="-1"></a>    <span class="co"># Update statistics</span></span>
<span id="cb118-172"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-172" tabindex="-1"></a>    s_count <span class="op">=</span> <span class="bu">int</span>(data[<span class="st">&#39;Susceptible&#39;</span>].iloc[frame])</span>
<span id="cb118-173"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-173" tabindex="-1"></a>    i_count <span class="op">=</span> <span class="bu">int</span>(data[<span class="st">&#39;Infected&#39;</span>].iloc[frame])</span>
<span id="cb118-174"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-174" tabindex="-1"></a>    r_count <span class="op">=</span> <span class="bu">int</span>(data[<span class="st">&#39;Recovered&#39;</span>].iloc[frame])</span>
<span id="cb118-175"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-175" tabindex="-1"></a>    stats_text.set_text(<span class="ss">f&#39;S: </span><span class="sc">{</span>s_count<span class="sc">}</span><span class="ch">\n</span><span class="ss">I: </span><span class="sc">{</span>i_count<span class="sc">}</span><span class="ch">\n</span><span class="ss">R: </span><span class="sc">{</span>r_count<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb118-176"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-176" tabindex="-1"></a>    </span>
<span id="cb118-177"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-177" tabindex="-1"></a>    <span class="cf">return</span> [im_anim, title_anim, stats_text]</span>
<span id="cb118-178"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-178" tabindex="-1"></a></span>
<span id="cb118-179"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-179" tabindex="-1"></a><span class="co"># Create animation (sample every 2 frames for speed)</span></span>
<span id="cb118-180"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-180" tabindex="-1"></a>anim <span class="op">=</span> FuncAnimation(fig_anim, animate, frames<span class="op">=</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(grid_states), <span class="dv">2</span>), </span>
<span id="cb118-181"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-181" tabindex="-1"></a>                     interval<span class="op">=</span><span class="dv">100</span>, blit<span class="op">=</span><span class="va">True</span>, repeat<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb118-182"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-182" tabindex="-1"></a></span>
<span id="cb118-183"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-183" tabindex="-1"></a>plt.close()  <span class="co"># Close the figure to prevent duplicate display</span></span>
<span id="cb118-184"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-184" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Animation ready!&quot;</span>)</span>
<span id="cb118-185"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-185" tabindex="-1"></a></span>
<span id="cb118-186"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-186" tabindex="-1"></a><span class="co"># Display animation</span></span>
<span id="cb118-187"><a href="modeling-disease-spread-the-sir-epidemic-framework.html#cb118-187" tabindex="-1"></a>HTML(anim.to_jshtml())</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-boids-flocking-model.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/Kamran-Afzali/Agent-Based-Modelling/edit/main/13-SIR.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/Kamran-Afzali/Agent-Based-Modelling/blob/main/13-SIR.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
